<!doctype html>
<html lang="ar" dir="rtl">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ูุธุงู ุฅุฏุงุฑุฉ ูุฑูุฒ ุงูุญุจูุจ - Google Sheets</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://apis.google.com/js/api.js"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap');
        
        * {
            font-family: 'Cairo', sans-serif;
        }
        
        :root {
            --primary-color: #8B4513;
            --primary-dark: #654321;
            --primary-light: #A0522D;
            --secondary-color: #DAA520;
            --accent-color: #CD853F;
            --success-color: #228B22;
            --danger-color: #DC143C;
            --warning-color: #FF8C00;
            --info-color: #4682B4;
            --light-bg: #FFF8DC;
            --card-bg: #FFFAF0;
        }
        
        body {
            background: linear-gradient(135deg, #FFF8DC 0%, #FAEBD7 100%);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 50%, var(--primary-light) 100%);
        }
        
        .admin-gradient {
            background: linear-gradient(135deg, #8B0000 0%, #DC143C 50%, #FF6347 100%);
        }
        
        .teacher-gradient {
            background: linear-gradient(135deg, #006400 0%, #228B22 50%, #32CD32 100%);
        }
        
        .student-gradient {
            background: linear-gradient(135deg, #191970 0%, #4169E1 50%, #6495ED 100%);
        }
        
        .card-shadow {
            box-shadow: 0 10px 40px rgba(139, 69, 19, 0.15);
            border: 2px solid rgba(218, 165, 32, 0.2);
        }
        
        .hover-lift {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .hover-lift:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 50px rgba(139, 69, 19, 0.25);
        }
        
        .fade-in {
            animation: fadeIn 1s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .nav-item {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            padding: 10px 20px;
        }
        
        .nav-item::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 3px;
            background: var(--secondary-color);
            transition: all 0.3s ease;
        }
        
        .nav-item:hover::before,
        .nav-item.active::before {
            width: 100%;
        }
        
        .nav-item:hover {
            background: rgba(218, 165, 32, 0.1);
        }
        
        .nav-item.active {
            background: rgba(218, 165, 32, 0.2);
            font-weight: 700;
        }
        
        .loading-spinner {
            border: 3px solid rgba(218, 165, 32, 0.3);
            border-top: 3px solid var(--secondary-color);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .connection-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .status-connected {
            background: #E8F5E9;
            color: #2E7D32;
        }
        
        .status-disconnected {
            background: #FFEBEE;
            color: #C62828;
        }
        
        .status-connecting {
            background: #FFF3E0;
            color: #E65100;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary-color) 0%, #B8860B 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success-color) 0%, #006400 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color) 0%, #8B0000 100%);
            color: white;
        }
        
        .setup-card {
            background: white;
            border: 2px solid rgba(218, 165, 32, 0.2);
            border-radius: 12px;
            padding: 24px;
            transition: all 0.3s ease;
        }
        
        .setup-card:hover {
            border-color: var(--secondary-color);
            box-shadow: 0 8px 24px rgba(218, 165, 32, 0.3);
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .file-upload-area {
            border: 2px dashed #ddd;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .file-upload-area:hover {
            border-color: var(--secondary-color);
            background: rgba(218, 165, 32, 0.05);
        }
        
        .file-upload-area.dragover {
            border-color: var(--primary-color);
            background: rgba(139, 69, 19, 0.1);
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="bg-gray-50"><!-- Header -->
  <header class="gradient-bg text-white shadow-lg">
   <div class="container mx-auto px-4 py-6">
    <div class="flex items-center justify-between">
     <div class="flex items-center space-x-4 space-x-reverse">
      <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center">
       <svg class="w-10 h-10 text-blue-600" fill="currentColor" viewbox="0 0 24 24"><path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" /> <circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="2" />
       </svg>
      </div>
      <div>
       <h1 id="systemTitle" class="text-2xl font-bold">ูุธุงู ุฅุฏุงุฑุฉ ูุฑูุฒ ุงูุญุจูุจ - Google Sheets</h1>
       <p id="centerInfo" class="text-blue-200"><span id="centerName">ูุฑูุฒ ุงูุญุจูุจ ููุฃูุญุงู ูุงูุฏุฑุงุณุงุช ุงููุจุทูุฉ</span> - <span id="churchName">ูููุณุฉ ุงูุณูุฏุฉ ุงูุนุฐุฑุงุก ูุงููุฏูุณ ูุงุฑ ููุญูุง</span></p>
      </div>
     </div>
     <div class="flex items-center gap-4"><!-- Connection Status -->
      <div id="connectionStatus" class="connection-status status-disconnected">
       ๐ด ุบูุฑ ูุชุตู
      </div>
      <div id="userInfo" class="hidden text-left">
       <div class="text-sm text-blue-200">
        ูุฑุญุจุงู
       </div>
       <div id="userName" class="font-semibold"></div>
       <div id="userRole" class="text-xs text-blue-300"></div>
      </div>
     </div>
    </div>
   </div>
  </header><!-- Navigation -->
  <nav class="bg-white shadow-md sticky top-0 z-50">
   <div class="container mx-auto px-4">
    <div class="flex justify-center space-x-8 space-x-reverse py-4" id="mainNavigation"><button class="nav-item active px-4 py-2 text-gray-700 hover:text-blue-600 font-semibold transition-colors" onclick="showSection('home')"> ๐ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ </button> <button class="nav-item px-4 py-2 text-gray-700 hover:text-blue-600 font-semibold transition-colors" onclick="showSection('setup')"> โ๏ธ ุฅุนุฏุงุฏ ุงูุฑุจุท </button> <button class="nav-item px-4 py-2 text-gray-700 hover:text-blue-600 font-semibold transition-colors" onclick="showSection('login')"> ๐ ุชุณุฌูู ุงูุฏุฎูู </button>
    </div><!-- Admin Navigation -->
    <div id="adminNavigation" class="hidden flex justify-center space-x-6 space-x-reverse py-4 border-t border-gray-200"><button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-red-600 font-semibold transition-colors" onclick="showAdminSection('dashboard')"> ๐ ููุญุฉ ุงููุดุฑู </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-red-600 font-semibold transition-colors" onclick="showAdminSection('students')"> ๐ฅ ุฅุฏุงุฑุฉ ุงูุฏุงุฑุณูู </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-red-600 font-semibold transition-colors" onclick="showAdminSection('teachers')"> ๐จโ๐ซ ุฅุฏุงุฑุฉ ุงูุฎุฏุงู </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-red-600 font-semibold transition-colors" onclick="showAdminSection('attendance')"> ๐ ุงูุญุถูุฑ ูุงูุบูุงุจ </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-red-600 font-semibold transition-colors" onclick="showAdminSection('grades')"> ๐ ุงูุฏุฑุฌุงุช </button>
    </div><!-- Teacher Navigation -->
    <div id="teacherNavigation" class="hidden flex justify-center space-x-6 space-x-reverse py-4 border-t border-gray-200"><button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-green-600 font-semibold transition-colors" onclick="showTeacherSection('dashboard')"> ๐ฏ ููุญุฉ ุงูุฎุงุฏู </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-green-600 font-semibold transition-colors" onclick="showTeacherSection('attendance')"> โ ุชุณุฌูู ุงูุญุถูุฑ </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-green-600 font-semibold transition-colors" onclick="showTeacherSection('homework')"> ๐ ุชูููู ุงููุงุฌุจุงุช </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-green-600 font-semibold transition-colors" onclick="showTeacherSection('grades')"> ๐ ุฅุฏุฎุงู ุงูุฏุฑุฌุงุช </button>
    </div><!-- Student Navigation -->
    <div id="studentNavigation" class="hidden flex justify-center space-x-6 space-x-reverse py-4 border-t border-gray-200"><button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-purple-600 font-semibold transition-colors" onclick="showStudentSection('profile')"> ๐ค ูููู ุงูุดุฎุตู </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-purple-600 font-semibold transition-colors" onclick="showStudentSection('grades')"> ๐ ุฏุฑุฌุงุชู </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-purple-600 font-semibold transition-colors" onclick="showStudentSection('attendance')"> ๐ ุญุถูุฑู </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-purple-600 font-semibold transition-colors" onclick="showStudentSection('homework')"> ๐ ุงููุงุฌุจุงุช </button>
    </div>
   </div>
  </nav><!-- Main Content -->
  <main class="container mx-auto px-4 py-8"><!-- Home Section -->
   <section id="home" class="section-content fade-in">
    <div class="text-center mb-12">
     <h2 class="text-4xl font-bold text-gray-800 mb-4">ุงููุธุงู ุงูุฅุฏุงุฑู ูููุฑูุฒ</h2>
     <p class="text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed">ูุฑูุฒ ุงูุญุจูุจ ููุฃูุญุงู ูุงูุฏุฑุงุณุงุช ุงููุจุทูุฉ - ูุฏุนูู ุจู Google Sheets</p>
    </div><!-- Google Integration Features -->
    <div class="bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-8 card-shadow mb-8">
     <div class="flex items-start gap-4">
      <div class="text-5xl">
       โ๏ธ
      </div>
      <div class="flex-1">
       <h3 class="text-2xl font-bold text-blue-900 mb-4">ุงูุชูุงูู ูุน Google Workspace</h3>
       <div class="grid md:grid-cols-2 gap-6">
        <div>
         <h4 class="font-bold text-green-800 mb-2">๐ Google Sheets</h4>
         <ul class="text-sm text-green-700 space-y-1">
          <li>โข ุชุฎุฒูู ุจูุงูุงุช ุงูุฏุงุฑุณูู ูุงูุฎุฏุงู</li>
          <li>โข ุชุณุฌูู ุงูุญุถูุฑ ูุงูุบูุงุจ ูู 15 ุฃุณุจูุน</li>
          <li>โข ุฏุฑุฌุงุช ูุงุฏุฉ ุงูุทููุณ ุงูููุณูุฉ</li>
          <li>โข ุฏุฑุฌุงุช ูุงุฏุฉ ุงููุบุฉ ุงููุจุทูุฉ</li>
          <li>โข ุฏุฑุฌุงุช ุงูุชุณููุน ุงูุฃุณุจูุนู ููุฃูุญุงู</li>
         </ul>
        </div>
        <div>
         <h4 class="font-bold text-blue-800 mb-2">๐พ Google Drive</h4>
         <ul class="text-sm text-blue-700 space-y-1">
          <li>โข ุชุฎุฒูู ุตูุฑ ุงููุงุฌุจุงุช ุงููุฑุณูุฉ</li>
          <li>โข ุญูุธ ุชุณุฌููุงุช ุงูุฃูุญุงู ุงูุตูุชูุฉ</li>
          <li>โข ูุณุฎ ุงุญุชูุงุทูุฉ ุชููุงุฆูุฉ</li>
          <li>โข ูุดุงุฑูุฉ ุขููุฉ ูููููุงุช</li>
          <li>โข ูุตูู ูู ุฃู ููุงู</li>
         </ul>
        </div>
       </div>
      </div>
     </div>
    </div><!-- Vision and Mission -->
    <div class="space-y-8"><!-- Goal -->
     <div class="bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-8 card-shadow">
      <div class="flex items-start gap-4">
       <div class="text-5xl">
        ๐ฏ
       </div>
       <div class="flex-1">
        <h3 class="text-2xl font-bold text-blue-900 mb-4">ุงููุฏู</h3>
        <p class="text-lg text-blue-800 leading-relaxed">ูุฏููุง ุชุนููู ุฃููุงุฏูุง ูุจูุงุชูุง ูู ุงูุตุบุฑ (ูู ูุฑุญูุฉ ุงูุญุถุงูุฉ) ููู ูุณุชูุชุนูู ุจุตููุงุช ุงููููุณุฉ .. ุจุทูุณูุง ููุบุชูุง ุงููุจุทูุฉ ูุฃูุญุงููุง.</p>
       </div>
      </div>
     </div><!-- Vision -->
     <div class="bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-8 card-shadow">
      <div class="flex items-start gap-4">
       <div class="text-5xl">
        ๐๏ธ
       </div>
       <div class="flex-1">
        <h3 class="text-2xl font-bold text-purple-900 mb-4">ุงูุฑุคูุฉ</h3>
        <p class="text-lg text-purple-800 leading-relaxed mb-4">ุฑุคูุชูุง ุฅู ุงูุดุนุจ ููู ูุณุชูุชุน ุจููุชูุฑุฌูุฉ ุงููููุณุฉ ูู ูุฏุงุณ ู ุชุณุจุญุฉ ู ุตููุงุช ูุฎุชููุฉ ... ูุตูู ุจุงูุฑูุญ ู ุงูุฐูู ุฃูุถุงู</p>
        <div class="bg-white rounded-lg p-4 border-2 border-purple-300">
         <p class="text-center text-xl font-bold text-purple-900">ุชุญุช ุดุนุงุฑ: ุฃููู ... ุตููู ... ุงุณุชูุชุน</p>
        </div>
        <p class="text-lg text-purple-800 leading-relaxed mt-4">ุจุนุฏ ุชุฎุฑุฌ ุซุงูุซ ุฏูุนุฉ ุงููููุณุฉ ูููุง ุชุณุชูุชุน ุจุงูููุชูุฑุฌูู</p>
       </div>
      </div>
     </div><!-- Mission -->
     <div class="bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-8 card-shadow">
      <div class="flex items-start gap-4">
       <div class="text-5xl">
        โจ
       </div>
       <div class="flex-1">
        <h3 class="text-2xl font-bold text-green-900 mb-4">ุฑุณุงูุชูุง</h3>
        <p class="text-lg text-green-800 leading-relaxed">ุชูุงูู ุงููุฏุฑุณุฉ ูุน ูู ุงูุงุฌุชูุงุนุงุช</p>
       </div>
      </div>
     </div><!-- Target Audience -->
     <div class="bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-8 card-shadow">
      <div class="flex items-start gap-4">
       <div class="text-5xl">
        ๐ฅ
       </div>
       <div class="flex-1">
        <h3 class="text-2xl font-bold text-orange-900 mb-4">ุงููุฆุฉ ุงููุณุชูุฏูุฉ</h3>
        <p class="text-lg text-orange-800 leading-relaxed">ูุฑุญูุฉ ุงูุญุถุงูุฉ ูุญุชู ุซุงููู ูุดุจุงุจ ูุฎุฑูุฌูู ูุฃูููุงุก ุงูุฃููุฑ ููุนุทู ุงููุฑุตุฉ ูุฃูุจุฑ ุนุฏุฏ ูู ุงููุงุณ ููุงุณุชูุชุงุน ุจูููุณุชูุง ุงูุฌูููุฉ.</p>
       </div>
      </div>
     </div><!-- User Types -->
     <div class="grid md:grid-cols-3 gap-8 mt-12"><!-- Admin Panel -->
      <div class="bg-white rounded-lg p-8 card-shadow hover-lift border-t-4 border-red-500">
       <div class="text-center">
        <div class="w-20 h-20 admin-gradient rounded-full flex items-center justify-center mx-auto mb-6"><span class="text-3xl text-white">๐จโ๐ผ</span>
        </div>
        <h3 class="text-2xl font-bold text-gray-800 mb-4">ููุญุฉ ุงูุฅุฏุงุฑุฉ</h3>
        <div class="text-gray-600 space-y-2 mb-6">
         <p>โข ุฅุถุงูุฉ ูุชุนุฏูู ุงูุฏุงุฑุณูู ูุงูุฎุฏุงู</p>
         <p>โข ุฅุฏุงุฑุฉ ุงูุญุถูุฑ ูุงูุฏุฑุฌุงุช</p>
         <p>โข ูุฒุงููุฉ ูุน Google Sheets</p>
         <p>โข ุชูุงุฑูุฑ ุดุงููุฉ</p>
        </div>
       </div>
      </div><!-- Teacher Panel -->
      <div class="bg-white rounded-lg p-8 card-shadow hover-lift border-t-4 border-green-500">
       <div class="text-center">
        <div class="w-20 h-20 teacher-gradient rounded-full flex items-center justify-center mx-auto mb-6"><span class="text-3xl text-white">๐จโ๐ซ</span>
        </div>
        <h3 class="text-2xl font-bold text-gray-800 mb-4">ููุญุฉ ุงูุฎุงุฏู</h3>
        <div class="text-gray-600 space-y-2 mb-6">
         <p>โข ุชุณุฌูู ุงูุญุถูุฑ ูุงูุบูุงุจ</p>
         <p>โข ุฅุฏุฎุงู ุฏุฑุฌุงุช ุงููุงุฌุจุงุช</p>
         <p>โข ุชูููู ุงููุงุฌุจุงุช ุงููุฑุณูุฉ</p>
         <p>โข ูุชุงุจุนุฉ ุงูุทูุงุจ</p>
        </div>
       </div>
      </div><!-- Student Panel -->
      <div class="bg-white rounded-lg p-8 card-shadow hover-lift border-t-4 border-purple-500">
       <div class="text-center">
        <div class="w-20 h-20 student-gradient rounded-full flex items-center justify-center mx-auto mb-6"><span class="text-3xl text-white">๐จโ๐</span>
        </div>
        <h3 class="text-2xl font-bold text-gray-800 mb-4">ููุญุฉ ุงูุฏุงุฑุณ</h3>
        <div class="text-gray-600 space-y-2 mb-6">
         <p>โข ุนุฑุถ ุงูุฏุฑุฌุงุช ูุงููุชุงุฆุฌ</p>
         <p>โข ูุชุงุจุนุฉ ุงูุญุถูุฑ</p>
         <p>โข ุชุณููู ุงููุงุฌุจุงุช</p>
         <p>โข ุฑูุน ุงูุตูุฑ ูุงูุชุณุฌููุงุช</p>
        </div>
       </div>
      </div>
     </div>
    </div>
   </section><!-- Setup Section -->
   <section id="setup" class="section-content hidden">
    <div class="max-w-4xl mx-auto">
     <div class="text-center mb-12">
      <h2 class="text-4xl font-bold text-gray-800 mb-4">โ๏ธ ุฅุนุฏุงุฏ ุงูุฑุจุท ูุน Google</h2>
      <p class="text-xl text-gray-600">ุงุชุจุน ุงูุฎุทูุงุช ุงูุชุงููุฉ ูุฑุจุท ุงููุธุงู ูุน Google Sheets ู Google Drive</p>
     </div><!-- Connection Status Card -->
     <div class="setup-card mb-8">
      <div class="flex items-center justify-between mb-6">
       <h3 class="text-2xl font-bold text-gray-800">ุญุงูุฉ ุงูุงุชุตุงู</h3><button onclick="testConnection()" class="btn-primary"> ๐ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู </button>
      </div>
      <div class="grid md:grid-cols-2 gap-6">
       <div class="text-center p-4 rounded-lg border-2" id="sheetsStatus">
        <div class="text-3xl mb-2">
         ๐
        </div>
        <h4 class="font-bold mb-2">Google Sheets</h4>
        <div class="connection-status status-disconnected">
         ุบูุฑ ูุชุตู
        </div>
       </div>
       <div class="text-center p-4 rounded-lg border-2" id="driveStatus">
        <div class="text-3xl mb-2">
         ๐พ
        </div>
        <h4 class="font-bold mb-2">Google Drive</h4>
        <div class="connection-status status-disconnected">
         ุบูุฑ ูุชุตู
        </div>
       </div>
      </div>
     </div><!-- Setup Steps -->
     <div class="space-y-8"><!-- Step 1: Create Google Sheets -->
      <div class="setup-card">
       <div class="flex items-start gap-4">
        <div class="step-number">
         1
        </div>
        <div class="flex-1">
         <h3 class="text-xl font-bold text-gray-800 mb-4">ุฅูุดุงุก Google Sheets</h3>
         <p class="text-gray-600 mb-4">ูู ุจุฅูุดุงุก ุฌุฏูู Google Sheets ุฌุฏูุฏ ูุญุชูู ุนูู ุงูุฃูุฑุงู ุงูุชุงููุฉ:</p>
         <div class="grid md:grid-cols-2 gap-4 mb-4">
          <div class="bg-blue-50 p-4 rounded-lg">
           <h4 class="font-bold text-blue-800 mb-2">ุงูุฃูุฑุงู ุงููุทููุจุฉ:</h4>
           <ul class="text-sm text-blue-700 space-y-1">
            <li>โข Students (ุจูุงูุงุช ุงูุฏุงุฑุณูู)</li>
            <li>โข Teachers (ุจูุงูุงุช ุงูุฎุฏุงู)</li>
            <li>โข Attendance (ุงูุญุถูุฑ ูุงูุบูุงุจ)</li>
           </ul>
          </div>
          <div class="bg-green-50 p-4 rounded-lg">
           <h4 class="font-bold text-green-800 mb-2">ุฃูุฑุงู ุงูุฏุฑุฌุงุช:</h4>
           <ul class="text-sm text-green-700 space-y-1">
            <li>โข Liturgy_Grades (ุฏุฑุฌุงุช ุงูุทููุณ)</li>
            <li>โข Coptic_Grades (ุฏุฑุฌุงุช ุงููุจุทูุฉ)</li>
            <li>โข Hymns_Grades (ุฏุฑุฌุงุช ุงูุฃูุญุงู)</li>
           </ul>
          </div>
         </div>
         <div class="flex gap-3"><button onclick="createSampleSheet()" class="btn-secondary"> ๐ ุฅูุดุงุก ุฌุฏูู ูููุฐุฌู </button> <button onclick="downloadTemplate()" class="btn-primary"> ๐ฅ ุชุญููู ุงููุงูุจ </button>
         </div>
        </div>
       </div>
      </div><!-- Step 2: Get Sheets ID -->
      <div class="setup-card">
       <div class="flex items-start gap-4">
        <div class="step-number">
         2
        </div>
        <div class="flex-1">
         <h3 class="text-xl font-bold text-gray-800 mb-4">ุงูุญุตูู ุนูู ูุนุฑู ุงูุฌุฏูู</h3>
         <p class="text-gray-600 mb-4">ุงูุณุฎ ูุนุฑู ุงูุฌุฏูู ูู ุฑุงุจุท Google Sheets:</p>
         <div class="bg-gray-100 p-4 rounded-lg mb-4 font-mono text-sm">
          https://docs.google.com/spreadsheets/d/<span class="bg-yellow-200 px-2 py-1 rounded">SHEETS_ID_HERE</span>/edit
         </div>
         <div><label class="block text-sm font-bold text-gray-700 mb-2">ูุนุฑู Google Sheets:</label> <input type="text" id="sheetsIdInput" class="w-full p-3 border-2 border-gray-300 rounded-lg" placeholder="ุฃุฏุฎู ูุนุฑู ุงูุฌุฏูู ููุง">
         </div>
        </div>
       </div>
      </div><!-- Step 3: Create Google Drive Folder -->
      <div class="setup-card">
       <div class="flex items-start gap-4">
        <div class="step-number">
         3
        </div>
        <div class="flex-1">
         <h3 class="text-xl font-bold text-gray-800 mb-4">ุฅูุดุงุก ูุฌูุฏ Google Drive</h3>
         <p class="text-gray-600 mb-4">ุฃูุดุฆ ูุฌูุฏ ูู Google Drive ูุชุฎุฒูู ุงููููุงุช (ุงูุตูุฑ ูุงูุชุณุฌููุงุช):</p>
         <div class="bg-gray-100 p-4 rounded-lg mb-4 font-mono text-sm">
          https://drive.google.com/drive/folders/<span class="bg-yellow-200 px-2 py-1 rounded">FOLDER_ID_HERE</span>
         </div>
         <div><label class="block text-sm font-bold text-gray-700 mb-2">ูุนุฑู ูุฌูุฏ Google Drive:</label> <input type="text" id="driveIdInput" class="w-full p-3 border-2 border-gray-300 rounded-lg" placeholder="ุฃุฏุฎู ูุนุฑู ุงููุฌูุฏ ููุง">
         </div>
        </div>
       </div>
      </div><!-- Step 4: API Setup -->
      <div class="setup-card">
       <div class="flex items-start gap-4">
        <div class="step-number">
         4
        </div>
        <div class="flex-1">
         <h3 class="text-xl font-bold text-gray-800 mb-4">ุฅุนุฏุงุฏ Google API</h3>
         <p class="text-gray-600 mb-4">ูููุตูู ุงููุงูู ููุจูุงูุงุชุ ุณุชุญุชุงุฌ ุฅูู ุฅุนุฏุงุฏ Google API:</p>
         <div class="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4 mb-4">
          <h4 class="font-bold text-yellow-800 mb-2">โ๏ธ ููุงุญุธุฉ ูููุฉ</h4>
          <p class="text-sm text-yellow-700">ูุฐุง ุงููุธุงู ูุนูู ุญุงููุงู ูู ูุถุน ุงููุฑุงุกุฉ ุงูุนุงูุฉ. ููุญุตูู ุนูู ุงููุตูู ุงููุงูู (ุงููุชุงุจุฉ ูุงูุชุนุฏูู)ุ ุณุชุญุชุงุฌ ุฅูู ุฅุนุฏุงุฏ Google API ูุน ููุงุชูุญ ุงููุตุงุฏูุฉ ุงูููุงุณุจุฉ.</p>
         </div>
         <div class="space-y-3"><a href="https://console.developers.google.com/" target="_blank" class="btn-primary inline-block"> ๐ ูุชุญ Google Cloud Console </a> <button onclick="showAPIInstructions()" class="btn-secondary"> ๐ ุนุฑุถ ุชุนูููุงุช API </button>
         </div>
        </div>
       </div>
      </div><!-- Save Configuration -->
      <div class="setup-card">
       <div class="flex items-start gap-4">
        <div class="step-number">
         5
        </div>
        <div class="flex-1">
         <h3 class="text-xl font-bold text-gray-800 mb-4">ุญูุธ ุงูุฅุนุฏุงุฏุงุช</h3>
         <p class="text-gray-600 mb-4">ุงุญูุธ ุงูุฅุนุฏุงุฏุงุช ูุงุฎุชุจุฑ ุงูุงุชุตุงู:</p>
         <div class="flex gap-3"><button onclick="saveConfiguration()" class="btn-success"> ๐พ ุญูุธ ุงูุฅุนุฏุงุฏุงุช </button> <button onclick="testConnection()" class="btn-primary"> ๐ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู </button>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </section><!-- Login Section -->
   <section id="login" class="section-content hidden">
    <div class="max-w-md mx-auto bg-white rounded-lg p-8 card-shadow">
     <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ุชุณุฌูู ุงูุฏุฎูู</h2>
     <div class="mb-6">
      <div class="flex border-b border-gray-200"><button id="adminTab" class="flex-1 py-3 px-4 text-center font-semibold text-gray-500" onclick="switchLoginTab('admin')"> ๐จโ๐ผ ุฅุฏุงุฑุฉ </button> <button id="teacherTab" class="flex-1 py-3 px-4 text-center font-semibold text-gray-500" onclick="switchLoginTab('teacher')"> ๐จโ๐ซ ุฎุงุฏู </button> <button id="studentTab" class="flex-1 py-3 px-4 text-center font-semibold text-blue-600 border-b-2 border-blue-600" onclick="switchLoginTab('student')"> ๐จโ๐ ุฏุงุฑุณ </button>
      </div>
     </div>
     <form id="loginForm" onsubmit="handleLogin(event)">
      <div id="studentLogin">
       <div class="mb-6"><label for="studentCode" class="block text-sm font-semibold text-gray-700 mb-2">ููุฏ ุงูุฏุงุฑุณ</label> <input type="text" id="studentCode" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="ุฃุฏุฎู ููุฏ ุงูุฏุงุฑุณ ุงูุฎุงุต ุจู">
       </div>
       <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4">
        <p class="text-xs text-blue-700">๐ก <strong>ููุงุญุธุฉ:</strong> ููุฏ ุงูุฏุงุฑุณ ูุชู ุชุณูููู ูู ูู ูุจู ุฅุฏุงุฑุฉ ุงููุฑูุฒ ุนูุฏ ุงูุชุณุฌูู</p>
       </div>
      </div>
      <div id="teacherLogin" class="hidden">
       <div class="mb-4"><label for="teacherCode" class="block text-sm font-semibold text-gray-700 mb-2">ููุฏ ุงูุฎุงุฏู</label> <input type="text" id="teacherCode" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="ุฃุฏุฎู ููุฏ ุงูุฎุงุฏู">
       </div>
       <div class="mb-6"><label for="teacherPassword" class="block text-sm font-semibold text-gray-700 mb-2">ูููุฉ ุงููุฑูุฑ</label> <input type="password" id="teacherPassword" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ">
       </div>
       <div class="bg-green-50 border border-green-200 rounded-lg p-3 mb-4">
        <p class="text-xs text-green-700">๐ก <strong>ููุงุญุธุฉ:</strong> ููุฏ ุงูุฎุงุฏู ููููุฉ ุงููุฑูุฑ ูุชู ุชุณูููููุง ูู ูู ูุจู ุฅุฏุงุฑุฉ ุงููุฑูุฒ</p>
       </div>
      </div>
      <div id="adminLogin" class="hidden">
       <div class="mb-4"><label for="adminUsername" class="block text-sm font-semibold text-gray-700 mb-2">ุงุณู ุงููุณุชุฎุฏู</label> <input type="text" id="adminUsername" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent" placeholder="ุฃุฏุฎู ุงุณู ุงููุณุชุฎุฏู">
       </div>
       <div class="mb-6"><label for="adminPassword" class="block text-sm font-semibold text-gray-700 mb-2">ูููุฉ ุงููุฑูุฑ</label> <input type="password" id="adminPassword" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent" placeholder="ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ">
       </div>
       <div class="bg-red-50 border border-red-200 rounded-lg p-3 mb-4">
        <p class="text-xs text-red-700">๐ <strong>ุชูุจูู ุฃููู:</strong> ุจูุงูุงุช ุงูุฏุฎูู ููุฅุฏุงุฑุฉ ุณุฑูุฉ ููุบุงูุฉ ููุง ูุฌุจ ูุดุงุฑูุชูุง ูุน ุฃู ุดุฎุต</p>
       </div>
      </div><button type="submit" id="loginButton" class="w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition-colors"> <span class="flex items-center justify-center gap-2"> <span id="loginButtonText">ุชุณุฌูู ุฏุฎูู ุงูุฏุงุฑุณ</span>
        <div id="loginSpinner" class="loading-spinner hidden"></div></span> </button>
     </form>
     <div class="mt-6 text-center"><button onclick="logout()" class="text-gray-500 hover:text-gray-700 text-sm"> ุชุณุฌูู ุงูุฎุฑูุฌ </button>
     </div>
    </div>
   </section><!-- Admin Dashboard -->
   <section id="adminDashboard" class="section-content hidden">
    <div class="bg-white rounded-lg p-8 card-shadow">
     <div class="flex justify-between items-center mb-8">
      <div>
       <h2 class="text-3xl font-bold text-gray-800">ููุญุฉ ุงูุฅุฏุงุฑุฉ</h2>
       <p class="text-gray-600">ุฅุฏุงุฑุฉ ุดุงููุฉ ููุฑูุฒ ุงูุญุจูุจ - ูุฏุนูู ุจู Google Sheets</p>
      </div>
      <div class="flex items-center gap-4"><button onclick="syncWithSheets()" class="btn-secondary"> ๐ ูุฒุงููุฉ ุงูุจูุงูุงุช </button> <button onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors"> ุชุณุฌูู ุงูุฎุฑูุฌ </button>
      </div>
     </div><!-- Quick Stats -->
     <div class="grid md:grid-cols-4 gap-6 mb-8">
      <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6 text-center">
       <div class="text-3xl mb-2">
        ๐ฅ
       </div>
       <h3 class="text-2xl font-bold text-blue-800" id="totalStudentsCount">0</h3>
       <p class="text-blue-600">ุฅุฌูุงูู ุงูุฏุงุฑุณูู</p>
      </div>
      <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-6 text-center">
       <div class="text-3xl mb-2">
        ๐จโ๐ซ
       </div>
       <h3 class="text-2xl font-bold text-green-800" id="totalTeachersCount">0</h3>
       <p class="text-green-600">ุนุฏุฏ ุงูุฎุฏุงู</p>
      </div>
      <div class="bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg p-6 text-center">
       <div class="text-3xl mb-2">
        ๐
       </div>
       <h3 class="text-2xl font-bold text-yellow-800" id="attendanceRate">0%</h3>
       <p class="text-yellow-600">ูุนุฏู ุงูุญุถูุฑ</p>
      </div>
      <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-6 text-center">
       <div class="text-3xl mb-2">
        โ๏ธ
       </div>
       <h3 class="text-2xl font-bold text-purple-800" id="syncStatus">ูุชุตู</h3>
       <p class="text-purple-600">ุญุงูุฉ ุงููุฒุงููุฉ</p>
      </div>
     </div>
     <div id="adminContent">
      <div class="text-center py-12">
       <div class="text-6xl mb-4">
        ๐
       </div>
       <p class="text-gray-500 text-lg">ุงุฎุชุฑ ุฃุญุฏ ุงูุฃูุณุงู ูู ุงูุดุฑูุท ุงูุนููู</p>
      </div>
     </div>
    </div>
   </section><!-- Teacher Dashboard -->
   <section id="teacherDashboard" class="section-content hidden">
    <div class="bg-white rounded-lg p-8 card-shadow">
     <div class="flex justify-between items-center mb-8">
      <div>
       <h2 class="text-3xl font-bold text-gray-800">ููุญุฉ ุงูุฎุงุฏู</h2>
       <p class="text-gray-600" id="teacherWelcome">ูุฑุญุจุงู ุจู</p>
      </div>
      <div class="flex items-center gap-4"><button onclick="syncWithSheets()" class="btn-secondary"> ๐ ูุฒุงููุฉ ุงูุจูุงูุงุช </button> <button onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors"> ุชุณุฌูู ุงูุฎุฑูุฌ </button>
      </div>
     </div>
     <div id="teacherContent">
      <div class="text-center py-12">
       <div class="text-6xl mb-4">
        ๐ฏ
       </div>
       <p class="text-gray-500 text-lg">ุงุฎุชุฑ ุฃุญุฏ ุงูุฃูุณุงู ูู ุงูุดุฑูุท ุงูุนููู</p>
      </div>
     </div>
    </div>
   </section><!-- Student Dashboard -->
   <section id="studentDashboard" class="section-content hidden">
    <div class="bg-white rounded-lg p-8 card-shadow">
     <div class="flex justify-between items-center mb-8">
      <div>
       <h2 class="text-3xl font-bold text-gray-800">ูููู ุงูุดุฎุตู</h2>
       <p class="text-gray-600" id="studentWelcome">ูุฑุญุจุงู ุจู</p>
      </div><button onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors"> ุชุณุฌูู ุงูุฎุฑูุฌ </button>
     </div>
     <div id="studentContent">
      <div class="text-center py-12">
       <div class="text-6xl mb-4">
        ๐จโ๐
       </div>
       <p class="text-gray-500 text-lg">ุงุฎุชุฑ ุฃุญุฏ ุงูุฃูุณุงู ูู ุงูุดุฑูุท ุงูุนููู</p>
      </div>
     </div>
    </div>
   </section>
  </main><!-- Footer -->
  <footer class="gradient-bg text-white mt-16">
   <div class="container mx-auto px-4 py-8">
    <div class="text-center">
     <h3 class="text-xl font-bold mb-4">ูุธุงู ุฅุฏุงุฑุฉ ูุฑูุฒ ุงูุญุจูุจ - Google Sheets</h3>
     <p class="text-blue-200 mb-4">ูุธุงู ูุชูุงูู ูุน Google Workspace - ุชุฎุฒูู ุณุญุงุจู ุขูู</p>
     <p class="text-sm text-blue-100">ุฌููุน ุงูุญููู ูุญููุธุฉ ยฉ 2024</p>
    </div>
   </div>
  </footer>
  <script>
        // Configuration
        const defaultConfig = {
            system_title: "ูุธุงู ุฅุฏุงุฑุฉ ูุฑูุฒ ุงูุญุจูุจ - Google Sheets",
            center_name: "ูุฑูุฒ ุงูุญุจูุจ ููุฃูุญุงู ูุงูุฏุฑุงุณุงุช ุงููุจุทูุฉ",
            church_name: "ูููุณุฉ ุงูุณูุฏุฉ ุงูุนุฐุฑุงุก ูุงููุฏูุณ ูุงุฑ ููุญูุง",
            sheets_id: "",
            drive_folder_id: ""
        };

        // Google API Configuration
        let googleConfig = {
            sheetsId: '',
            driveFolderId: '',
            apiKey: '',
            isConnected: false
        };

        // Current user and state
        let currentUser = null;
        let currentLoginTab = 'student';

        // Google Sheets Structure
        const SHEET_NAMES = {
            STUDENTS: 'Students',
            TEACHERS: 'Teachers', 
            ATTENDANCE: 'Attendance',
            LITURGY_GRADES: 'Liturgy_Grades',
            COPTIC_GRADES: 'Coptic_Grades',
            HYMNS_GRADES: 'Hymns_Grades'
        };

        // Educational Stages
        const STAGES = [
            'KG1', 'KG2',
            'ุงูุตู ุงูุฃูู ุงูุฃุจุชุฏุงุฆู', 'ุงูุตู ุงูุซุงูู ุงูุฃุจุชุฏุงุฆู', 'ุงูุตู ุงูุซุงูุซ ุงูุฃุจุชุฏุงุฆู',
            'ุงูุตู ุงูุฑุงุจุน ุงูุฃุจุชุฏุงุฆู', 'ุงูุตู ุงูุฎุงูุณ ุงูุฃุจุชุฏุงุฆู', 'ุงูุตู ุงูุณุงุฏุณ ุงูุฃุจุชุฏุงุฆู',
            'ุงูุตู ุงูุฃูู ุงูุฃุนุฏุงุฏู', 'ุงูุตู ุงูุซุงูู ุงูุฃุนุฏุงุฏู', 'ุงูุตู ุงูุซุงูุซ ุงูุฃุนุฏุงุฏู',
            'ุงูุตู ุงูุฃูู ุงูุซุงููู', 'ุงูุตู ุงูุซุงูู ุงูุซุงููู', 'ุงูุตู ุงูุซุงูุซ ุงูุซุงููู',
            'ุดุจุงุจ', 'ุฎุฑูุฌูู', 'ุฃูููุงุก ุฃููุฑ'
        ];

        // Classes
        const CLASSES = [
            'ุชูููุฏู', 'ุฃููู ูุซุงููุฉ', 'ุซุงูุซุฉ ูุฑุงุจุนุฉ', 
            'ุฎุงูุณุฉ ูุณุงุฏุณุฉ', 'ุฃุนุฏุงุฏู - ุซุงููู', 'ุดุจุงุจ ูุฎุฑูุฌูู'
        ];

        // Teacher Specialties
        const SPECIALTIES = [
            'ุฃุฏุงุฑู', 'ุฏุฑุงุณู - ุทููุณ', 'ุฏุฑุงุณู - ูุบุฉ ูุจุทูุฉ', 'ุฏุฑุงุณู - ุงูุญุงู',
            'ุฏุฑุงุณู ูุญููุธุงุช', 'ูุณุคูู', 'ุฏุฑุงุณู - ุทููุณ ููุญููุธุงุช', 'ุฃุฏุงุฑู - ุฏุฑุงุณู'
        ];

        // Initialize System
        async function initializeSystem() {
            try {
                // Initialize Element SDK
                if (window.elementSdk) {
                    await window.elementSdk.init({
                        defaultConfig,
                        onConfigChange: async (config) => {
                            document.getElementById('systemTitle').textContent = config.system_title || defaultConfig.system_title;
                            document.getElementById('centerName').textContent = config.center_name || defaultConfig.center_name;
                            document.getElementById('churchName').textContent = config.church_name || defaultConfig.church_name;
                            
                            // Update Google configuration
                            if (config.sheets_id) {
                                googleConfig.sheetsId = config.sheets_id;
                                document.getElementById('sheetsIdInput').value = config.sheets_id;
                            }
                            if (config.drive_folder_id) {
                                googleConfig.driveFolderId = config.drive_folder_id;
                                document.getElementById('driveIdInput').value = config.drive_folder_id;
                            }
                        },
                        mapToCapabilities: (config) => ({
                            recolorables: [],
                            borderables: [],
                            fontEditable: undefined,
                            fontSizeable: undefined
                        }),
                        mapToEditPanelValues: (config) => new Map([
                            ["system_title", config.system_title || defaultConfig.system_title],
                            ["center_name", config.center_name || defaultConfig.center_name],
                            ["church_name", config.church_name || defaultConfig.church_name],
                            ["sheets_id", config.sheets_id || ""],
                            ["drive_folder_id", config.drive_folder_id || ""]
                        ])
                    });
                }

                // Load saved configuration
                loadConfiguration();
                
                // Initialize Google API
                await initializeGoogleAPI();
                
                console.log('โ ุชู ุชููุฆุฉ ุงููุธุงู ุจูุฌุงุญ');
                
            } catch (error) {
                console.error('โ ุฎุทุฃ ูู ุชููุฆุฉ ุงููุธุงู:', error);
                showToast('ุญุฏุซ ุฎุทุฃ ูู ุชููุฆุฉ ุงููุธุงู', 'error');
            }
        }

        // Initialize Google API
        async function initializeGoogleAPI() {
            try {
                await new Promise((resolve, reject) => {
                    gapi.load('client', {
                        callback: resolve,
                        onerror: reject
                    });
                });

                await gapi.client.init({
                    apiKey: googleConfig.apiKey || 'YOUR_API_KEY_HERE',
                    discoveryDocs: [
                        'https://sheets.googleapis.com/$discovery/rest?version=v4',
                        'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'
                    ]
                });

                console.log('โ ุชู ุชููุฆุฉ Google API ุจูุฌุงุญ');
                updateConnectionStatus();
                
            } catch (error) {
                console.error('โ ุฎุทุฃ ูู ุชููุฆุฉ Google API:', error);
                updateConnectionStatus(false);
            }
        }

        // Update Connection Status
        function updateConnectionStatus(connected = null) {
            const statusEl = document.getElementById('connectionStatus');
            const sheetsStatusEl = document.getElementById('sheetsStatus');
            const driveStatusEl = document.getElementById('driveStatus');
            
            if (connected === null) {
                connected = googleConfig.isConnected && googleConfig.sheetsId && googleConfig.driveFolderId;
            }
            
            googleConfig.isConnected = connected;
            
            if (connected) {
                statusEl.className = 'connection-status status-connected';
                statusEl.textContent = '๐ข ูุชุตู';
                
                if (sheetsStatusEl) {
                    sheetsStatusEl.querySelector('.connection-status').className = 'connection-status status-connected';
                    sheetsStatusEl.querySelector('.connection-status').textContent = 'ูุชุตู';
                }
                
                if (driveStatusEl) {
                    driveStatusEl.querySelector('.connection-status').className = 'connection-status status-connected';
                    driveStatusEl.querySelector('.connection-status').textContent = 'ูุชุตู';
                }
            } else {
                statusEl.className = 'connection-status status-disconnected';
                statusEl.textContent = '๐ด ุบูุฑ ูุชุตู';
                
                if (sheetsStatusEl) {
                    sheetsStatusEl.querySelector('.connection-status').className = 'connection-status status-disconnected';
                    sheetsStatusEl.querySelector('.connection-status').textContent = 'ุบูุฑ ูุชุตู';
                }
                
                if (driveStatusEl) {
                    driveStatusEl.querySelector('.connection-status').className = 'connection-status status-disconnected';
                    driveStatusEl.querySelector('.connection-status').textContent = 'ุบูุฑ ูุชุตู';
                }
            }
        }

        // Google Sheets Operations
        async function readFromSheet(sheetName, range = '') {
            try {
                if (!googleConfig.isConnected || !googleConfig.sheetsId) {
                    throw new Error('Google Sheets ุบูุฑ ูุชุตู');
                }

                const fullRange = range ? `${sheetName}!${range}` : sheetName;
                
                const response = await gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: googleConfig.sheetsId,
                    range: fullRange
                });

                return response.result.values || [];
            } catch (error) {
                console.error(`ุฎุทุฃ ูู ูุฑุงุกุฉ ุงูุจูุงูุงุช ูู ${sheetName}:`, error);
                throw error;
            }
        }

        async function writeToSheet(sheetName, range, values) {
            try {
                if (!googleConfig.isConnected || !googleConfig.sheetsId) {
                    throw new Error('Google Sheets ุบูุฑ ูุชุตู');
                }

                const response = await gapi.client.sheets.spreadsheets.values.update({
                    spreadsheetId: googleConfig.sheetsId,
                    range: `${sheetName}!${range}`,
                    valueInputOption: 'RAW',
                    resource: {
                        values: values
                    }
                });

                return response.result;
            } catch (error) {
                console.error(`ุฎุทุฃ ูู ูุชุงุจุฉ ุงูุจูุงูุงุช ุฅูู ${sheetName}:`, error);
                throw error;
            }
        }

        async function appendToSheet(sheetName, values) {
            try {
                if (!googleConfig.isConnected || !googleConfig.sheetsId) {
                    throw new Error('Google Sheets ุบูุฑ ูุชุตู');
                }

                const response = await gapi.client.sheets.spreadsheets.values.append({
                    spreadsheetId: googleConfig.sheetsId,
                    range: sheetName,
                    valueInputOption: 'RAW',
                    resource: {
                        values: values
                    }
                });

                return response.result;
            } catch (error) {
                console.error(`ุฎุทุฃ ูู ุฅุถุงูุฉ ุงูุจูุงูุงุช ุฅูู ${sheetName}:`, error);
                throw error;
            }
        }

        // Google Drive Operations
        async function uploadToGoogleDrive(file, fileName, folderId = null) {
            try {
                const targetFolderId = folderId || googleConfig.driveFolderId;
                
                if (!targetFolderId) {
                    throw new Error('ูุนุฑู ูุฌูุฏ Google Drive ุบูุฑ ูุญุฏุฏ');
                }

                const metadata = {
                    name: fileName,
                    parents: [targetFolderId]
                };

                const form = new FormData();
                form.append('metadata', new Blob([JSON.stringify(metadata)], {type: 'application/json'}));
                form.append('file', file);

                const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token}`
                    },
                    body: form
                });

                if (!response.ok) {
                    throw new Error(`ุฎุทุฃ ูู ุฑูุน ุงูููู: ${response.statusText}`);
                }

                const result = await response.json();
                return result;
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุฑูุน ุงูููู ุฅูู Google Drive:', error);
                throw error;
            }
        }

        // Data Conversion Functions
        function studentsArrayToSheet(students) {
            const headers = [
                'ููุฏ ุงูุฏุงุฑุณ', 'ุงุณู ุงูุฏุงุฑุณ', 'ุงูููุน', 'ุชุงุฑูุฎ ุงููููุงุฏ', 'ุงููุฑุญูุฉ',
                'ุงููุงุชู 1', 'ุงููุงุชู 2', 'ุญุฑู ุงููุตู', 'ุงููุตู', 'ุงูุฑุชุจุฉ', 'ุงูุนููุงู',
                'ุงูุงุณุชูุงุฑุฉ', 'ุงูุตูุฑุฉ', 'ูููุฉ ุงูุงุณุชูุงุฑุฉ', 'ุชุงุฑูุฎ ุงูุฅูุดุงุก'
            ];
            
            const rows = students.map(student => [
                student.code || '',
                student.name || '',
                student.gender || '',
                student.birthDate || '',
                student.stage || '',
                student.phone1 || '',
                student.phone2 || '',
                student.classLetter || '',
                student.className || '',
                student.rank || '',
                student.address || '',
                student.hasForm ? 'ูุนู' : 'ูุง',
                student.hasPhoto ? 'ูุนู' : 'ูุง',
                student.formPaid ? 'ูุนู' : 'ูุง',
                student.createdAt || ''
            ]);
            
            return [headers, ...rows];
        }

        function sheetToStudentsArray(sheetData) {
            if (!sheetData || sheetData.length < 2) return [];
            
            const [headers, ...rows] = sheetData;
            
            return rows.map(row => ({
                code: row[0] || '',
                name: row[1] || '',
                gender: row[2] || '',
                birthDate: row[3] || '',
                stage: row[4] || '',
                phone1: row[5] || '',
                phone2: row[6] || '',
                classLetter: row[7] || '',
                className: row[8] || '',
                rank: row[9] || '',
                address: row[10] || '',
                hasForm: row[11] === 'ูุนู',
                hasPhoto: row[12] === 'ูุนู',
                formPaid: row[13] === 'ูุนู',
                createdAt: row[14] || ''
            }));
        }

        function teachersArrayToSheet(teachers) {
            const headers = [
                'ููุฏ ุงูุฎุงุฏู', 'ุงุณู ุงูุฎุงุฏู', 'ุงููุงุชู', 'ุงูุชุฎุตุต', 'ุฃุฏุงุฑู',
                'ูููุฉ ุงููุฑูุฑ', 'ุงููุตู', 'ุชุงุฑูุฎ ุงูุฅูุดุงุก'
            ];
            
            const rows = teachers.map(teacher => [
                teacher.code || '',
                teacher.name || '',
                teacher.phone || '',
                teacher.specialty || '',
                teacher.isAdmin ? 'ูุนู' : 'ูุง',
                teacher.password || '',
                teacher.className || '',
                teacher.createdAt || ''
            ]);
            
            return [headers, ...rows];
        }

        function sheetToTeachersArray(sheetData) {
            if (!sheetData || sheetData.length < 2) return [];
            
            const [headers, ...rows] = sheetData;
            
            return rows.map(row => ({
                code: row[0] || '',
                name: row[1] || '',
                phone: row[2] || '',
                specialty: row[3] || '',
                isAdmin: row[4] === 'ูุนู',
                password: row[5] || '',
                className: row[6] || '',
                createdAt: row[7] || ''
            }));
        }

        // Sync Functions
        async function syncWithSheets() {
            try {
                updateConnectionStatus(null);
                showToast('ุฌุงุฑู ูุฒุงููุฉ ุงูุจูุงูุงุช...', 'info');
                
                // Test connection first
                await testConnection();
                
                if (!googleConfig.isConnected) {
                    throw new Error('ูุดู ูู ุงูุงุชุตุงู ุจู Google Sheets');
                }
                
                showToast('ุชู ูุฒุงููุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ', 'success');
                
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุงููุฒุงููุฉ:', error);
                showToast('ูุดู ูู ูุฒุงููุฉ ุงูุจูุงูุงุช: ' + error.message, 'error');
            }
        }

        async function loadStudentsFromSheets() {
            try {
                const sheetData = await readFromSheet(SHEET_NAMES.STUDENTS);
                return sheetToStudentsArray(sheetData);
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุชุญููู ุจูุงูุงุช ุงูุฏุงุฑุณูู:', error);
                return [];
            }
        }

        async function saveStudentsToSheets(students) {
            try {
                const sheetData = studentsArrayToSheet(students);
                await writeToSheet(SHEET_NAMES.STUDENTS, 'A1', sheetData);
                return true;
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุญูุธ ุจูุงูุงุช ุงูุฏุงุฑุณูู:', error);
                return false;
            }
        }

        async function loadTeachersFromSheets() {
            try {
                const sheetData = await readFromSheet(SHEET_NAMES.TEACHERS);
                return sheetToTeachersArray(sheetData);
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุชุญููู ุจูุงูุงุช ุงูุฎุฏุงู:', error);
                return [];
            }
        }

        async function saveTeachersToSheets(teachers) {
            try {
                const sheetData = teachersArrayToSheet(teachers);
                await writeToSheet(SHEET_NAMES.TEACHERS, 'A1', sheetData);
                return true;
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุญูุธ ุจูุงูุงุช ุงูุฎุฏุงู:', error);
                return false;
            }
        }

        // Configuration Management
        function saveConfiguration() {
            const sheetsId = document.getElementById('sheetsIdInput').value.trim();
            const driveId = document.getElementById('driveIdInput').value.trim();
            
            if (!sheetsId || !driveId) {
                showToast('ูุฑุฌู ุฅุฏุฎุงู ูุนุฑู Google Sheets ููุนุฑู ูุฌูุฏ Google Drive', 'error');
                return;
            }
            
            googleConfig.sheetsId = sheetsId;
            googleConfig.driveFolderId = driveId;
            
            // Save to localStorage
            localStorage.setItem('googleConfig', JSON.stringify(googleConfig));
            
            // Update Element SDK config
            if (window.elementSdk) {
                window.elementSdk.setConfig({
                    sheets_id: sheetsId,
                    drive_folder_id: driveId
                });
            }
            
            showToast('ุชู ุญูุธ ุงูุฅุนุฏุงุฏุงุช ุจูุฌุงุญ', 'success');
            testConnection();
        }

        function loadConfiguration() {
            try {
                const saved = localStorage.getItem('googleConfig');
                if (saved) {
                    googleConfig = { ...googleConfig, ...JSON.parse(saved) };
                    
                    if (document.getElementById('sheetsIdInput')) {
                        document.getElementById('sheetsIdInput').value = googleConfig.sheetsId || '';
                    }
                    if (document.getElementById('driveIdInput')) {
                        document.getElementById('driveIdInput').value = googleConfig.driveFolderId || '';
                    }
                }
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุชุญููู ุงูุฅุนุฏุงุฏุงุช:', error);
            }
        }

        async function testConnection() {
            try {
                const statusEl = document.getElementById('connectionStatus');
                statusEl.className = 'connection-status status-connecting';
                statusEl.textContent = '๐ก ุฌุงุฑู ุงูุงุฎุชุจุงุฑ...';
                
                if (!googleConfig.sheetsId) {
                    throw new Error('ูุนุฑู Google Sheets ุบูุฑ ูุญุฏุฏ');
                }
                
                // Test reading from sheets
                await readFromSheet(SHEET_NAMES.STUDENTS, 'A1:A1');
                
                updateConnectionStatus(true);
                showToast('ุชู ุงูุงุชุตุงู ุจูุฌุงุญ ูุน Google Sheets', 'success');
                
            } catch (error) {
                console.error('ูุดู ุงุฎุชุจุงุฑ ุงูุงุชุตุงู:', error);
                updateConnectionStatus(false);
                showToast('ูุดู ูู ุงูุงุชุตุงู: ' + error.message, 'error');
            }
        }

        // Setup Helper Functions
        function createSampleSheet() {
            const url = `https://docs.google.com/spreadsheets/create?usp=sharing`;
            window.open(url, '_blank');
            showToast('ุณูุชู ูุชุญ Google Sheets ูู ูุงูุฐุฉ ุฌุฏูุฏุฉ', 'info');
        }

        function downloadTemplate() {
            // Create a sample CSV template
            const csvContent = `ููุฏ ุงูุฏุงุฑุณ,ุงุณู ุงูุฏุงุฑุณ,ุงูููุน,ุชุงุฑูุฎ ุงููููุงุฏ,ุงููุฑุญูุฉ,ุงููุงุชู 1,ุงููุงุชู 2,ุญุฑู ุงููุตู,ุงููุตู,ุงูุฑุชุจุฉ,ุงูุนููุงู,ุงูุงุณุชูุงุฑุฉ,ุงูุตูุฑุฉ,ูููุฉ ุงูุงุณุชูุงุฑุฉ,ุชุงุฑูุฎ ุงูุฅูุดุงุก
ST001,ูุซุงู ููุฏุงุฑุณ,ุฐูุฑ,2010-01-01,ุงูุตู ุงูุฃูู ุงูุฃุจุชุฏุงุฆู,01234567890,,A,ุชูููุฏู,ุดูุงุณ,ุงูุนููุงู ููุง,ูุนู,ูุนู,ูุนู,2024-01-01`;
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'students_template.csv';
            link.click();
            
            showToast('ุชู ุชุญููู ูุงูุจ ุงูุจูุงูุงุช', 'success');
        }

        function showAPIInstructions() {
            const modal = createModal('ุชุนูููุงุช ุฅุนุฏุงุฏ Google API', `
                <div class="space-y-6">
                    <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-4">
                        <h3 class="font-bold text-blue-800 mb-3">ุฎุทูุงุช ุฅุนุฏุงุฏ Google API:</h3>
                        <ol class="text-sm text-blue-700 space-y-2 list-decimal list-inside">
                            <li>ุงุฐูุจ ุฅูู <a href="https://console.developers.google.com/" target="_blank" class="underline">Google Cloud Console</a></li>
                            <li>ุฃูุดุฆ ูุดุฑูุน ุฌุฏูุฏ ุฃู ุงุฎุชุฑ ูุดุฑูุน ููุฌูุฏ</li>
                            <li>ูุนูู Google Sheets API ู Google Drive API</li>
                            <li>ุฃูุดุฆ ููุงุชูุญ API (API Keys)</li>
                            <li>ูู ุจุฅุนุฏุงุฏ OAuth 2.0 ูููุตุงุฏูุฉ</li>
                            <li>ุฃุถู ุงููุทุงูุงุช ุงููุทููุจุฉ (Scopes)</li>
                        </ol>
                    </div>
                    
                    <div class="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4">
                        <h3 class="font-bold text-yellow-800 mb-3">ุงููุทุงูุงุช ุงููุทููุจุฉ:</h3>
                        <ul class="text-sm text-yellow-700 space-y-1 list-disc list-inside">
                            <li>https://www.googleapis.com/auth/spreadsheets</li>
                            <li>https://www.googleapis.com/auth/drive.file</li>
                        </ul>
                    </div>
                    
                    <div class="bg-green-50 border-2 border-green-300 rounded-lg p-4">
                        <h3 class="font-bold text-green-800 mb-3">ููุงุญุธุงุช ูููุฉ:</h3>
                        <ul class="text-sm text-green-700 space-y-1 list-disc list-inside">
                            <li>ุชุฃูุฏ ูู ุฃู ุงูุฌุฏูู ูุงููุฌูุฏ ูุงุจููู ูููุตูู ุงูุนุงู ุฃู ูุดุงุฑููู ูุน ุญุณุงุจ ุงูุฎุฏูุฉ</li>
                            <li>ุงุญุชูุธ ุจููุงุชูุญ API ูู ููุงู ุขูู</li>
                            <li>ูุง ุชุดุงุฑู ููุงุชูุญ API ูุน ุฃู ุดุฎุต</li>
                        </ul>
                    </div>
                    
                    <div class="flex justify-end">
                        <button onclick="closeModal()" class="btn-primary">
                            ูููุช
                        </button>
                    </div>
                </div>
            `);
        }

        // Navigation functions
        function showSection(sectionId) {
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(sectionId).classList.remove('hidden');
            
            document.querySelectorAll('#mainNavigation .nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // Login functions
        function switchLoginTab(tab) {
            currentLoginTab = tab;
            
            document.querySelectorAll('[id$="Tab"]').forEach(tabBtn => {
                tabBtn.className = 'flex-1 py-3 px-4 text-center font-semibold text-gray-500';
            });
            
            const colors = {
                admin: 'text-red-600 border-b-2 border-red-600',
                teacher: 'text-green-600 border-b-2 border-green-600',
                student: 'text-blue-600 border-b-2 border-blue-600'
            };
            
            document.getElementById(tab + 'Tab').className += ' ' + colors[tab];
            
            document.getElementById('adminLogin').classList.toggle('hidden', tab !== 'admin');
            document.getElementById('teacherLogin').classList.toggle('hidden', tab !== 'teacher');
            document.getElementById('studentLogin').classList.toggle('hidden', tab !== 'student');
            
            const buttonColors = {
                admin: 'bg-red-600 hover:bg-red-700',
                teacher: 'bg-green-600 hover:bg-green-700',
                student: 'bg-blue-600 hover:bg-blue-700'
            };
            
            const buttonTexts = {
                admin: 'ุชุณุฌูู ุฏุฎูู ุงูุฅุฏุงุฑุฉ',
                teacher: 'ุชุณุฌูู ุฏุฎูู ุงูุฎุงุฏู',
                student: 'ุชุณุฌูู ุฏุฎูู ุงูุฏุงุฑุณ'
            };
            
            const loginButton = document.getElementById('loginButton');
            loginButton.className = `w-full ${buttonColors[tab]} text-white py-3 px-4 rounded-lg font-semibold transition-colors`;
            document.getElementById('loginButtonText').textContent = buttonTexts[tab];
        }

        async function handleLogin(event) {
            event.preventDefault();
            
            const spinner = document.getElementById('loginSpinner');
            const buttonText = document.getElementById('loginButtonText');
            
            spinner.classList.remove('hidden');
            buttonText.textContent = 'ุฌุงุฑู ุงูุชุญูู...';
            
            try {
                let loginSuccess = false;
                let userData = null;
                
                if (currentLoginTab === 'student') {
                    const code = document.getElementById('studentCode').value.trim().toUpperCase();
                    
                    if (!code) {
                        showToast('ูุฑุฌู ุฅุฏุฎุงู ููุฏ ุงูุฏุงุฑุณ', 'error');
                        return;
                    }
                    
                    // Load students from Google Sheets
                    const students = await loadStudentsFromSheets();
                    userData = students.find(s => s.code === code);
                    
                    if (userData) {
                        currentUser = { type: 'student', data: userData };
                        loginSuccess = true;
                        showStudentDashboard();
                    }
                } else if (currentLoginTab === 'teacher') {
                    const code = document.getElementById('teacherCode').value.trim().toUpperCase();
                    const password = document.getElementById('teacherPassword').value.trim();
                    
                    if (!code || !password) {
                        showToast('ูุฑุฌู ุฅุฏุฎุงู ููุฏ ุงูุฎุงุฏู ููููุฉ ุงููุฑูุฑ', 'error');
                        return;
                    }
                    
                    // Load teachers from Google Sheets
                    const teachers = await loadTeachersFromSheets();
                    userData = teachers.find(t => t.code === code && t.password === password);
                    
                    if (userData) {
                        currentUser = { type: 'teacher', data: userData };
                        loginSuccess = true;
                        showTeacherDashboard();
                    }
                } else if (currentLoginTab === 'admin') {
                    const username = document.getElementById('adminUsername').value.trim();
                    const password = document.getElementById('adminPassword').value.trim();
                    
                    if (!username || !password) {
                        showToast('ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุงููุณุชุฎุฏู ููููุฉ ุงููุฑูุฑ', 'error');
                        return;
                    }
                    
                    // Check admin credentials (you can store these in sheets too)
                    if (username === 'ADMIN' && password === 'admin123') {
                        currentUser = { type: 'admin', data: { name: 'ุงููุฏูุฑ ุงูุนุงู', username: username } };
                        loginSuccess = true;
                        showAdminDashboard();
                    }
                }
                
                if (loginSuccess) {
                    showToast(`ูุฑุญุจุงู ุจู ${userData ? userData.name : currentUser.data.name}`, 'success');
                    document.getElementById('loginForm').reset();
                    updateUserInfo();
                } else {
                    showToast('ุงูุจูุงูุงุช ุงููุฏุฎูุฉ ุบูุฑ ุตุญูุญุฉ', 'error');
                }
                
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุชุณุฌูู ุงูุฏุฎูู:', error);
                showToast('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุณุฌูู ุงูุฏุฎูู: ' + error.message, 'error');
            } finally {
                spinner.classList.add('hidden');
                const buttonTexts = {
                    admin: 'ุชุณุฌูู ุฏุฎูู ุงูุฅุฏุงุฑุฉ',
                    teacher: 'ุชุณุฌูู ุฏุฎูู ุงูุฎุงุฏู',
                    student: 'ุชุณุฌูู ุฏุฎูู ุงูุฏุงุฑุณ'
                };
                buttonText.textContent = buttonTexts[currentLoginTab];
            }
        }

        function updateUserInfo() {
            const userInfo = document.getElementById('userInfo');
            const userName = document.getElementById('userName');
            const userRole = document.getElementById('userRole');
            
            if (currentUser) {
                userInfo.classList.remove('hidden');
                userName.textContent = currentUser.data.name;
                
                const roleTexts = {
                    admin: 'ูุฏูุฑ ุงููุธุงู',
                    teacher: 'ุฎุงุฏู - ' + (currentUser.data.specialty || ''),
                    student: 'ุฏุงุฑุณ - ' + (currentUser.data.stage || '')
                };
                
                userRole.textContent = roleTexts[currentUser.type];
            } else {
                userInfo.classList.add('hidden');
            }
        }

        function showAdminDashboard() {
            showSection('adminDashboard');
            document.getElementById('adminNavigation').classList.remove('hidden');
            document.getElementById('teacherNavigation').classList.add('hidden');
            document.getElementById('studentNavigation').classList.add('hidden');
            updateDashboardStats();
        }

        function showTeacherDashboard() {
            showSection('teacherDashboard');
            document.getElementById('adminNavigation').classList.add('hidden');
            document.getElementById('teacherNavigation').classList.remove('hidden');
            document.getElementById('studentNavigation').classList.add('hidden');
            
            const welcome = document.getElementById('teacherWelcome');
            welcome.textContent = `ูุฑุญุจุงู ${currentUser.data.name} - ${currentUser.data.specialty}`;
        }

        function showStudentDashboard() {
            showSection('studentDashboard');
            document.getElementById('adminNavigation').classList.add('hidden');
            document.getElementById('teacherNavigation').classList.add('hidden');
            document.getElementById('studentNavigation').classList.remove('hidden');
            
            const welcome = document.getElementById('studentWelcome');
            welcome.textContent = `ูุฑุญุจุงู ${currentUser.data.name} - ${currentUser.data.stage}`;
        }

        function logout() {
            currentUser = null;
            document.getElementById('adminNavigation').classList.add('hidden');
            document.getElementById('teacherNavigation').classList.add('hidden');
            document.getElementById('studentNavigation').classList.add('hidden');
            updateUserInfo();
            showSection('home');
            showToast('ุชู ุชุณุฌูู ุงูุฎุฑูุฌ ุจูุฌุงุญ', 'success');
        }

        // Admin Sections
        function showAdminSection(section) {
            const content = document.getElementById('adminContent');
            
            if (section === 'dashboard') {
                content.innerHTML = `
                    <div class="grid md:grid-cols-2 gap-8">
                        <div class="bg-blue-50 rounded-lg p-6">
                            <h3 class="text-xl font-bold text-blue-800 mb-4">๐ ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span>ุฅุฌูุงูู ุงูุฏุงุฑุณูู:</span>
                                    <span class="font-bold" id="dashboardStudentsCount">0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>ุนุฏุฏ ุงูุฎุฏุงู:</span>
                                    <span class="font-bold" id="dashboardTeachersCount">0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>ุญุงูุฉ ุงูุงุชุตุงู:</span>
                                    <span class="font-bold ${googleConfig.isConnected ? 'text-green-600' : 'text-red-600'}">
                                        ${googleConfig.isConnected ? 'ูุชุตู' : 'ุบูุฑ ูุชุตู'}
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-green-50 rounded-lg p-6">
                            <h3 class="text-xl font-bold text-green-800 mb-4">๐ฏ ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ</h3>
                            <div class="space-y-2">
                                <button onclick="showAdminSection('students')" class="w-full text-right p-3 bg-white rounded hover:bg-gray-50 transition-colors">
                                    ๐ฅ ุฅุฏุงุฑุฉ ุงูุฏุงุฑุณูู
                                </button>
                                <button onclick="showAdminSection('teachers')" class="w-full text-right p-3 bg-white rounded hover:bg-gray-50 transition-colors">
                                    ๐จโ๐ซ ุฅุฏุงุฑุฉ ุงูุฎุฏุงู
                                </button>
                                <button onclick="syncWithSheets()" class="w-full text-right p-3 bg-white rounded hover:bg-gray-50 transition-colors">
                                    ๐ ูุฒุงููุฉ ุงูุจูุงูุงุช
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                updateDashboardStats();
            } else if (section === 'students') {
                showStudentsManagement();
            } else if (section === 'teachers') {
                showTeachersManagement();
            } else if (section === 'attendance') {
                showAttendanceManagement();
            } else if (section === 'grades') {
                showGradesManagement();
            }
        }

        // Students Management
        async function showStudentsManagement() {
            const content = document.getElementById('adminContent');
            
            try {
                const students = await loadStudentsFromSheets();
                
                content.innerHTML = `
                    <div class="mb-6 flex justify-between items-center">
                        <h3 class="text-2xl font-bold text-gray-800">๐ฅ ุฅุฏุงุฑุฉ ุงูุฏุงุฑุณูู</h3>
                        <div class="flex gap-3">
                            <button onclick="syncWithSheets()" class="btn-secondary">
                                ๐ ูุฒุงููุฉ
                            </button>
                            <button onclick="showAddStudentForm()" class="btn-primary">
                                โ ุฅุถุงูุฉ ุฏุงุฑุณ ุฌุฏูุฏ
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="p-3 text-center">ู</th>
                                        <th class="p-3 text-center">ููุฏ ุงูุฏุงุฑุณ</th>
                                        <th class="p-3 text-right">ุงุณู ุงูุฏุงุฑุณ</th>
                                        <th class="p-3 text-center">ุงูููุน</th>
                                        <th class="p-3 text-center">ุงููุฑุญูุฉ</th>
                                        <th class="p-3 text-center">ุงููุตู</th>
                                        <th class="p-3 text-center">ุงููุงุชู</th>
                                        <th class="p-3 text-center">ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${students.length === 0 ? `
                                        <tr>
                                            <td colspan="8" class="p-8 text-center text-gray-500">
                                                ูุง ููุฌุฏ ุฏุงุฑุณูู ูุณุฌููู ูู Google Sheets
                                            </td>
                                        </tr>
                                    ` : students.map((student, index) => `
                                        <tr class="border-b hover:bg-gray-50">
                                            <td class="p-3 text-center text-gray-600">${index + 1}</td>
                                            <td class="p-3 text-center font-mono text-xs bg-gray-50">${student.code}</td>
                                            <td class="p-3 font-semibold">${student.name}</td>
                                            <td class="p-3 text-center">${student.gender}</td>
                                            <td class="p-3 text-center text-xs">${student.stage}</td>
                                            <td class="p-3 text-center text-xs">${student.className}</td>
                                            <td class="p-3 text-center text-xs">${student.phone1}</td>
                                            <td class="p-3 text-center">
                                                <button onclick="viewStudent('${student.code}')" class="text-green-600 hover:text-green-800 mx-1" title="ุนุฑุถ">๐๏ธ</button>
                                                <button onclick="editStudent('${student.code}')" class="text-blue-600 hover:text-blue-800 mx-1" title="ุชุนุฏูู">โ๏ธ</button>
                                                <button onclick="deleteStudent('${student.code}')" class="text-red-600 hover:text-red-800 mx-1" title="ุญุฐู">๐๏ธ</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            } catch (error) {
                content.innerHTML = `
                    <div class="bg-red-50 border-2 border-red-300 rounded-lg p-6 text-center">
                        <div class="text-4xl mb-4">โ</div>
                        <h3 class="text-xl font-bold text-red-800 mb-2">ุฎุทุฃ ูู ุชุญููู ุงูุจูุงูุงุช</h3>
                        <p class="text-red-700 mb-4">${error.message}</p>
                        <button onclick="showSection('setup')" class="btn-primary">
                            โ๏ธ ุฅุนุฏุงุฏ ุงูุฑุจุท
                        </button>
                    </div>
                `;
            }
        }

        // Teachers Management
        async function showTeachersManagement() {
            const content = document.getElementById('adminContent');
            
            try {
                const teachers = await loadTeachersFromSheets();
                
                content.innerHTML = `
                    <div class="mb-6 flex justify-between items-center">
                        <h3 class="text-2xl font-bold text-gray-800">๐จโ๐ซ ุฅุฏุงุฑุฉ ุงูุฎุฏุงู</h3>
                        <div class="flex gap-3">
                            <button onclick="syncWithSheets()" class="btn-secondary">
                                ๐ ูุฒุงููุฉ
                            </button>
                            <button onclick="showAddTeacherForm()" class="btn-primary">
                                โ ุฅุถุงูุฉ ุฎุงุฏู ุฌุฏูุฏ
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="p-3 text-center">ู</th>
                                        <th class="p-3 text-center">ููุฏ ุงูุฎุงุฏู</th>
                                        <th class="p-3 text-right">ุงุณู ุงูุฎุงุฏู</th>
                                        <th class="p-3 text-center">ุฑูู ุงููุงุชู</th>
                                        <th class="p-3 text-center">ุงูุชุฎุตุต</th>
                                        <th class="p-3 text-center">ุฃุฏุงุฑู</th>
                                        <th class="p-3 text-center">ุงููุตู</th>
                                        <th class="p-3 text-center">ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${teachers.length === 0 ? `
                                        <tr>
                                            <td colspan="8" class="p-8 text-center text-gray-500">
                                                ูุง ููุฌุฏ ุฎุฏุงู ูุณุฌููู ูู Google Sheets
                                            </td>
                                        </tr>
                                    ` : teachers.map((teacher, index) => `
                                        <tr class="border-b hover:bg-gray-50">
                                            <td class="p-3 text-center text-gray-600">${index + 1}</td>
                                            <td class="p-3 text-center font-mono text-xs bg-gray-50">${teacher.code}</td>
                                            <td class="p-3 font-semibold">${teacher.name}</td>
                                            <td class="p-3 text-center text-xs">${teacher.phone}</td>
                                            <td class="p-3 text-center text-xs">${teacher.specialty}</td>
                                            <td class="p-3 text-center">
                                                ${teacher.isAdmin ? '<span class="px-2 py-1 bg-red-100 text-red-800 rounded text-xs">โ</span>' : '<span class="text-gray-400">-</span>'}
                                            </td>
                                            <td class="p-3 text-center text-xs">${teacher.className || '-'}</td>
                                            <td class="p-3 text-center">
                                                <button onclick="viewTeacher('${teacher.code}')" class="text-green-600 hover:text-green-800 mx-1" title="ุนุฑุถ">๐๏ธ</button>
                                                <button onclick="editTeacher('${teacher.code}')" class="text-blue-600 hover:text-blue-800 mx-1" title="ุชุนุฏูู">โ๏ธ</button>
                                                <button onclick="deleteTeacher('${teacher.code}')" class="text-red-600 hover:text-red-800 mx-1" title="ุญุฐู">๐๏ธ</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            } catch (error) {
                content.innerHTML = `
                    <div class="bg-red-50 border-2 border-red-300 rounded-lg p-6 text-center">
                        <div class="text-4xl mb-4">โ</div>
                        <h3 class="text-xl font-bold text-red-800 mb-2">ุฎุทุฃ ูู ุชุญููู ุงูุจูุงูุงุช</h3>
                        <p class="text-red-700 mb-4">${error.message}</p>
                        <button onclick="showSection('setup')" class="btn-primary">
                            โ๏ธ ุฅุนุฏุงุฏ ุงูุฑุจุท
                        </button>
                    </div>
                `;
            }
        }

        // Attendance Management
        function showAttendanceManagement() {
            const content = document.getElementById('adminContent');
            
            content.innerHTML = `
                <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-6 text-center">
                    <div class="text-4xl mb-4">๐</div>
                    <h3 class="text-xl font-bold text-blue-800 mb-2">ุฅุฏุงุฑุฉ ุงูุญุถูุฑ ูุงูุบูุงุจ</h3>
                    <p class="text-blue-700 mb-4">ุณูุชู ุฑุจุท ูุฐุง ุงููุณู ูุน ูุฑูุฉ Attendance ูู Google Sheets</p>
                    <button onclick="syncWithSheets()" class="btn-primary">
                        ๐ ูุฒุงููุฉ ุงูุจูุงูุงุช
                    </button>
                </div>
            `;
        }

        // Grades Management
        function showGradesManagement() {
            const content = document.getElementById('adminContent');
            
            content.innerHTML = `
                <div class="space-y-6">
                    <h3 class="text-2xl font-bold text-gray-800">๐ ุฅุฏุงุฑุฉ ุงูุฏุฑุฌุงุช</h3>
                    
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-6 text-center">
                            <div class="text-4xl mb-4">โช</div>
                            <h4 class="text-xl font-bold text-blue-800 mb-2">ุฏุฑุฌุงุช ุงูุทููุณ ุงูููุณูุฉ</h4>
                            <p class="text-blue-700 mb-4">ูุฑูุฉ Liturgy_Grades</p>
                            <button onclick="manageLiturgyGrades()" class="btn-primary">
                                ๐ ุฅุฏุงุฑุฉ ุงูุฏุฑุฌุงุช
                            </button>
                        </div>
                        
                        <div class="bg-green-50 border-2 border-green-300 rounded-lg p-6 text-center">
                            <div class="text-4xl mb-4">๐</div>
                            <h4 class="text-xl font-bold text-green-800 mb-2">ุฏุฑุฌุงุช ุงููุบุฉ ุงููุจุทูุฉ</h4>
                            <p class="text-green-700 mb-4">ูุฑูุฉ Coptic_Grades</p>
                            <button onclick="manageCopticGrades()" class="btn-primary">
                                ๐ ุฅุฏุงุฑุฉ ุงูุฏุฑุฌุงุช
                            </button>
                        </div>
                        
                        <div class="bg-purple-50 border-2 border-purple-300 rounded-lg p-6 text-center">
                            <div class="text-4xl mb-4">๐ต</div>
                            <h4 class="text-xl font-bold text-purple-800 mb-2">ุฏุฑุฌุงุช ุงูุฃูุญุงู ูุงูุชุณุจุญุฉ</h4>
                            <p class="text-purple-700 mb-4">ูุฑูุฉ Hymns_Grades</p>
                            <button onclick="manageHymnsGrades()" class="btn-primary">
                                ๐ ุฅุฏุงุฑุฉ ุงูุฏุฑุฌุงุช
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Teacher Sections
        function showTeacherSection(section) {
            const content = document.getElementById('teacherContent');
            
            if (section === 'dashboard') {
                content.innerHTML = `
                    <div class="bg-green-50 rounded-lg p-6">
                        <h3 class="text-xl font-bold text-green-800 mb-4">๐ฏ ูุนูููุงุช ุงูุฎุงุฏู</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>ุงูุงุณู:</span>
                                <span class="font-semibold">${currentUser.data.name}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ุงูุชุฎุตุต:</span>
                                <span class="font-semibold">${currentUser.data.specialty}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ุงููุตู ุงููุณุคูู:</span>
                                <span class="font-semibold">${currentUser.data.className || 'ุบูุฑ ูุญุฏุฏ'}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ุญุงูุฉ ุงูุงุชุตุงู:</span>
                                <span class="font-semibold ${googleConfig.isConnected ? 'text-green-600' : 'text-red-600'}">
                                    ${googleConfig.isConnected ? 'ูุชุตู' : 'ุบูุฑ ูุชุตู'}
                                </span>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                content.innerHTML = `
                    <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-6 text-center">
                        <div class="text-4xl mb-4">๐ง</div>
                        <h3 class="text-xl font-bold text-blue-800 mb-2">ููุฏ ุงูุชุทููุฑ</h3>
                        <p class="text-blue-700 mb-4">ูุฐุง ุงููุณู ุณูุชู ุฑุจุทู ูุน Google Sheets ูุฑูุจุงู</p>
                        <button onclick="syncWithSheets()" class="btn-primary">
                            ๐ ูุฒุงููุฉ ุงูุจูุงูุงุช
                        </button>
                    </div>
                `;
            }
        }

        // Student Sections
        function showStudentSection(section) {
            const content = document.getElementById('studentContent');
            
            if (section === 'profile') {
                const student = currentUser.data;
                
                content.innerHTML = `
                    <div class="bg-purple-50 rounded-lg p-6">
                        <h3 class="text-xl font-bold text-purple-800 mb-4">๐ค ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>ุงูุงุณู:</span>
                                <span class="font-semibold">${student.name}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ููุฏ ุงูุฏุงุฑุณ:</span>
                                <span class="font-semibold font-mono">${student.code}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ุงูููุน:</span>
                                <span class="font-semibold">${student.gender}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ุงููุฑุญูุฉ:</span>
                                <span class="font-semibold">${student.stage}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ุงููุตู:</span>
                                <span class="font-semibold">${student.className}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ุฑูู ุงููุงุชู:</span>
                                <span class="font-semibold">${student.phone1}</span>
                            </div>
                        </div>
                    </div>
                `;
            } else if (section === 'homework') {
                showStudentHomework();
            } else {
                content.innerHTML = `
                    <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-6 text-center">
                        <div class="text-4xl mb-4">๐ง</div>
                        <h3 class="text-xl font-bold text-blue-800 mb-2">ููุฏ ุงูุชุทููุฑ</h3>
                        <p class="text-blue-700 mb-4">ูุฐุง ุงููุณู ุณูุชู ุฑุจุทู ูุน Google Sheets ูุฑูุจุงู</p>
                        <button onclick="syncWithSheets()" class="btn-primary">
                            ๐ ูุฒุงููุฉ ุงูุจูุงูุงุช
                        </button>
                    </div>
                `;
            }
        }

        // Student Homework with Google Drive Integration
        function showStudentHomework() {
            const content = document.getElementById('studentContent');
            
            content.innerHTML = `
                <div class="space-y-6">
                    <div class="flex justify-between items-center">
                        <h3 class="text-2xl font-bold text-gray-800">๐ ุงููุงุฌุจุงุช</h3>
                        <button onclick="showAddHomeworkForm()" class="btn-primary">
                            โ ุฅุถุงูุฉ ูุงุฌุจ ุฌุฏูุฏ
                        </button>
                    </div>
                    
                    <!-- Homework Types -->
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-6 text-center">
                            <div class="text-4xl mb-4">๐</div>
                            <h4 class="text-xl font-bold text-blue-800 mb-2">ูุงุฌุจ ูุชุงุจู</h4>
                            <p class="text-blue-700 mb-4">ูุชุงุจุฉ ุงููุต ูุจุงุดุฑุฉ</p>
                        </div>
                        
                        <div class="bg-green-50 border-2 border-green-300 rounded-lg p-6 text-center">
                            <div class="text-4xl mb-4">๐ท</div>
                            <h4 class="text-xl font-bold text-green-800 mb-2">ูุงุฌุจ ูุตูุฑ</h4>
                            <p class="text-green-700 mb-4">ุฑูุน ุตูุฑุฉ ุฅูู Google Drive</p>
                        </div>
                        
                        <div class="bg-purple-50 border-2 border-purple-300 rounded-lg p-6 text-center">
                            <div class="text-4xl mb-4">๐ค</div>
                            <h4 class="text-xl font-bold text-purple-800 mb-2">ุชุณููุน ุฃูุญุงู</h4>
                            <p class="text-purple-700 mb-4">ุชุณุฌูู ุตูุชู ุฅูู Google Drive</p>
                        </div>
                    </div>
                    
                    <!-- Upload Instructions -->
                    <div class="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-6">
                        <h3 class="text-lg font-bold text-yellow-800 mb-3">๐ ุชุนูููุงุช ุงูุฑูุน</h3>
                        <ul class="space-y-2 text-sm text-yellow-700">
                            <li>โข ุณูุชู ุญูุธ ุงูุตูุฑ ูุงูุชุณุฌููุงุช ูู Google Drive ุชููุงุฆูุงู</li>
                            <li>โข ุชุฃูุฏ ูู ูุถูุญ ุงูุตูุฑุฉ ูุฌูุฏุฉ ุงูุชุณุฌูู ุงูุตูุชู</li>
                            <li>โข ุณูุชู ุฅุดุนุงุฑ ุงูุฎุงุฏู ุงููุณุคูู ููุฑ ุฑูุน ุงููุงุฌุจ</li>
                            <li>โข ููููู ูุชุงุจุนุฉ ุญุงูุฉ ุงููุงุฌุจ (ูุฑุณู / ุชู ุงูุชูููู)</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        // Show Add Homework Form with Google Drive Integration
        function showAddHomeworkForm() {
            const modal = createModal('๐ ุฅุถุงูุฉ ูุงุฌุจ ุฌุฏูุฏ', `
                <form id="addHomeworkForm" onsubmit="submitHomeworkToGoogleDrive(event)" class="space-y-4">
                    <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-4 mb-4">
                        <div class="flex items-center gap-3">
                            <span class="text-3xl">๐</span>
                            <div>
                                <h4 class="font-bold text-blue-800">ูุงุฌุจ ุฌุฏูุฏ</h4>
                                <p class="text-sm text-blue-600">ุณูุชู ุญูุธู ูู Google Drive</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Homework Type Selection -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ููุน ุงููุงุฌุจ *</label>
                        <select name="homeworkType" id="homeworkType" onchange="toggleHomeworkInputs()" required class="w-full p-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">ุงุฎุชุฑ ููุน ุงููุงุฌุจ...</option>
                            <option value="written">ูุงุฌุจ ูุชุงุจู (ูุต)</option>
                            <option value="image">ูุงุฌุจ ูุตูุฑ (ุตูุฑุฉ)</option>
                            <option value="audio">ุชุณููุน ุฃูุญุงู (ุชุณุฌูู ุตูุชู)</option>
                        </select>
                    </div>
                    
                    <!-- Written Homework -->
                    <div id="writtenHomework" class="hidden">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ูุญุชูู ุงููุงุฌุจ ุงููุชุงุจู *</label>
                        <textarea 
                            name="content" 
                            id="homeworkContent"
                            rows="8"
                            class="w-full p-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="ุงูุชุจ ูุญุชูู ุงููุงุฌุจ ููุง..."
                        ></textarea>
                    </div>
                    
                    <!-- Image Homework -->
                    <div id="imageHomework" class="hidden">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ุตูุฑุฉ ุงููุงุฌุจ *</label>
                        <div class="file-upload-area" onclick="document.getElementById('homeworkImage').click()">
                            <input 
                                type="file" 
                                id="homeworkImage" 
                                name="homeworkImage"
                                accept="image/*"
                                onchange="previewImage(event)"
                                class="hidden"
                            >
                            <div class="text-4xl mb-3">๐ท</div>
                            <p class="font-semibold text-gray-700 mb-2">ุงุถุบุท ูุงุฎุชูุงุฑ ุตูุฑุฉ ุงููุงุฌุจ</p>
                            <p class="text-xs text-gray-500">ุณูุชู ุฑูุนูุง ุฅูู Google Drive ุชููุงุฆูุงู</p>
                        </div>
                        <div id="imagePreview" class="hidden mt-4">
                            <img id="previewImg" src="" alt="ูุนุงููุฉ ุงูุตูุฑุฉ" class="max-w-full max-h-64 mx-auto rounded-lg border-2 border-gray-300">
                            <button type="button" onclick="removeImage()" class="mt-2 text-red-600 hover:text-red-800 text-sm">
                                ๐๏ธ ุฅุฒุงูุฉ ุงูุตูุฑุฉ
                            </button>
                        </div>
                    </div>
                    
                    <!-- Audio Homework -->
                    <div id="audioHomework" class="hidden">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ุชุณุฌูู ุชุณููุน ุงููุญู *</label>
                        <div class="border-2 border-purple-300 bg-purple-50 rounded-lg p-6">
                            <div class="text-center mb-4">
                                <div class="text-4xl mb-2">๐ค</div>
                                <h4 class="font-bold text-purple-800 mb-2">ุชุณุฌูู ุงููุญู ุงูุฃุณุจูุนู</h4>
                                <p class="text-sm text-purple-700">ุณูุชู ุญูุธ ุงูุชุณุฌูู ูู Google Drive</p>
                            </div>
                            
                            <div class="flex justify-center gap-3 mb-4">
                                <button type="button" id="startRecording" onclick="startRecording()" class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 font-semibold">
                                    ๐ด ุจุฏุก ุงูุชุณุฌูู
                                </button>
                                <button type="button" id="stopRecording" onclick="stopRecording()" disabled class="bg-gray-400 text-white px-6 py-3 rounded-lg font-semibold">
                                    โน๏ธ ุฅููุงู ุงูุชุณุฌูู
                                </button>
                            </div>
                            
                            <div id="recordingStatus" class="text-center text-sm text-gray-600 mb-3">
                                ุฌุงูุฒ ููุชุณุฌูู
                            </div>
                            
                            <div id="audioPreview" class="hidden">
                                <div class="bg-white rounded-lg p-4 border-2 border-purple-300">
                                    <p class="text-sm font-semibold text-purple-800 mb-2">ูุนุงููุฉ ุงูุชุณุฌูู:</p>
                                    <audio id="audioPlayer" controls class="w-full mb-2"></audio>
                                    <button type="button" onclick="removeAudio()" class="text-red-600 hover:text-red-800 text-sm">
                                        ๐๏ธ ุญุฐู ุงูุชุณุฌูู ูุฅุนุงุฏุฉ ุงูุชุณุฌูู
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-green-50 border-2 border-green-300 rounded-lg p-4">
                        <h4 class="font-bold text-green-800 mb-2">โ๏ธ Google Drive</h4>
                        <p class="text-sm text-green-700">
                            ุณูุชู ุฑูุน ุงููููุงุช ุชููุงุฆูุงู ุฅูู Google Drive ูุฑุจุทูุง ุจุญุณุงุจู ูู Google Sheets
                        </p>
                    </div>
                    
                    <div class="flex justify-end gap-2 mt-6">
                        <button type="button" onclick="closeModal()" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-semibold">
                            ุฅูุบุงุก
                        </button>
                        <button type="submit" id="submitHomeworkBtn" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold">
                            ๐ค ุฑูุน ุงููุงุฌุจ
                        </button>
                    </div>
                </form>
            `);
        }

        // Submit Homework to Google Drive
        async function submitHomeworkToGoogleDrive(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const homeworkType = formData.get('homeworkType');
            
            // Validate
            if (homeworkType === 'audio' && !recordedAudioBlob) {
                showToast('ูุฑุฌู ุชุณุฌูู ุงููุญู ุฃููุงู', 'error');
                return;
            }
            
            if (homeworkType === 'image' && !document.getElementById('homeworkImage').files[0]) {
                showToast('ูุฑุฌู ุงุฎุชูุงุฑ ุตูุฑุฉ ุงููุงุฌุจ', 'error');
                return;
            }
            
            // Disable submit button
            const submitBtn = document.getElementById('submitHomeworkBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="loading-spinner inline-block"></span> ุฌุงุฑู ุงูุฑูุน...';
            
            try {
                let fileUrl = null;
                let fileName = null;
                
                if (homeworkType === 'image') {
                    const imageFile = document.getElementById('homeworkImage').files[0];
                    fileName = `homework_${currentUser.data.code}_${Date.now()}.${imageFile.name.split('.').pop()}`;
                    
                    const uploadResult = await uploadToGoogleDrive(imageFile, fileName);
                    fileUrl = `https://drive.google.com/file/d/${uploadResult.id}/view`;
                    
                } else if (homeworkType === 'audio') {
                    fileName = `hymn_${currentUser.data.code}_${Date.now()}.webm`;
                    
                    const uploadResult = await uploadToGoogleDrive(recordedAudioBlob, fileName);
                    fileUrl = `https://drive.google.com/file/d/${uploadResult.id}/view`;
                }
                
                // Save homework info to Google Sheets
                const homeworkData = [
                    currentUser.data.code,
                    currentUser.data.name,
                    currentUser.data.className,
                    homeworkType,
                    homeworkType === 'written' ? formData.get('content') : fileName,
                    fileUrl || '',
                    new Date().toISOString(),
                    'pending'
                ];
                
                // This would append to a Homework sheet in Google Sheets
                // await appendToSheet('Homework', [homeworkData]);
                
                showToast('โ ุชู ุฑูุน ุงููุงุฌุจ ุจูุฌุงุญ ุฅูู Google Drive', 'success');
                closeModal();
                showStudentHomework();
                
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุฑูุน ุงููุงุฌุจ:', error);
                showToast('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฑูุน ุงููุงุฌุจ: ' + error.message, 'error');
                submitBtn.disabled = false;
                submitBtn.innerHTML = '๐ค ุฑูุน ุงููุงุฌุจ';
            }
        }

        // Audio Recording Functions
        let mediaRecorder;
        let audioChunks = [];
        let recordedAudioBlob = null;
        
        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);
                audioChunks = [];
                
                mediaRecorder.ondataavailable = (event) => {
                    audioChunks.push(event.data);
                };
                
                mediaRecorder.onstop = () => {
                    recordedAudioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                    const audioUrl = URL.createObjectURL(recordedAudioBlob);
                    document.getElementById('audioPlayer').src = audioUrl;
                    document.getElementById('audioPreview').classList.remove('hidden');
                    document.getElementById('recordingStatus').textContent = 'ุชู ุงูุชุณุฌูู ุจูุฌุงุญ โ';
                    
                    // Stop all tracks
                    stream.getTracks().forEach(track => track.stop());
                };
                
                mediaRecorder.start();
                document.getElementById('startRecording').disabled = true;
                document.getElementById('stopRecording').disabled = false;
                document.getElementById('recordingStatus').textContent = '๐ด ุฌุงุฑู ุงูุชุณุฌูู...';
                
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุงููุตูู ูููููุฑูููู:', error);
                showToast('ูุง ูููู ุงููุตูู ูููููุฑูููู. ุชุฃูุฏ ูู ุงูุณูุงุญ ุจุงููุตูู ูููููุฑูููู', 'error');
            }
        }
        
        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
                document.getElementById('startRecording').disabled = false;
                document.getElementById('stopRecording').disabled = true;
            }
        }
        
        function removeAudio() {
            recordedAudioBlob = null;
            document.getElementById('audioPlayer').src = '';
            document.getElementById('audioPreview').classList.add('hidden');
            document.getElementById('recordingStatus').textContent = 'ุฌุงูุฒ ููุชุณุฌูู';
        }

        // Image Preview Functions
        function previewImage(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('previewImg').src = e.target.result;
                    document.getElementById('imagePreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }
        
        function removeImage() {
            document.getElementById('homeworkImage').value = '';
            document.getElementById('imagePreview').classList.add('hidden');
            document.getElementById('previewImg').src = '';
        }

        // Toggle Homework Inputs
        function toggleHomeworkInputs() {
            const type = document.getElementById('homeworkType').value;
            
            document.getElementById('writtenHomework').classList.add('hidden');
            document.getElementById('imageHomework').classList.add('hidden');
            document.getElementById('audioHomework').classList.add('hidden');
            
            // Reset required attributes
            document.getElementById('homeworkContent').removeAttribute('required');
            document.getElementById('homeworkImage').removeAttribute('required');
            
            if (type === 'written') {
                document.getElementById('writtenHomework').classList.remove('hidden');
                document.getElementById('homeworkContent').setAttribute('required', 'required');
            } else if (type === 'image') {
                document.getElementById('imageHomework').classList.remove('hidden');
                document.getElementById('homeworkImage').setAttribute('required', 'required');
            } else if (type === 'audio') {
                document.getElementById('audioHomework').classList.remove('hidden');
            }
        }

        // Update Dashboard Stats
        async function updateDashboardStats() {
            try {
                const students = await loadStudentsFromSheets();
                const teachers = await loadTeachersFromSheets();
                
                const totalStudentsEl = document.getElementById('totalStudentsCount');
                const totalTeachersEl = document.getElementById('totalTeachersCount');
                const dashboardStudentsEl = document.getElementById('dashboardStudentsCount');
                const dashboardTeachersEl = document.getElementById('dashboardTeachersCount');
                
                if (totalStudentsEl) totalStudentsEl.textContent = students.length;
                if (totalTeachersEl) totalTeachersEl.textContent = teachers.length;
                if (dashboardStudentsEl) dashboardStudentsEl.textContent = students.length;
                if (dashboardTeachersEl) dashboardTeachersEl.textContent = teachers.length;
                
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช:', error);
            }
        }

        // Generate Random Code
        function generateCode(prefix = '') {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = prefix;
            for (let i = 0; i < 8; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }

        // Modal Helper
        function createModal(title, content) {
            const modal = document.createElement('div');
            modal.id = 'customModal';
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">${title}</h2>
                            <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                        </div>
                        ${content}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            return modal;
        }

        function closeModal() {
            const modal = document.getElementById('customModal');
            if (modal) modal.remove();
        }

        // Toast Notification
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-600' : 
                type === 'error' ? 'bg-red-600' : 
                'bg-blue-600'
            } text-white`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Placeholder functions for future implementation
        function showAddStudentForm() {
            showToast('ุณูุชู ุฅุถุงูุฉ ูุฐู ุงูููุฒุฉ ูุฑูุจุงู ูุน Google Sheets', 'info');
        }

        function showAddTeacherForm() {
            showToast('ุณูุชู ุฅุถุงูุฉ ูุฐู ุงูููุฒุฉ ูุฑูุจุงู ูุน Google Sheets', 'info');
        }

        function viewStudent(code) {
            showToast('ุณูุชู ุฅุถุงูุฉ ูุฐู ุงูููุฒุฉ ูุฑูุจุงู', 'info');
        }

        function editStudent(code) {
            showToast('ุณูุชู ุฅุถุงูุฉ ูุฐู ุงูููุฒุฉ ูุฑูุจุงู', 'info');
        }

        function deleteStudent(code) {
            showToast('ุณูุชู ุฅุถุงูุฉ ูุฐู ุงูููุฒุฉ ูุฑูุจุงู', 'info');
        }

        function viewTeacher(code) {
            showToast('ุณูุชู ุฅุถุงูุฉ ูุฐู ุงูููุฒุฉ ูุฑูุจุงู', 'info');
        }

        function editTeacher(code) {
            showToast('ุณูุชู ุฅุถุงูุฉ ูุฐู ุงูููุฒุฉ ูุฑูุจุงู', 'info');
        }

        function deleteTeacher(code) {
            showToast('ุณูุชู ุฅุถุงูุฉ ูุฐู ุงูููุฒุฉ ูุฑูุจุงู', 'info');
        }

        function manageLiturgyGrades() {
            showToast('ุณูุชู ุฑุจุท ุฏุฑุฌุงุช ุงูุทููุณ ูุน Google Sheets ูุฑูุจุงู', 'info');
        }

        function manageCopticGrades() {
            showToast('ุณูุชู ุฑุจุท ุฏุฑุฌุงุช ุงููุบุฉ ุงููุจุทูุฉ ูุน Google Sheets ูุฑูุจุงู', 'info');
        }

        function manageHymnsGrades() {
            showToast('ุณูุชู ุฑุจุท ุฏุฑุฌุงุช ุงูุฃูุญุงู ูุน Google Sheets ูุฑูุจุงู', 'info');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initializeSystem);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99f63fdb53d7e280',t:'MTc2MzI4ODM2MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
