<!doctype html>
<html lang="ar" dir="rtl">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…Ø±ÙƒØ² Ø§Ù„Ø­Ø¨ÙŠØ¨ - Google Sheets</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://apis.google.com/js/api.js"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap');
        
        * {
            font-family: 'Cairo', sans-serif;
        }
        
        :root {
            --primary-color: #8B4513;
            --primary-dark: #654321;
            --primary-light: #A0522D;
            --secondary-color: #DAA520;
            --accent-color: #CD853F;
            --success-color: #228B22;
            --danger-color: #DC143C;
            --warning-color: #FF8C00;
            --info-color: #4682B4;
            --light-bg: #FFF8DC;
            --card-bg: #FFFAF0;
        }
        
        body {
            background: linear-gradient(135deg, #FFF8DC 0%, #FAEBD7 100%);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 50%, var(--primary-light) 100%);
        }
        
        .admin-gradient {
            background: linear-gradient(135deg, #8B0000 0%, #DC143C 50%, #FF6347 100%);
        }
        
        .teacher-gradient {
            background: linear-gradient(135deg, #006400 0%, #228B22 50%, #32CD32 100%);
        }
        
        .student-gradient {
            background: linear-gradient(135deg, #191970 0%, #4169E1 50%, #6495ED 100%);
        }
        
        .card-shadow {
            box-shadow: 0 10px 40px rgba(139, 69, 19, 0.15);
            border: 2px solid rgba(218, 165, 32, 0.2);
        }
        
        .hover-lift {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .hover-lift:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 50px rgba(139, 69, 19, 0.25);
        }
        
        .fade-in {
            animation: fadeIn 1s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .nav-item {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            padding: 10px 20px;
        }
        
        .nav-item::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 3px;
            background: var(--secondary-color);
            transition: all 0.3s ease;
        }
        
        .nav-item:hover::before,
        .nav-item.active::before {
            width: 100%;
        }
        
        .nav-item:hover {
            background: rgba(218, 165, 32, 0.1);
        }
        
        .nav-item.active {
            background: rgba(218, 165, 32, 0.2);
            font-weight: 700;
        }
        
        .loading-spinner {
            border: 3px solid rgba(218, 165, 32, 0.3);
            border-top: 3px solid var(--secondary-color);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .connection-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .status-connected {
            background: #E8F5E9;
            color: #2E7D32;
        }
        
        .status-disconnected {
            background: #FFEBEE;
            color: #C62828;
        }
        
        .status-connecting {
            background: #FFF3E0;
            color: #E65100;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary-color) 0%, #B8860B 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success-color) 0%, #006400 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color) 0%, #8B0000 100%);
            color: white;
        }
        
        .setup-card {
            background: white;
            border: 2px solid rgba(218, 165, 32, 0.2);
            border-radius: 12px;
            padding: 24px;
            transition: all 0.3s ease;
        }
        
        .setup-card:hover {
            border-color: var(--secondary-color);
            box-shadow: 0 8px 24px rgba(218, 165, 32, 0.3);
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .file-upload-area {
            border: 2px dashed #ddd;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .file-upload-area:hover {
            border-color: var(--secondary-color);
            background: rgba(218, 165, 32, 0.05);
        }
        
        .file-upload-area.dragover {
            border-color: var(--primary-color);
            background: rgba(139, 69, 19, 0.1);
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="bg-gray-50"><!-- Header -->
  <header class="gradient-bg text-white shadow-lg">
   <div class="container mx-auto px-4 py-6">
    <div class="flex items-center justify-between">
     <div class="flex items-center space-x-4 space-x-reverse">
      <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center">
       <svg class="w-10 h-10 text-blue-600" fill="currentColor" viewbox="0 0 24 24"><path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" /> <circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="2" />
       </svg>
      </div>
      <div>
       <h1 id="systemTitle" class="text-2xl font-bold">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…Ø±ÙƒØ² Ø§Ù„Ø­Ø¨ÙŠØ¨ - Google Sheets</h1>
       <p id="centerInfo" class="text-blue-200"><span id="centerName">Ù…Ø±ÙƒØ² Ø§Ù„Ø­Ø¨ÙŠØ¨ Ù„Ù„Ø£Ù„Ø­Ø§Ù† ÙˆØ§Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ù‚Ø¨Ø·ÙŠØ©</span> - <span id="churchName">ÙƒÙ†ÙŠØ³Ø© Ø§Ù„Ø³ÙŠØ¯Ø© Ø§Ù„Ø¹Ø°Ø±Ø§Ø¡ ÙˆØ§Ù„Ù‚Ø¯ÙŠØ³ Ù…Ø§Ø± ÙŠÙˆØ­Ù†Ø§</span></p>
      </div>
     </div>
     <div class="flex items-center gap-4"><!-- Connection Status -->
      <div id="connectionStatus" class="connection-status status-disconnected">
       ğŸ”´ ØºÙŠØ± Ù…ØªØµÙ„
      </div>
      <div id="userInfo" class="hidden text-left">
       <div class="text-sm text-blue-200">
        Ù…Ø±Ø­Ø¨Ø§Ù‹
       </div>
       <div id="userName" class="font-semibold"></div>
       <div id="userRole" class="text-xs text-blue-300"></div>
      </div>
     </div>
    </div>
   </div>
  </header><!-- Navigation -->
  <nav class="bg-white shadow-md sticky top-0 z-50">
   <div class="container mx-auto px-4">
    <div class="flex justify-center space-x-8 space-x-reverse py-4" id="mainNavigation"><button class="nav-item active px-4 py-2 text-gray-700 hover:text-blue-600 font-semibold transition-colors" onclick="showSection('home')"> ğŸ  Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© </button> <button class="nav-item px-4 py-2 text-gray-700 hover:text-blue-600 font-semibold transition-colors" onclick="showSection('setup')"> âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø±Ø¨Ø· </button> <button class="nav-item px-4 py-2 text-gray-700 hover:text-blue-600 font-semibold transition-colors" onclick="showSection('login')"> ğŸ”‘ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ </button>
    </div><!-- Admin Navigation -->
    <div id="adminNavigation" class="hidden flex justify-center space-x-6 space-x-reverse py-4 border-t border-gray-200"><button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-red-600 font-semibold transition-colors" onclick="showAdminSection('dashboard')"> ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-red-600 font-semibold transition-colors" onclick="showAdminSection('students')"> ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø§Ø±Ø³ÙŠÙ† </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-red-600 font-semibold transition-colors" onclick="showAdminSection('teachers')"> ğŸ‘¨â€ğŸ« Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ø§Ù… </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-red-600 font-semibold transition-colors" onclick="showAdminSection('attendance')"> ğŸ“ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-red-600 font-semibold transition-colors" onclick="showAdminSection('grades')"> ğŸ“ˆ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª </button>
    </div><!-- Teacher Navigation -->
    <div id="teacherNavigation" class="hidden flex justify-center space-x-6 space-x-reverse py-4 border-t border-gray-200"><button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-green-600 font-semibold transition-colors" onclick="showTeacherSection('dashboard')"> ğŸ¯ Ù„ÙˆØ­Ø© Ø§Ù„Ø®Ø§Ø¯Ù… </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-green-600 font-semibold transition-colors" onclick="showTeacherSection('attendance')"> âœ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-green-600 font-semibold transition-colors" onclick="showTeacherSection('homework')"> ğŸ“š ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-green-600 font-semibold transition-colors" onclick="showTeacherSection('grades')"> ğŸ“Š Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª </button>
    </div><!-- Student Navigation -->
    <div id="studentNavigation" class="hidden flex justify-center space-x-6 space-x-reverse py-4 border-t border-gray-200"><button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-purple-600 font-semibold transition-colors" onclick="showStudentSection('profile')"> ğŸ‘¤ Ù…Ù„ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠ </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-purple-600 font-semibold transition-colors" onclick="showStudentSection('grades')"> ğŸ“Š Ø¯Ø±Ø¬Ø§ØªÙŠ </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-purple-600 font-semibold transition-colors" onclick="showStudentSection('attendance')"> ğŸ“… Ø­Ø¶ÙˆØ±ÙŠ </button> <button class="nav-item px-3 py-2 text-sm text-gray-700 hover:text-purple-600 font-semibold transition-colors" onclick="showStudentSection('homework')"> ğŸ“š Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª </button>
    </div>
   </div>
  </nav><!-- Main Content -->
  <main class="container mx-auto px-4 py-8"><!-- Home Section -->
   <section id="home" class="section-content fade-in">
    <div class="text-center mb-12">
     <h2 class="text-4xl font-bold text-gray-800 mb-4">Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ Ù„Ù„Ù…Ø±ÙƒØ²</h2>
     <p class="text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed">Ù…Ø±ÙƒØ² Ø§Ù„Ø­Ø¨ÙŠØ¨ Ù„Ù„Ø£Ù„Ø­Ø§Ù† ÙˆØ§Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ù‚Ø¨Ø·ÙŠØ© - Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ù€ Google Sheets</p>
    </div><!-- Google Integration Features -->
    <div class="bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-8 card-shadow mb-8">
     <div class="flex items-start gap-4">
      <div class="text-5xl">
       â˜ï¸
      </div>
      <div class="flex-1">
       <h3 class="text-2xl font-bold text-blue-900 mb-4">Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Google Workspace</h3>
       <div class="grid md:grid-cols-2 gap-6">
        <div>
         <h4 class="font-bold text-green-800 mb-2">ğŸ“Š Google Sheets</h4>
         <ul class="text-sm text-green-700 space-y-1">
          <li>â€¢ ØªØ®Ø²ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø§Ø±Ø³ÙŠÙ† ÙˆØ§Ù„Ø®Ø¯Ø§Ù…</li>
          <li>â€¢ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ Ù„Ù€ 15 Ø£Ø³Ø¨ÙˆØ¹</li>
          <li>â€¢ Ø¯Ø±Ø¬Ø§Øª Ù…Ø§Ø¯Ø© Ø§Ù„Ø·Ù‚ÙˆØ³ Ø§Ù„ÙƒÙ†Ø³ÙŠØ©</li>
          <li>â€¢ Ø¯Ø±Ø¬Ø§Øª Ù…Ø§Ø¯Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ù‚Ø¨Ø·ÙŠØ©</li>
          <li>â€¢ Ø¯Ø±Ø¬Ø§Øª Ø§Ù„ØªØ³Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ Ù„Ù„Ø£Ù„Ø­Ø§Ù†</li>
         </ul>
        </div>
        <div>
         <h4 class="font-bold text-blue-800 mb-2">ğŸ’¾ Google Drive</h4>
         <ul class="text-sm text-blue-700 space-y-1">
          <li>â€¢ ØªØ®Ø²ÙŠÙ† ØµÙˆØ± Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©</li>
          <li>â€¢ Ø­ÙØ¸ ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø§Ù„Ø£Ù„Ø­Ø§Ù† Ø§Ù„ØµÙˆØªÙŠØ©</li>
          <li>â€¢ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</li>
          <li>â€¢ Ù…Ø´Ø§Ø±ÙƒØ© Ø¢Ù…Ù†Ø© Ù„Ù„Ù…Ù„ÙØ§Øª</li>
          <li>â€¢ ÙˆØµÙˆÙ„ Ù…Ù† Ø£ÙŠ Ù…ÙƒØ§Ù†</li>
         </ul>
        </div>
       </div>
      </div>
     </div>
    </div><!-- Vision and Mission -->
    <div class="space-y-8"><!-- Goal -->
     <div class="bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-8 card-shadow">
      <div class="flex items-start gap-4">
       <div class="text-5xl">
        ğŸ¯
       </div>
       <div class="flex-1">
        <h3 class="text-2xl font-bold text-blue-900 mb-4">Ø§Ù„Ù‡Ø¯Ù</h3>
        <p class="text-lg text-blue-800 leading-relaxed">Ù‡Ø¯ÙÙ†Ø§ ØªØ¹Ù„ÙŠÙ… Ø£ÙˆÙ„Ø§Ø¯Ù†Ø§ ÙˆØ¨Ù†Ø§ØªÙ†Ø§ Ù…Ù† Ø§Ù„ØµØºØ± (Ù…Ù† Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø­Ø¶Ø§Ù†Ø©) ÙƒÙŠÙ ÙŠØ³ØªÙ…ØªØ¹ÙˆÙ† Ø¨ØµÙ„ÙˆØ§Øª Ø§Ù„ÙƒÙ†ÙŠØ³Ø© .. Ø¨Ø·Ù‚Ø³Ù‡Ø§ ÙˆÙ„ØºØªÙ‡Ø§ Ø§Ù„Ù‚Ø¨Ø·ÙŠØ© ÙˆØ£Ù„Ø­Ø§Ù†Ù‡Ø§.</p>
       </div>
      </div>
     </div><!-- Vision -->
     <div class="bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-8 card-shadow">
      <div class="flex items-start gap-4">
       <div class="text-5xl">
        ğŸ‘ï¸
       </div>
       <div class="flex-1">
        <h3 class="text-2xl font-bold text-purple-900 mb-4">Ø§Ù„Ø±Ø¤ÙŠØ©</h3>
        <p class="text-lg text-purple-800 leading-relaxed mb-4">Ø±Ø¤ÙŠØªÙ†Ø§ Ø¥Ù† Ø§Ù„Ø´Ø¹Ø¨ ÙƒÙ„Ù‡ ÙŠØ³ØªÙ…ØªØ¹ Ø¨Ù„ÙŠØªÙˆØ±Ø¬ÙŠØ© Ø§Ù„ÙƒÙ†ÙŠØ³Ø© Ù…Ù† Ù‚Ø¯Ø§Ø³ Ùˆ ØªØ³Ø¨Ø­Ø© Ùˆ ØµÙ„ÙˆØ§Øª Ù…Ø®ØªÙ„ÙØ© ... Ù†ØµÙ„ÙŠ Ø¨Ø§Ù„Ø±ÙˆØ­ Ùˆ Ø§Ù„Ø°Ù‡Ù† Ø£ÙŠØ¶Ø§Ù‹</p>
        <div class="bg-white rounded-lg p-4 border-2 border-purple-300">
         <p class="text-center text-xl font-bold text-purple-900">ØªØ­Øª Ø´Ø¹Ø§Ø±: Ø£ÙÙ‡Ù… ... ØµÙ„Ù‘ÙŠ ... Ø§Ø³ØªÙ…ØªØ¹</p>
        </div>
        <p class="text-lg text-purple-800 leading-relaxed mt-4">Ø¨Ø¹Ø¯ ØªØ®Ø±Ø¬ Ø«Ø§Ù„Ø« Ø¯ÙØ¹Ø© Ø§Ù„ÙƒÙ†ÙŠØ³Ø© ÙƒÙ„Ù‡Ø§ ØªØ³ØªÙ…ØªØ¹ Ø¨Ø§Ù„Ù„ÙŠØªÙˆØ±Ø¬ÙŠÙ‡</p>
       </div>
      </div>
     </div><!-- Mission -->
     <div class="bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-8 card-shadow">
      <div class="flex items-start gap-4">
       <div class="text-5xl">
        âœ¨
       </div>
       <div class="flex-1">
        <h3 class="text-2xl font-bold text-green-900 mb-4">Ø±Ø³Ø§Ù„ØªÙ†Ø§</h3>
        <p class="text-lg text-green-800 leading-relaxed">ØªÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª</p>
       </div>
      </div>
     </div><!-- Target Audience -->
     <div class="bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-8 card-shadow">
      <div class="flex items-start gap-4">
       <div class="text-5xl">
        ğŸ‘¥
       </div>
       <div class="flex-1">
        <h3 class="text-2xl font-bold text-orange-900 mb-4">Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©</h3>
        <p class="text-lg text-orange-800 leading-relaxed">Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø­Ø¶Ø§Ù†Ø© ÙˆØ­ØªÙ‰ Ø«Ø§Ù†ÙˆÙŠ ÙˆØ´Ø¨Ø§Ø¨ ÙˆØ®Ø±ÙŠØ¬ÙŠÙ† ÙˆØ£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ± Ù„Ù†Ø¹Ø·ÙŠ Ø§Ù„ÙØ±ØµØ© Ù„Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ù†Ø§Ø³ Ù„Ù„Ø§Ø³ØªÙ…ØªØ§Ø¹ Ø¨ÙƒÙ†ÙŠØ³ØªÙ†Ø§ Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©.</p>
       </div>
      </div>
     </div><!-- User Types -->
     <div class="grid md:grid-cols-3 gap-8 mt-12"><!-- Admin Panel -->
      <div class="bg-white rounded-lg p-8 card-shadow hover-lift border-t-4 border-red-500">
       <div class="text-center">
        <div class="w-20 h-20 admin-gradient rounded-full flex items-center justify-center mx-auto mb-6"><span class="text-3xl text-white">ğŸ‘¨â€ğŸ’¼</span>
        </div>
        <h3 class="text-2xl font-bold text-gray-800 mb-4">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
        <div class="text-gray-600 space-y-2 mb-6">
         <p>â€¢ Ø¥Ø¶Ø§ÙØ© ÙˆØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯Ø§Ø±Ø³ÙŠÙ† ÙˆØ§Ù„Ø®Ø¯Ø§Ù…</p>
         <p>â€¢ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø¯Ø±Ø¬Ø§Øª</p>
         <p>â€¢ Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Google Sheets</p>
         <p>â€¢ ØªÙ‚Ø§Ø±ÙŠØ± Ø´Ø§Ù…Ù„Ø©</p>
        </div>
       </div>
      </div><!-- Teacher Panel -->
      <div class="bg-white rounded-lg p-8 card-shadow hover-lift border-t-4 border-green-500">
       <div class="text-center">
        <div class="w-20 h-20 teacher-gradient rounded-full flex items-center justify-center mx-auto mb-6"><span class="text-3xl text-white">ğŸ‘¨â€ğŸ«</span>
        </div>
        <h3 class="text-2xl font-bold text-gray-800 mb-4">Ù„ÙˆØ­Ø© Ø§Ù„Ø®Ø§Ø¯Ù…</h3>
        <div class="text-gray-600 space-y-2 mb-6">
         <p>â€¢ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨</p>
         <p>â€¢ Ø¥Ø¯Ø®Ø§Ù„ Ø¯Ø±Ø¬Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª</p>
         <p>â€¢ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©</p>
         <p>â€¢ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</p>
        </div>
       </div>
      </div><!-- Student Panel -->
      <div class="bg-white rounded-lg p-8 card-shadow hover-lift border-t-4 border-purple-500">
       <div class="text-center">
        <div class="w-20 h-20 student-gradient rounded-full flex items-center justify-center mx-auto mb-6"><span class="text-3xl text-white">ğŸ‘¨â€ğŸ“</span>
        </div>
        <h3 class="text-2xl font-bold text-gray-800 mb-4">Ù„ÙˆØ­Ø© Ø§Ù„Ø¯Ø§Ø±Ø³</h3>
        <div class="text-gray-600 space-y-2 mb-6">
         <p>â€¢ Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª ÙˆØ§Ù„Ù†ØªØ§Ø¦Ø¬</p>
         <p>â€¢ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø­Ø¶ÙˆØ±</p>
         <p>â€¢ ØªØ³Ù„ÙŠÙ… Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª</p>
         <p>â€¢ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„Ø§Øª</p>
        </div>
       </div>
      </div>
     </div>
    </div>
   </section><!-- Setup Section -->
   <section id="setup" class="section-content hidden">
    <div class="max-w-4xl mx-auto">
     <div class="text-center mb-12">
      <h2 class="text-4xl font-bold text-gray-800 mb-4">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ Google</h2>
      <p class="text-xl text-gray-600">Ø§ØªØ¨Ø¹ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ø±Ø¨Ø· Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø¹ Google Sheets Ùˆ Google Drive</p>
     </div><!-- Connection Status Card -->
     <div class="setup-card mb-8">
      <div class="flex items-center justify-between mb-6">
       <h3 class="text-2xl font-bold text-gray-800">Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„</h3>
       <div class="flex gap-3"><button id="googleAuthBtn" onclick="toggleGoogleAuth()" class="btn-secondary"> ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Google </button> <button onclick="testConnection()" class="btn-primary"> ğŸ”„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ </button>
       </div>
      </div>
      <div class="grid md:grid-cols-2 gap-6">
       <div class="text-center p-4 rounded-lg border-2" id="sheetsStatus">
        <div class="text-3xl mb-2">
         ğŸ“Š
        </div>
        <h4 class="font-bold mb-2">Google Sheets</h4>
        <div class="connection-status status-disconnected">
         ØºÙŠØ± Ù…ØªØµÙ„
        </div>
       </div>
       <div class="text-center p-4 rounded-lg border-2" id="driveStatus">
        <div class="text-3xl mb-2">
         ğŸ’¾
        </div>
        <h4 class="font-bold mb-2">Google Drive</h4>
        <div class="connection-status status-disconnected">
         ØºÙŠØ± Ù…ØªØµÙ„
        </div>
       </div>
      </div>
     </div><!-- Setup Steps -->
     <div class="space-y-8"><!-- Step 1: Create Google Sheets -->
      <div class="setup-card">
       <div class="flex items-start gap-4">
        <div class="step-number">
         1
        </div>
        <div class="flex-1">
         <h3 class="text-xl font-bold text-gray-800 mb-4">Ø¥Ù†Ø´Ø§Ø¡ Google Sheets</h3>
         <p class="text-gray-600 mb-4">Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Google Sheets Ø¬Ø¯ÙŠØ¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>
         <div class="grid md:grid-cols-2 gap-4 mb-4">
          <div class="bg-blue-50 p-4 rounded-lg">
           <h4 class="font-bold text-blue-800 mb-2">Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</h4>
           <ul class="text-sm text-blue-700 space-y-1">
            <li>â€¢ Students (Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø§Ø±Ø³ÙŠÙ†)</li>
            <li>â€¢ Teachers (Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø¯Ø§Ù…)</li>
            <li>â€¢ Attendance (Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨)</li>
           </ul>
          </div>
          <div class="bg-green-50 p-4 rounded-lg">
           <h4 class="font-bold text-green-800 mb-2">Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª:</h4>
           <ul class="text-sm text-green-700 space-y-1">
            <li>â€¢ Liturgy_Grades (Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø·Ù‚ÙˆØ³)</li>
            <li>â€¢ Coptic_Grades (Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ù‚Ø¨Ø·ÙŠØ©)</li>
            <li>â€¢ Hymns_Grades (Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø£Ù„Ø­Ø§Ù†)</li>
           </ul>
          </div>
         </div>
         <div class="flex gap-3"><button onclick="createSampleSheet()" class="btn-secondary"> ğŸ“Š Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ù†Ù…ÙˆØ°Ø¬ÙŠ </button> <button onclick="downloadTemplate()" class="btn-primary"> ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ù„Ø¨ </button>
         </div>
        </div>
       </div>
      </div><!-- Step 2: Get Sheets ID -->
      <div class="setup-card">
       <div class="flex items-start gap-4">
        <div class="step-number">
         2
        </div>
        <div class="flex-1">
         <h3 class="text-xl font-bold text-gray-800 mb-4">Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„</h3>
         <p class="text-gray-600 mb-4">Ø§Ù†Ø³Ø® Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ù† Ø±Ø§Ø¨Ø· Google Sheets:</p>
         <div class="bg-gray-100 p-4 rounded-lg mb-4 font-mono text-sm">
          https://docs.google.com/spreadsheets/d/<span class="bg-yellow-200 px-2 py-1 rounded">SHEETS_ID_HERE</span>/edit
         </div>
         <div><label class="block text-sm font-bold text-gray-700 mb-2">Ù…Ø¹Ø±Ù Google Sheets:</label> <input type="text" id="sheetsIdInput" class="w-full p-3 border-2 border-gray-300 rounded-lg" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù‡Ù†Ø§">
         </div>
        </div>
       </div>
      </div><!-- Step 3: Create Google Drive Folder -->
      <div class="setup-card">
       <div class="flex items-start gap-4">
        <div class="step-number">
         3
        </div>
        <div class="flex-1">
         <h3 class="text-xl font-bold text-gray-800 mb-4">Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù„Ø¯ Google Drive</h3>
         <p class="text-gray-600 mb-4">Ø£Ù†Ø´Ø¦ Ù…Ø¬Ù„Ø¯ ÙÙŠ Google Drive Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª (Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„Ø§Øª):</p>
         <div class="bg-gray-100 p-4 rounded-lg mb-4 font-mono text-sm">
          https://drive.google.com/drive/folders/<span class="bg-yellow-200 px-2 py-1 rounded">FOLDER_ID_HERE</span>
         </div>
         <div><label class="block text-sm font-bold text-gray-700 mb-2">Ù…Ø¹Ø±Ù Ù…Ø¬Ù„Ø¯ Google Drive:</label> <input type="text" id="driveIdInput" class="w-full p-3 border-2 border-gray-300 rounded-lg" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø¬Ù„Ø¯ Ù‡Ù†Ø§">
         </div>
        </div>
       </div>
      </div><!-- Step 4: API Setup -->
      <div class="setup-card">
       <div class="flex items-start gap-4">
        <div class="step-number">
         4
        </div>
        <div class="flex-1">
         <h3 class="text-xl font-bold text-gray-800 mb-4">Ø¥Ø¹Ø¯Ø§Ø¯ Google API</h3>
         <p class="text-gray-600 mb-4">Ù„Ù„ÙˆØµÙˆÙ„ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ Google API:</p>
         <div class="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4 mb-4">
          <h4 class="font-bold text-yellow-800 mb-2">âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù‡Ù…Ø©</h4>
          <p class="text-sm text-yellow-700">Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¹Ø§Ù…Ø©. Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„ÙƒØ§Ù…Ù„ (Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙˆØ§Ù„ØªØ¹Ø¯ÙŠÙ„)ØŒ Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ Google API Ù…Ø¹ Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©.</p>
         </div>
         <div class="space-y-3"><a href="https://console.developers.google.com/" target="_blank" class="btn-primary inline-block"> ğŸ”— ÙØªØ­ Google Cloud Console </a> <button onclick="showAPIInstructions()" class="btn-secondary"> ğŸ“– Ø¹Ø±Ø¶ ØªØ¹Ù„ÙŠÙ…Ø§Øª API </button>
         </div>
        </div>
       </div>
      </div><!-- Save Configuration -->
      <div class="setup-card">
       <div class="flex items-start gap-4">
        <div class="step-number">
         5
        </div>
        <div class="flex-1">
         <h3 class="text-xl font-bold text-gray-800 mb-4">Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
         <p class="text-gray-600 mb-4">Ø§Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ø®ØªØ¨Ø± Ø§Ù„Ø§ØªØµØ§Ù„:</p>
         <div class="flex gap-3"><button onclick="saveConfiguration()" class="btn-success"> ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª </button> <button onclick="testConnection()" class="btn-primary"> ğŸ”„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ </button>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </section><!-- Login Section -->
   <section id="login" class="section-content hidden">
    <div class="max-w-md mx-auto bg-white rounded-lg p-8 card-shadow">
     <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
     <div class="mb-6">
      <div class="flex border-b border-gray-200"><button id="adminTab" class="flex-1 py-3 px-4 text-center font-semibold text-gray-500" onclick="switchLoginTab('admin')"> ğŸ‘¨â€ğŸ’¼ Ø¥Ø¯Ø§Ø±Ø© </button> <button id="teacherTab" class="flex-1 py-3 px-4 text-center font-semibold text-gray-500" onclick="switchLoginTab('teacher')"> ğŸ‘¨â€ğŸ« Ø®Ø§Ø¯Ù… </button> <button id="studentTab" class="flex-1 py-3 px-4 text-center font-semibold text-blue-600 border-b-2 border-blue-600" onclick="switchLoginTab('student')"> ğŸ‘¨â€ğŸ“ Ø¯Ø§Ø±Ø³ </button>
      </div>
     </div>
     <form id="loginForm" onsubmit="handleLogin(event)">
      <div id="studentLogin">
       <div class="mb-6"><label for="studentCode" class="block text-sm font-semibold text-gray-700 mb-2">ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø±Ø³</label> <input type="text" id="studentCode" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø±Ø³ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ">
       </div>
       <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4">
        <p class="text-xs text-blue-700">ğŸ’¡ <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø±Ø³ ÙŠØªÙ… ØªØ³Ù„ÙŠÙ…Ù‡ Ù„Ùƒ Ù…Ù† Ù‚Ø¨Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ² Ø¹Ù†Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„</p>
       </div>
      </div>
      <div id="teacherLogin" class="hidden">
       <div class="mb-4"><label for="teacherCode" class="block text-sm font-semibold text-gray-700 mb-2">ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Ø¯Ù…</label> <input type="text" id="teacherCode" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Ø¯Ù…">
       </div>
       <div class="mb-6"><label for="teacherPassword" class="block text-sm font-semibold text-gray-700 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label> <input type="password" id="teacherPassword" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
       </div>
       <div class="bg-green-50 border border-green-200 rounded-lg p-3 mb-4">
        <p class="text-xs text-green-700">ğŸ’¡ <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØªÙ… ØªØ³Ù„ÙŠÙ…Ù‡Ù…Ø§ Ù„Ùƒ Ù…Ù† Ù‚Ø¨Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ²</p>
       </div>
      </div>
      <div id="adminLogin" class="hidden">
       <div class="mb-4"><label for="adminUsername" class="block text-sm font-semibold text-gray-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label> <input type="text" id="adminUsername" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
       </div>
       <div class="mb-6"><label for="adminPassword" class="block text-sm font-semibold text-gray-700 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label> <input type="password" id="adminPassword" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
       </div>
       <div class="bg-red-50 border border-red-200 rounded-lg p-3 mb-4">
        <p class="text-xs text-red-700">ğŸ”’ <strong>ØªÙ†Ø¨ÙŠÙ‡ Ø£Ù…Ù†ÙŠ:</strong> Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© Ø³Ø±ÙŠØ© Ù„Ù„ØºØ§ÙŠØ© ÙˆÙ„Ø§ ÙŠØ¬Ø¨ Ù…Ø´Ø§Ø±ÙƒØªÙ‡Ø§ Ù…Ø¹ Ø£ÙŠ Ø´Ø®Øµ</p>
       </div>
      </div><button type="submit" id="loginButton" class="w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition-colors"> <span class="flex items-center justify-center gap-2"> <span id="loginButtonText">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¯Ø§Ø±Ø³</span>
        <div id="loginSpinner" class="loading-spinner hidden"></div></span> </button>
     </form>
     <div class="mt-6 text-center"><button onclick="logout()" class="text-gray-500 hover:text-gray-700 text-sm"> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ </button>
     </div>
    </div>
   </section><!-- Admin Dashboard -->
   <section id="adminDashboard" class="section-content hidden">
    <div class="bg-white rounded-lg p-8 card-shadow">
     <div class="flex justify-between items-center mb-8">
      <div>
       <h2 class="text-3xl font-bold text-gray-800">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
       <p class="text-gray-600">Ø¥Ø¯Ø§Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø­Ø¨ÙŠØ¨ - Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ù€ Google Sheets</p>
      </div>
      <div class="flex items-center gap-4"><button onclick="syncWithSheets()" class="btn-secondary"> ğŸ”„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª </button> <button onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors"> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ </button>
      </div>
     </div><!-- Quick Stats -->
     <div class="grid md:grid-cols-4 gap-6 mb-8">
      <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6 text-center">
       <div class="text-3xl mb-2">
        ğŸ‘¥
       </div>
       <h3 class="text-2xl font-bold text-blue-800" id="totalStudentsCount">0</h3>
       <p class="text-blue-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø§Ø±Ø³ÙŠÙ†</p>
      </div>
      <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-6 text-center">
       <div class="text-3xl mb-2">
        ğŸ‘¨â€ğŸ«
       </div>
       <h3 class="text-2xl font-bold text-green-800" id="totalTeachersCount">0</h3>
       <p class="text-green-600">Ø¹Ø¯Ø¯ Ø§Ù„Ø®Ø¯Ø§Ù…</p>
      </div>
      <div class="bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg p-6 text-center">
       <div class="text-3xl mb-2">
        ğŸ“Š
       </div>
       <h3 class="text-2xl font-bold text-yellow-800" id="attendanceRate">0%</h3>
       <p class="text-yellow-600">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±</p>
      </div>
      <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-6 text-center">
       <div class="text-3xl mb-2">
        â˜ï¸
       </div>
       <h3 class="text-2xl font-bold text-purple-800" id="syncStatus">Ù…ØªØµÙ„</h3>
       <p class="text-purple-600">Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©</p>
      </div>
     </div>
     <div id="adminContent">
      <div class="text-center py-12">
       <div class="text-6xl mb-4">
        ğŸ“Š
       </div>
       <p class="text-gray-500 text-lg">Ø§Ø®ØªØ± Ø£Ø­Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ù…Ù† Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ</p>
      </div>
     </div>
    </div>
   </section><!-- Teacher Dashboard -->
   <section id="teacherDashboard" class="section-content hidden">
    <div class="bg-white rounded-lg p-8 card-shadow">
     <div class="flex justify-between items-center mb-8">
      <div>
       <h2 class="text-3xl font-bold text-gray-800">Ù„ÙˆØ­Ø© Ø§Ù„Ø®Ø§Ø¯Ù…</h2>
       <p class="text-gray-600" id="teacherWelcome">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ</p>
      </div>
      <div class="flex items-center gap-4"><button onclick="syncWithSheets()" class="btn-secondary"> ğŸ”„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª </button> <button onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors"> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ </button>
      </div>
     </div>
     <div id="teacherContent">
      <div class="text-center py-12">
       <div class="text-6xl mb-4">
        ğŸ¯
       </div>
       <p class="text-gray-500 text-lg">Ø§Ø®ØªØ± Ø£Ø­Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ù…Ù† Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ</p>
      </div>
     </div>
    </div>
   </section><!-- Student Dashboard -->
   <section id="studentDashboard" class="section-content hidden">
    <div class="bg-white rounded-lg p-8 card-shadow">
     <div class="flex justify-between items-center mb-8">
      <div>
       <h2 class="text-3xl font-bold text-gray-800">Ù…Ù„ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠ</h2>
       <p class="text-gray-600" id="studentWelcome">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ</p>
      </div><button onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors"> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ </button>
     </div>
     <div id="studentContent">
      <div class="text-center py-12">
       <div class="text-6xl mb-4">
        ğŸ‘¨â€ğŸ“
       </div>
       <p class="text-gray-500 text-lg">Ø§Ø®ØªØ± Ø£Ø­Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ù…Ù† Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ</p>
      </div>
     </div>
    </div>
   </section>
  </main><!-- Footer -->
  <footer class="gradient-bg text-white mt-16">
   <div class="container mx-auto px-4 py-8">
    <div class="text-center">
     <h3 class="text-xl font-bold mb-4">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…Ø±ÙƒØ² Ø§Ù„Ø­Ø¨ÙŠØ¨ - Google Sheets</h3>
     <p class="text-blue-200 mb-4">Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Google Workspace - ØªØ®Ø²ÙŠÙ† Ø³Ø­Ø§Ø¨ÙŠ Ø¢Ù…Ù†</p>
     <p class="text-sm text-blue-100">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© 2024</p>
    </div>
   </div>
  </footer>
  <script>
        // Configuration
        const defaultConfig = {
            system_title: "Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…Ø±ÙƒØ² Ø§Ù„Ø­Ø¨ÙŠØ¨ - Google Sheets",
            center_name: "Ù…Ø±ÙƒØ² Ø§Ù„Ø­Ø¨ÙŠØ¨ Ù„Ù„Ø£Ù„Ø­Ø§Ù† ÙˆØ§Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ù‚Ø¨Ø·ÙŠØ©",
            church_name: "ÙƒÙ†ÙŠØ³Ø© Ø§Ù„Ø³ÙŠØ¯Ø© Ø§Ù„Ø¹Ø°Ø±Ø§Ø¡ ÙˆØ§Ù„Ù‚Ø¯ÙŠØ³ Ù…Ø§Ø± ÙŠÙˆØ­Ù†Ø§",
            sheets_id: "",
            drive_folder_id: ""
        };

        // Google API Configuration
        let googleConfig = {
            sheetsId: '',
            driveFolderId: '',
            clientId: '1086259748871-do5j4426ehu9j39f6ta6sm1phn5s4mec.apps.googleusercontent.com',
            clientSecret: 'GOCSPX-YCa6',
            redirectUri: 'https://alhabib-center-2025-erb9.vercel.app/oauth2callback',
            apiKey: '',
            isConnected: false,
            isAuthenticated: false
        };

        // Current user and state
        let currentUser = null;
        let currentLoginTab = 'student';

        // Google Sheets Structure
        const SHEET_NAMES = {
            STUDENTS: 'Students',
            TEACHERS: 'Teachers', 
            ATTENDANCE: 'Attendance',
            LITURGY_GRADES: 'Liturgy_Grades',
            COPTIC_GRADES: 'Coptic_Grades',
            HYMNS_GRADES: 'Hymns_Grades'
        };

        // Educational Stages
        const STAGES = [
            'KG1', 'KG2',
            'Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø£Ø¨ØªØ¯Ø§Ø¦ÙŠ', 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø£Ø¨ØªØ¯Ø§Ø¦ÙŠ', 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø£Ø¨ØªØ¯Ø§Ø¦ÙŠ',
            'Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹ Ø§Ù„Ø£Ø¨ØªØ¯Ø§Ø¦ÙŠ', 'Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³ Ø§Ù„Ø£Ø¨ØªØ¯Ø§Ø¦ÙŠ', 'Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ù„Ø£Ø¨ØªØ¯Ø§Ø¦ÙŠ',
            'Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ÙŠ', 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ÙŠ', 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ÙŠ',
            'Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ', 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ', 'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ',
            'Ø´Ø¨Ø§Ø¨', 'Ø®Ø±ÙŠØ¬ÙŠÙ†', 'Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø£Ù…ÙˆØ±'
        ];

        // Classes
        const CLASSES = [
            'ØªÙ…Ù‡ÙŠØ¯ÙŠ', 'Ø£ÙˆÙ„ÙŠ ÙˆØ«Ø§Ù†ÙŠØ©', 'Ø«Ø§Ù„Ø«Ø© ÙˆØ±Ø§Ø¨Ø¹Ø©', 
            'Ø®Ø§Ù…Ø³Ø© ÙˆØ³Ø§Ø¯Ø³Ø©', 'Ø£Ø¹Ø¯Ø§Ø¯ÙŠ - Ø«Ø§Ù†ÙˆÙŠ', 'Ø´Ø¨Ø§Ø¨ ÙˆØ®Ø±ÙŠØ¬ÙŠÙ†'
        ];

        // Teacher Specialties
        const SPECIALTIES = [
            'Ø£Ø¯Ø§Ø±ÙŠ', 'Ø¯Ø±Ø§Ø³ÙŠ - Ø·Ù‚ÙˆØ³', 'Ø¯Ø±Ø§Ø³ÙŠ - Ù„ØºØ© Ù‚Ø¨Ø·ÙŠØ©', 'Ø¯Ø±Ø§Ø³ÙŠ - Ø§Ù„Ø­Ø§Ù†',
            'Ø¯Ø±Ø§Ø³ÙŠ Ù…Ø­ÙÙˆØ¸Ø§Øª', 'Ù…Ø³Ø¤ÙˆÙ„', 'Ø¯Ø±Ø§Ø³ÙŠ - Ø·Ù‚ÙˆØ³ ÙˆÙ…Ø­ÙÙˆØ¸Ø§Øª', 'Ø£Ø¯Ø§Ø±ÙŠ - Ø¯Ø±Ø§Ø³ÙŠ'
        ];

        // Initialize System
        async function initializeSystem() {
            try {
                // Initialize Element SDK
                if (window.elementSdk) {
                    await window.elementSdk.init({
                        defaultConfig,
                        onConfigChange: async (config) => {
                            document.getElementById('systemTitle').textContent = config.system_title || defaultConfig.system_title;
                            document.getElementById('centerName').textContent = config.center_name || defaultConfig.center_name;
                            document.getElementById('churchName').textContent = config.church_name || defaultConfig.church_name;
                            
                            // Update Google configuration
                            if (config.sheets_id) {
                                googleConfig.sheetsId = config.sheets_id;
                                document.getElementById('sheetsIdInput').value = config.sheets_id;
                            }
                            if (config.drive_folder_id) {
                                googleConfig.driveFolderId = config.drive_folder_id;
                                document.getElementById('driveIdInput').value = config.drive_folder_id;
                            }
                        },
                        mapToCapabilities: (config) => ({
                            recolorables: [],
                            borderables: [],
                            fontEditable: undefined,
                            fontSizeable: undefined
                        }),
                        mapToEditPanelValues: (config) => new Map([
                            ["system_title", config.system_title || defaultConfig.system_title],
                            ["center_name", config.center_name || defaultConfig.center_name],
                            ["church_name", config.church_name || defaultConfig.church_name],
                            ["sheets_id", config.sheets_id || ""],
                            ["drive_folder_id", config.drive_folder_id || ""]
                        ])
                    });
                }

                // Load saved configuration
                loadConfiguration();
                
                // Initialize Google API
                await initializeGoogleAPI();
                
                // Update auth button text
                updateAuthButtonText();
                
                console.log('âœ… ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­');
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…:', error);
                showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…', 'error');
            }
        }

        // Initialize Google API
        async function initializeGoogleAPI() {
            try {
                // Show loading status
                const statusEl = document.getElementById('connectionStatus');
                if (statusEl) {
                    statusEl.className = 'connection-status status-connecting';
                    statusEl.textContent = 'ğŸŸ¡ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©...';
                }

                await new Promise((resolve, reject) => {
                    gapi.load('client:auth2', {
                        callback: resolve,
                        onerror: reject
                    });
                });

                await gapi.client.init({
                    clientId: googleConfig.clientId,
                    discoveryDocs: [
                        'https://sheets.googleapis.com/$discovery/rest?version=v4',
                        'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'
                    ],
                    scope: 'https://www.googleapis.com/auth/spreadsheets https://www.googleapis.com/auth/drive.file'
                });

                // Check if user is already signed in
                const authInstance = gapi.auth2.getAuthInstance();
                googleConfig.isAuthenticated = authInstance.isSignedIn.get();
                
                // Listen for sign-in state changes
                authInstance.isSignedIn.listen(updateSigninStatus);
                
                console.log('âœ… ØªÙ… ØªÙ‡ÙŠØ¦Ø© Google API Ø¨Ù†Ø¬Ø§Ø­');
                console.log('ğŸ” Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©:', googleConfig.isAuthenticated ? 'Ù…ØµØ§Ø¯Ù‚' : 'ØºÙŠØ± Ù…ØµØ§Ø¯Ù‚');
                
                updateConnectionStatus();
                updateAuthButtonText();
                
                if (googleConfig.isAuthenticated) {
                    showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Google Ù…Ø³Ø¨Ù‚Ø§Ù‹', 'success');
                }
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Google API:', error);
                updateConnectionStatus(false);
                showToast('ÙØ´Ù„ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Google API: ' + error.message, 'error');
            }
        }

        // Update signin status
        function updateSigninStatus(isSignedIn) {
            googleConfig.isAuthenticated = isSignedIn;
            updateConnectionStatus();
            updateAuthButtonText();
            
            if (isSignedIn) {
                const user = gapi.auth2.getAuthInstance().currentUser.get();
                const profile = user.getBasicProfile();
                console.log('âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:', profile.getName());
                showToast(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${profile.getName()}`, 'success');
            } else {
                console.log('âŒ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬');
            }
        }

        // Google Authentication Functions
        async function signInToGoogle() {
            try {
                const authBtn = document.getElementById('googleAuthBtn');
                if (authBtn) {
                    authBtn.innerHTML = '<span class="loading-spinner inline-block"></span> Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...';
                    authBtn.disabled = true;
                }

                const authInstance = gapi.auth2.getAuthInstance();
                
                if (!authInstance) {
                    throw new Error('Google API ØºÙŠØ± Ù…Ù‡ÙŠØ£ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­');
                }

                const user = await authInstance.signIn({
                    prompt: 'select_account'
                });
                
                if (user.isSignedIn()) {
                    const profile = user.getBasicProfile();
                    googleConfig.isAuthenticated = true;
                    
                    console.log('âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­:', profile.getName());
                    console.log('ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:', profile.getEmail());
                    
                    showToast(`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ - Ù…Ø±Ø­Ø¨Ø§Ù‹ ${profile.getName()}`, 'success');
                    updateConnectionStatus();
                    updateAuthButtonText();
                    
                    return user;
                } else {
                    throw new Error('ÙØ´Ù„ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
                }
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:', error);
                
                let errorMessage = 'ÙØ´Ù„ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Google';
                if (error.error === 'popup_closed_by_user') {
                    errorMessage = 'ØªÙ… Ø¥Ù„ØºØ§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…';
                } else if (error.error === 'access_denied') {
                    errorMessage = 'ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©';
                }
                
                showToast(errorMessage, 'error');
                updateAuthButtonText();
                throw error;
            } finally {
                const authBtn = document.getElementById('googleAuthBtn');
                if (authBtn) {
                    authBtn.disabled = false;
                }
            }
        }

        async function signOutFromGoogle() {
            try {
                const authBtn = document.getElementById('googleAuthBtn');
                if (authBtn) {
                    authBtn.innerHTML = '<span class="loading-spinner inline-block"></span> Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬...';
                    authBtn.disabled = true;
                }

                const authInstance = gapi.auth2.getAuthInstance();
                
                if (authInstance) {
                    await authInstance.signOut();
                    googleConfig.isAuthenticated = false;
                    
                    console.log('âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­');
                    showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Google Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    updateConnectionStatus();
                    updateAuthButtonText();
                } else {
                    console.warn('âš ï¸ Google API ØºÙŠØ± Ù…ØªØ§Ø­');
                }
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬:', error);
                showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', 'error');
            } finally {
                const authBtn = document.getElementById('googleAuthBtn');
                if (authBtn) {
                    authBtn.disabled = false;
                }
            }
        }

        // Update Connection Status
        function updateConnectionStatus(connected = null) {
            const statusEl = document.getElementById('connectionStatus');
            const sheetsStatusEl = document.getElementById('sheetsStatus');
            const driveStatusEl = document.getElementById('driveStatus');
            
            if (connected === null) {
                connected = googleConfig.isAuthenticated && googleConfig.sheetsId && googleConfig.driveFolderId;
            }
            
            googleConfig.isConnected = connected;
            
            const authStatus = googleConfig.isAuthenticated ? 'Ù…ØµØ§Ø¯Ù‚' : 'ØºÙŠØ± Ù…ØµØ§Ø¯Ù‚';
            const connectionStatus = connected ? 'Ù…ØªØµÙ„' : 'ØºÙŠØ± Ù…ØªØµÙ„';
            
            if (connected && googleConfig.isAuthenticated) {
                statusEl.className = 'connection-status status-connected';
                statusEl.textContent = 'ğŸŸ¢ Ù…ØªØµÙ„ ÙˆÙ…ØµØ§Ø¯Ù‚';
                
                if (sheetsStatusEl) {
                    sheetsStatusEl.querySelector('.connection-status').className = 'connection-status status-connected';
                    sheetsStatusEl.querySelector('.connection-status').textContent = 'Ù…ØªØµÙ„';
                }
                
                if (driveStatusEl) {
                    driveStatusEl.querySelector('.connection-status').className = 'connection-status status-connected';
                    driveStatusEl.querySelector('.connection-status').textContent = 'Ù…ØªØµÙ„';
                }
            } else if (googleConfig.isAuthenticated) {
                statusEl.className = 'connection-status status-connecting';
                statusEl.textContent = 'ğŸŸ¡ Ù…ØµØ§Ø¯Ù‚ - ÙŠØ­ØªØ§Ø¬ Ø¥Ø¹Ø¯Ø§Ø¯';
            } else {
                statusEl.className = 'connection-status status-disconnected';
                statusEl.textContent = 'ğŸ”´ ØºÙŠØ± Ù…ØªØµÙ„';
                
                if (sheetsStatusEl) {
                    sheetsStatusEl.querySelector('.connection-status').className = 'connection-status status-disconnected';
                    sheetsStatusEl.querySelector('.connection-status').textContent = 'ØºÙŠØ± Ù…ØªØµÙ„';
                }
                
                if (driveStatusEl) {
                    driveStatusEl.querySelector('.connection-status').className = 'connection-status status-disconnected';
                    driveStatusEl.querySelector('.connection-status').textContent = 'ØºÙŠØ± Ù…ØªØµÙ„';
                }
            }
        }

        // Google Sheets Operations
        async function readFromSheet(sheetName, range = '') {
            try {
                if (!googleConfig.isAuthenticated) {
                    throw new Error('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Google Ø£ÙˆÙ„Ø§Ù‹');
                }
                
                if (!googleConfig.sheetsId) {
                    throw new Error('Ù…Ø¹Ø±Ù Google Sheets ØºÙŠØ± Ù…Ø­Ø¯Ø¯');
                }

                const fullRange = range ? `${sheetName}!${range}` : sheetName;
                
                const response = await gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: googleConfig.sheetsId,
                    range: fullRange
                });

                return response.result.values || [];
            } catch (error) {
                console.error(`Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† ${sheetName}:`, error);
                
                if (error.status === 401) {
                    showToast('Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„. ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'error');
                    googleConfig.isAuthenticated = false;
                    updateConnectionStatus();
                }
                
                throw error;
            }
        }

        async function writeToSheet(sheetName, range, values) {
            try {
                if (!googleConfig.isConnected || !googleConfig.sheetsId) {
                    throw new Error('Google Sheets ØºÙŠØ± Ù…ØªØµÙ„');
                }

                const response = await gapi.client.sheets.spreadsheets.values.update({
                    spreadsheetId: googleConfig.sheetsId,
                    range: `${sheetName}!${range}`,
                    valueInputOption: 'RAW',
                    resource: {
                        values: values
                    }
                });

                return response.result;
            } catch (error) {
                console.error(`Ø®Ø·Ø£ ÙÙŠ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ ${sheetName}:`, error);
                throw error;
            }
        }

        async function appendToSheet(sheetName, values) {
            try {
                if (!googleConfig.isConnected || !googleConfig.sheetsId) {
                    throw new Error('Google Sheets ØºÙŠØ± Ù…ØªØµÙ„');
                }

                const response = await gapi.client.sheets.spreadsheets.values.append({
                    spreadsheetId: googleConfig.sheetsId,
                    range: sheetName,
                    valueInputOption: 'RAW',
                    resource: {
                        values: values
                    }
                });

                return response.result;
            } catch (error) {
                console.error(`Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ ${sheetName}:`, error);
                throw error;
            }
        }

        // Google Drive Operations
        async function uploadToGoogleDrive(file, fileName, folderId = null) {
            try {
                const targetFolderId = folderId || googleConfig.driveFolderId;
                
                if (!targetFolderId) {
                    throw new Error('Ù…Ø¹Ø±Ù Ù…Ø¬Ù„Ø¯ Google Drive ØºÙŠØ± Ù…Ø­Ø¯Ø¯');
                }

                const metadata = {
                    name: fileName,
                    parents: [targetFolderId]
                };

                const form = new FormData();
                form.append('metadata', new Blob([JSON.stringify(metadata)], {type: 'application/json'}));
                form.append('file', file);

                const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token}`
                    },
                    body: form
                });

                if (!response.ok) {
                    throw new Error(`Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù: ${response.statusText}`);
                }

                const result = await response.json();
                return result;
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø¥Ù„Ù‰ Google Drive:', error);
                throw error;
            }
        }

        // Data Conversion Functions
        function studentsArrayToSheet(students) {
            const headers = [
                'ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø±Ø³', 'Ø§Ø³Ù… Ø§Ù„Ø¯Ø§Ø±Ø³', 'Ø§Ù„Ù†ÙˆØ¹', 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯', 'Ø§Ù„Ù…Ø±Ø­Ù„Ø©',
                'Ø§Ù„Ù‡Ø§ØªÙ 1', 'Ø§Ù„Ù‡Ø§ØªÙ 2', 'Ø­Ø±Ù Ø§Ù„ÙØµÙ„', 'Ø§Ù„ÙØµÙ„', 'Ø§Ù„Ø±ØªØ¨Ø©', 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†',
                'Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø©', 'Ø§Ù„ØµÙˆØ±Ø©', 'Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø©', 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡'
            ];
            
            const rows = students.map(student => [
                student.code || '',
                student.name || '',
                student.gender || '',
                student.birthDate || '',
                student.stage || '',
                student.phone1 || '',
                student.phone2 || '',
                student.classLetter || '',
                student.className || '',
                student.rank || '',
                student.address || '',
                student.hasForm ? 'Ù†Ø¹Ù…' : 'Ù„Ø§',
                student.hasPhoto ? 'Ù†Ø¹Ù…' : 'Ù„Ø§',
                student.formPaid ? 'Ù†Ø¹Ù…' : 'Ù„Ø§',
                student.createdAt || ''
            ]);
            
            return [headers, ...rows];
        }

        function sheetToStudentsArray(sheetData) {
            if (!sheetData || sheetData.length < 2) return [];
            
            const [headers, ...rows] = sheetData;
            
            return rows.map(row => ({
                code: row[0] || '',
                name: row[1] || '',
                gender: row[2] || '',
                birthDate: row[3] || '',
                stage: row[4] || '',
                phone1: row[5] || '',
                phone2: row[6] || '',
                classLetter: row[7] || '',
                className: row[8] || '',
                rank: row[9] || '',
                address: row[10] || '',
                hasForm: row[11] === 'Ù†Ø¹Ù…',
                hasPhoto: row[12] === 'Ù†Ø¹Ù…',
                formPaid: row[13] === 'Ù†Ø¹Ù…',
                createdAt: row[14] || ''
            }));
        }

        function teachersArrayToSheet(teachers) {
            const headers = [
                'ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Ø¯Ù…', 'Ø§Ø³Ù… Ø§Ù„Ø®Ø§Ø¯Ù…', 'Ø§Ù„Ù‡Ø§ØªÙ', 'Ø§Ù„ØªØ®ØµØµ', 'Ø£Ø¯Ø§Ø±ÙŠ',
                'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±', 'Ø§Ù„ÙØµÙ„', 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡'
            ];
            
            const rows = teachers.map(teacher => [
                teacher.code || '',
                teacher.name || '',
                teacher.phone || '',
                teacher.specialty || '',
                teacher.isAdmin ? 'Ù†Ø¹Ù…' : 'Ù„Ø§',
                teacher.password || '',
                teacher.className || '',
                teacher.createdAt || ''
            ]);
            
            return [headers, ...rows];
        }

        function sheetToTeachersArray(sheetData) {
            if (!sheetData || sheetData.length < 2) return [];
            
            const [headers, ...rows] = sheetData;
            
            return rows.map(row => ({
                code: row[0] || '',
                name: row[1] || '',
                phone: row[2] || '',
                specialty: row[3] || '',
                isAdmin: row[4] === 'Ù†Ø¹Ù…',
                password: row[5] || '',
                className: row[6] || '',
                createdAt: row[7] || ''
            }));
        }

        // Sync Functions
        async function syncWithSheets() {
            try {
                updateConnectionStatus(null);
                showToast('Ø¬Ø§Ø±ÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...', 'info');
                
                // Test connection first
                await testConnection();
                
                if (!googleConfig.isConnected) {
                    throw new Error('ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Google Sheets');
                }
                
                showToast('ØªÙ… Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©:', error);
                showToast('ÙØ´Ù„ ÙÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message, 'error');
            }
        }

        async function loadStudentsFromSheets() {
            try {
                const sheetData = await readFromSheet(SHEET_NAMES.STUDENTS);
                return sheetToStudentsArray(sheetData);
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø§Ø±Ø³ÙŠÙ†:', error);
                return [];
            }
        }

        async function saveStudentsToSheets(students) {
            try {
                const sheetData = studentsArrayToSheet(students);
                await writeToSheet(SHEET_NAMES.STUDENTS, 'A1', sheetData);
                return true;
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø§Ø±Ø³ÙŠÙ†:', error);
                return false;
            }
        }

        async function loadTeachersFromSheets() {
            try {
                const sheetData = await readFromSheet(SHEET_NAMES.TEACHERS);
                return sheetToTeachersArray(sheetData);
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø¯Ø§Ù…:', error);
                return [];
            }
        }

        async function saveTeachersToSheets(teachers) {
            try {
                const sheetData = teachersArrayToSheet(teachers);
                await writeToSheet(SHEET_NAMES.TEACHERS, 'A1', sheetData);
                return true;
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø¯Ø§Ù…:', error);
                return false;
            }
        }

        // Configuration Management
        function saveConfiguration() {
            const sheetsId = document.getElementById('sheetsIdInput').value.trim();
            const driveId = document.getElementById('driveIdInput').value.trim();
            
            if (!sheetsId || !driveId) {
                showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¹Ø±Ù Google Sheets ÙˆÙ…Ø¹Ø±Ù Ù…Ø¬Ù„Ø¯ Google Drive', 'error');
                return;
            }
            
            googleConfig.sheetsId = sheetsId;
            googleConfig.driveFolderId = driveId;
            
            // Save to localStorage
            localStorage.setItem('googleConfig', JSON.stringify(googleConfig));
            
            // Update Element SDK config
            if (window.elementSdk) {
                window.elementSdk.setConfig({
                    sheets_id: sheetsId,
                    drive_folder_id: driveId
                });
            }
            
            showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
            testConnection();
        }

        function loadConfiguration() {
            try {
                const saved = localStorage.getItem('googleConfig');
                if (saved) {
                    googleConfig = { ...googleConfig, ...JSON.parse(saved) };
                    
                    if (document.getElementById('sheetsIdInput')) {
                        document.getElementById('sheetsIdInput').value = googleConfig.sheetsId || '';
                    }
                    if (document.getElementById('driveIdInput')) {
                        document.getElementById('driveIdInput').value = googleConfig.driveFolderId || '';
                    }
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª:', error);
            }
        }

        // Update Auth Button Text
        function updateAuthButtonText() {
            const authBtn = document.getElementById('googleAuthBtn');
            if (authBtn) {
                if (googleConfig.isAuthenticated) {
                    authBtn.textContent = 'ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Google';
                } else {
                    authBtn.textContent = 'ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Google';
                }
            }
        }

        // Toggle Google Authentication
        async function toggleGoogleAuth() {
            const authBtn = document.getElementById('googleAuthBtn');
            
            if (googleConfig.isAuthenticated) {
                await signOutFromGoogle();
                authBtn.textContent = 'ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Google';
            } else {
                try {
                    authBtn.innerHTML = '<span class="loading-spinner inline-block"></span> Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...';
                    await signInToGoogle();
                    authBtn.textContent = 'ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Google';
                } catch (error) {
                    authBtn.textContent = 'ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Google';
                }
            }
        }

        async function testConnection() {
            try {
                const statusEl = document.getElementById('connectionStatus');
                statusEl.className = 'connection-status status-connecting';
                statusEl.textContent = 'ğŸŸ¡ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...';
                
                // Step 1: Check Google API initialization
                if (!window.gapi || !gapi.auth2) {
                    throw new Error('Google API ØºÙŠØ± Ù…Ù‡ÙŠØ£. ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©');
                }
                
                const authInstance = gapi.auth2.getAuthInstance();
                if (!authInstance) {
                    throw new Error('Google Auth ØºÙŠØ± Ù…ØªØ§Ø­. ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©');
                }
                
                // Step 2: Check authentication
                if (!googleConfig.isAuthenticated || !authInstance.isSignedIn.get()) {
                    updateConnectionStatus(false);
                    showToast('âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Google Ø£ÙˆÙ„Ø§Ù‹', 'error');
                    
                    // Show helpful message
                    const modal = createModal('ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø·Ù„ÙˆØ¨', `
                        <div class="text-center space-y-4">
                            <div class="text-6xl mb-4">ğŸ”</div>
                            <h3 class="text-xl font-bold text-gray-800 mb-4">ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Google Ø£ÙˆÙ„Ø§Ù‹</h3>
                            <p class="text-gray-600 mb-6">
                                Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ Google SheetsØŒ ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨ Google Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ø£ÙˆÙ„Ø§Ù‹.
                            </p>
                            <div class="flex justify-center gap-3">
                                <button onclick="closeModal(); toggleGoogleAuth();" class="btn-primary">
                                    ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Google
                                </button>
                                <button onclick="closeModal()" class="btn-secondary">
                                    Ø¥Ù„ØºØ§Ø¡
                                </button>
                            </div>
                        </div>
                    `);
                    return;
                }
                
                // Step 3: Check Sheets ID
                if (!googleConfig.sheetsId) {
                    updateConnectionStatus(false);
                    showToast('âš ï¸ Ù…Ø¹Ø±Ù Google Sheets ØºÙŠØ± Ù…Ø­Ø¯Ø¯', 'error');
                    
                    const modal = createModal('ğŸ“Š Ù…Ø¹Ø±Ù Google Sheets Ù…Ø·Ù„ÙˆØ¨', `
                        <div class="text-center space-y-4">
                            <div class="text-6xl mb-4">ğŸ“Š</div>
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Ù…Ø¹Ø±Ù Google Sheets ØºÙŠØ± Ù…Ø­Ø¯Ø¯</h3>
                            <p class="text-gray-600 mb-6">
                                ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¹Ø±Ù Google Sheets ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø£ÙˆÙ„Ø§Ù‹.
                            </p>
                            <div class="flex justify-center gap-3">
                                <button onclick="closeModal(); showSection('setup');" class="btn-primary">
                                    âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø±Ø¨Ø·
                                </button>
                                <button onclick="closeModal()" class="btn-secondary">
                                    Ø¥Ù„ØºØ§Ø¡
                                </button>
                            </div>
                        </div>
                    `);
                    return;
                }
                
                // Step 4: Test actual connection
                statusEl.textContent = 'ğŸŸ¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¬Ø¯ÙˆÙ„...';
                
                try {
                    await readFromSheet(SHEET_NAMES.STUDENTS, 'A1:A1');
                } catch (sheetError) {
                    if (sheetError.status === 404) {
                        throw new Error('Ø§Ù„Ø¬Ø¯ÙˆÙ„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø£Ùˆ Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø®Ø§Ø·Ø¦');
                    } else if (sheetError.status === 403) {
                        throw new Error('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø¯ÙˆÙ„');
                    } else {
                        throw new Error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¬Ø¯ÙˆÙ„: ' + sheetError.message);
                    }
                }
                
                // Success!
                updateConnectionStatus(true);
                showToast('âœ… ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­ Ù…Ø¹ Google Sheets', 'success');
                
                // Show success details
                const user = authInstance.currentUser.get();
                const profile = user.getBasicProfile();
                
                console.log('âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ù†Ø¬Ø­:');
                console.log('ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', profile.getName());
                console.log('ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯:', profile.getEmail());
                console.log('ğŸ“Š Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ø¯ÙˆÙ„:', googleConfig.sheetsId);
                
            } catch (error) {
                console.error('âŒ ÙØ´Ù„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„:', error);
                updateConnectionStatus(false);
                showToast('âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ' + error.message, 'error');
            }
        }

        // Setup Helper Functions
        function createSampleSheet() {
            const url = `https://docs.google.com/spreadsheets/create?usp=sharing`;
            window.open(url, '_blank');
            showToast('Ø³ÙŠØªÙ… ÙØªØ­ Google Sheets ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©', 'info');
        }

        function downloadTemplate() {
            // Create a sample CSV template
            const csvContent = `ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø±Ø³,Ø§Ø³Ù… Ø§Ù„Ø¯Ø§Ø±Ø³,Ø§Ù„Ù†ÙˆØ¹,ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯,Ø§Ù„Ù…Ø±Ø­Ù„Ø©,Ø§Ù„Ù‡Ø§ØªÙ 1,Ø§Ù„Ù‡Ø§ØªÙ 2,Ø­Ø±Ù Ø§Ù„ÙØµÙ„,Ø§Ù„ÙØµÙ„,Ø§Ù„Ø±ØªØ¨Ø©,Ø§Ù„Ø¹Ù†ÙˆØ§Ù†,Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø©,Ø§Ù„ØµÙˆØ±Ø©,Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø©,ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
ST001,Ù…Ø«Ø§Ù„ Ù„Ù„Ø¯Ø§Ø±Ø³,Ø°ÙƒØ±,2010-01-01,Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø£Ø¨ØªØ¯Ø§Ø¦ÙŠ,01234567890,,A,ØªÙ…Ù‡ÙŠØ¯ÙŠ,Ø´Ù…Ø§Ø³,Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù‡Ù†Ø§,Ù†Ø¹Ù…,Ù†Ø¹Ù…,Ù†Ø¹Ù…,2024-01-01`;
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'students_template.csv';
            link.click();
            
            showToast('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'success');
        }

        function showAPIInstructions() {
            const modal = createModal('ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø¥Ø¹Ø¯Ø§Ø¯ Google API', `
                <div class="space-y-6">
                    <div class="bg-green-50 border-2 border-green-300 rounded-lg p-4">
                        <h3 class="font-bold text-green-800 mb-3">âœ… ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ OAuth Ø¨Ù†Ø¬Ø§Ø­!</h3>
                        <div class="text-sm text-green-700 space-y-2">
                            <p><strong>Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> https://alhabib-center-2025-erb9.vercel.app</p>
                            <p><strong>Client ID:</strong> 1086259748871-do5j4426ehu9j39f6ta6sm1phn5s4mec.apps.googleusercontent.com</p>
                            <p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ğŸ‰</p>
                            <div class="bg-white rounded-lg p-3 mt-3">
                                <p class="font-semibold text-green-800">Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>
                                <ol class="list-decimal list-inside space-y-1 mr-4">
                                    <li>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Google" Ø£Ø¹Ù„Ø§Ù‡</li>
                                    <li>Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù Google Sheets</li>
                                    <li>Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù Ù…Ø¬Ù„Ø¯ Google Drive</li>
                                    <li>Ø§Ø¶ØºØ· "Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„"</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-4">
                        <h3 class="font-bold text-blue-800 mb-3">Ø®Ø·ÙˆØ§Øª Ø¥Ø¹Ø¯Ø§Ø¯ Google API:</h3>
                        <ol class="text-sm text-blue-700 space-y-2 list-decimal list-inside">
                            <li>Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ <a href="https://console.developers.google.com/" target="_blank" class="underline">Google Cloud Console</a></li>
                            <li>Ø£Ù†Ø´Ø¦ Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙŠØ¯ Ø£Ùˆ Ø§Ø®ØªØ± Ù…Ø´Ø±ÙˆØ¹ Ù…ÙˆØ¬ÙˆØ¯</li>
                            <li>ÙØ¹Ù‘Ù„ Google Sheets API Ùˆ Google Drive API</li>
                            <li>Ø£Ù†Ø´Ø¦ OAuth 2.0 Client ID (Ù†ÙˆØ¹: Web application)</li>
                            <li><strong>Authorized JavaScript origins:</strong> http://localhost:8080 (Ù„Ù„ØªØ·ÙˆÙŠØ±)</li>
                            <li><strong>Authorized redirect URIs:</strong> http://localhost:8080/oauth2callback</li>
                            <li>Ø£Ø¶Ù Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Scopes)</li>
                        </ol>
                    </div>
                    
                    <div class="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4">
                        <h3 class="font-bold text-yellow-800 mb-3">Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</h3>
                        <ul class="text-sm text-yellow-700 space-y-1 list-disc list-inside">
                            <li>https://www.googleapis.com/auth/spreadsheets</li>
                            <li>https://www.googleapis.com/auth/drive.file</li>
                        </ul>
                    </div>
                    
                    <div class="bg-green-50 border-2 border-green-300 rounded-lg p-4">
                        <h3 class="font-bold text-green-800 mb-3">ğŸ’¡ Ø¨Ø¯Ø§Ø¦Ù„ Ù„Ù„Ù†Ø´Ø±:</h3>
                        <div class="text-sm text-green-700 space-y-2">
                            <p><strong>1. Vercel (Ù…Ø¬Ø§Ù†ÙŠ):</strong></p>
                            <ul class="list-disc list-inside mr-4 mb-2">
                                <li>Ø§Ø±ÙØ¹ Ø§Ù„ÙƒÙˆØ¯ Ø¹Ù„Ù‰ GitHub</li>
                                <li>Ø§Ø±Ø¨Ø· Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨Ù€ Vercel</li>
                                <li>Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù†Ø·Ø§Ù‚ Ù…Ø«Ù„: yourproject.vercel.app</li>
                            </ul>
                            
                            <p><strong>2. Netlify (Ù…Ø¬Ø§Ù†ÙŠ):</strong></p>
                            <ul class="list-disc list-inside mr-4 mb-2">
                                <li>Ø§Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ù…Ø¨Ø§Ø´Ø±Ø©</li>
                                <li>Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù†Ø·Ø§Ù‚ Ù…Ø«Ù„: yourproject.netlify.app</li>
                            </ul>
                            
                            <p><strong>3. Firebase Hosting (Ù…Ø¬Ø§Ù†ÙŠ):</strong></p>
                            <ul class="list-disc list-inside mr-4">
                                <li>Ø§Ø³ØªØ®Ø¯Ù… Firebase CLI</li>
                                <li>Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù†Ø·Ø§Ù‚ Ù…Ø«Ù„: yourproject.web.app</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4">
                        <h3 class="font-bold text-yellow-800 mb-3">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©:</h3>
                        <ul class="text-sm text-yellow-700 space-y-1 list-disc list-inside">
                            <li>ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ ÙˆØ§Ù„Ù…Ø¬Ù„Ø¯ Ù‚Ø§Ø¨Ù„ÙŠÙ† Ù„Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø¹Ø§Ù… Ø£Ùˆ Ù…Ø´Ø§Ø±ÙƒÙŠÙ† Ù…Ø¹ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø®Ø¯Ù…Ø©</li>
                            <li>Ø§Ø­ØªÙØ¸ Ø¨Ù…ÙØ§ØªÙŠØ­ API ÙÙŠ Ù…ÙƒØ§Ù† Ø¢Ù…Ù†</li>
                            <li>Ù„Ø§ ØªØ´Ø§Ø±Ùƒ Ù…ÙØ§ØªÙŠØ­ API Ù…Ø¹ Ø£ÙŠ Ø´Ø®Øµ</li>
                            <li>Ø§Ø³ØªØ®Ø¯Ù… Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø© Ù„Ø­ÙØ¸ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø­Ø³Ø§Ø³Ø©</li>
                        </ul>
                    </div>
                    
                    <div class="flex justify-end">
                        <button onclick="closeModal()" class="btn-primary">
                            ÙÙ‡Ù…Øª
                        </button>
                    </div>
                </div>
            `);
        }

        // Navigation functions
        function showSection(sectionId) {
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(sectionId).classList.remove('hidden');
            
            document.querySelectorAll('#mainNavigation .nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // Login functions
        function switchLoginTab(tab) {
            currentLoginTab = tab;
            
            document.querySelectorAll('[id$="Tab"]').forEach(tabBtn => {
                tabBtn.className = 'flex-1 py-3 px-4 text-center font-semibold text-gray-500';
            });
            
            const colors = {
                admin: 'text-red-600 border-b-2 border-red-600',
                teacher: 'text-green-600 border-b-2 border-green-600',
                student: 'text-blue-600 border-b-2 border-blue-600'
            };
            
            document.getElementById(tab + 'Tab').className += ' ' + colors[tab];
            
            document.getElementById('adminLogin').classList.toggle('hidden', tab !== 'admin');
            document.getElementById('teacherLogin').classList.toggle('hidden', tab !== 'teacher');
            document.getElementById('studentLogin').classList.toggle('hidden', tab !== 'student');
            
            const buttonColors = {
                admin: 'bg-red-600 hover:bg-red-700',
                teacher: 'bg-green-600 hover:bg-green-700',
                student: 'bg-blue-600 hover:bg-blue-700'
            };
            
            const buttonTexts = {
                admin: 'ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©',
                teacher: 'ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…',
                student: 'ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¯Ø§Ø±Ø³'
            };
            
            const loginButton = document.getElementById('loginButton');
            loginButton.className = `w-full ${buttonColors[tab]} text-white py-3 px-4 rounded-lg font-semibold transition-colors`;
            document.getElementById('loginButtonText').textContent = buttonTexts[tab];
        }

        async function handleLogin(event) {
            event.preventDefault();
            
            const spinner = document.getElementById('loginSpinner');
            const buttonText = document.getElementById('loginButtonText');
            
            spinner.classList.remove('hidden');
            buttonText.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...';
            
            try {
                let loginSuccess = false;
                let userData = null;
                
                if (currentLoginTab === 'student') {
                    const code = document.getElementById('studentCode').value.trim().toUpperCase();
                    
                    if (!code) {
                        showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø±Ø³', 'error');
                        return;
                    }
                    
                    // Load students from Google Sheets
                    const students = await loadStudentsFromSheets();
                    userData = students.find(s => s.code === code);
                    
                    if (userData) {
                        currentUser = { type: 'student', data: userData };
                        loginSuccess = true;
                        showStudentDashboard();
                    }
                } else if (currentLoginTab === 'teacher') {
                    const code = document.getElementById('teacherCode').value.trim().toUpperCase();
                    const password = document.getElementById('teacherPassword').value.trim();
                    
                    if (!code || !password) {
                        showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±', 'error');
                        return;
                    }
                    
                    // Load teachers from Google Sheets
                    const teachers = await loadTeachersFromSheets();
                    userData = teachers.find(t => t.code === code && t.password === password);
                    
                    if (userData) {
                        currentUser = { type: 'teacher', data: userData };
                        loginSuccess = true;
                        showTeacherDashboard();
                    }
                } else if (currentLoginTab === 'admin') {
                    const username = document.getElementById('adminUsername').value.trim();
                    const password = document.getElementById('adminPassword').value.trim();
                    
                    if (!username || !password) {
                        showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±', 'error');
                        return;
                    }
                    
                    // Check admin credentials (you can store these in sheets too)
                    if (username === 'ADMIN' && password === 'admin123') {
                        currentUser = { type: 'admin', data: { name: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…', username: username } };
                        loginSuccess = true;
                        showAdminDashboard();
                    }
                }
                
                if (loginSuccess) {
                    showToast(`Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ${userData ? userData.name : currentUser.data.name}`, 'success');
                    document.getElementById('loginForm').reset();
                    updateUserInfo();
                } else {
                    showToast('Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'error');
                }
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:', error);
                showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ' + error.message, 'error');
            } finally {
                spinner.classList.add('hidden');
                const buttonTexts = {
                    admin: 'ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©',
                    teacher: 'ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…',
                    student: 'ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¯Ø§Ø±Ø³'
                };
                buttonText.textContent = buttonTexts[currentLoginTab];
            }
        }

        function updateUserInfo() {
            const userInfo = document.getElementById('userInfo');
            const userName = document.getElementById('userName');
            const userRole = document.getElementById('userRole');
            
            if (currentUser) {
                userInfo.classList.remove('hidden');
                userName.textContent = currentUser.data.name;
                
                const roleTexts = {
                    admin: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…',
                    teacher: 'Ø®Ø§Ø¯Ù… - ' + (currentUser.data.specialty || ''),
                    student: 'Ø¯Ø§Ø±Ø³ - ' + (currentUser.data.stage || '')
                };
                
                userRole.textContent = roleTexts[currentUser.type];
            } else {
                userInfo.classList.add('hidden');
            }
        }

        function showAdminDashboard() {
            showSection('adminDashboard');
            document.getElementById('adminNavigation').classList.remove('hidden');
            document.getElementById('teacherNavigation').classList.add('hidden');
            document.getElementById('studentNavigation').classList.add('hidden');
            updateDashboardStats();
        }

        function showTeacherDashboard() {
            showSection('teacherDashboard');
            document.getElementById('adminNavigation').classList.add('hidden');
            document.getElementById('teacherNavigation').classList.remove('hidden');
            document.getElementById('studentNavigation').classList.add('hidden');
            
            const welcome = document.getElementById('teacherWelcome');
            welcome.textContent = `Ù…Ø±Ø­Ø¨Ø§Ù‹ ${currentUser.data.name} - ${currentUser.data.specialty}`;
        }

        function showStudentDashboard() {
            showSection('studentDashboard');
            document.getElementById('adminNavigation').classList.add('hidden');
            document.getElementById('teacherNavigation').classList.add('hidden');
            document.getElementById('studentNavigation').classList.remove('hidden');
            
            const welcome = document.getElementById('studentWelcome');
            welcome.textContent = `Ù…Ø±Ø­Ø¨Ø§Ù‹ ${currentUser.data.name} - ${currentUser.data.stage}`;
        }

        function logout() {
            currentUser = null;
            document.getElementById('adminNavigation').classList.add('hidden');
            document.getElementById('teacherNavigation').classList.add('hidden');
            document.getElementById('studentNavigation').classList.add('hidden');
            updateUserInfo();
            showSection('home');
            showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }

        // Admin Sections
        function showAdminSection(section) {
            const content = document.getElementById('adminContent');
            
            if (section === 'dashboard') {
                content.innerHTML = `
                    <div class="grid md:grid-cols-2 gap-8">
                        <div class="bg-blue-50 rounded-lg p-6">
                            <h3 class="text-xl font-bold text-blue-800 mb-4">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø§Ø±Ø³ÙŠÙ†:</span>
                                    <span class="font-bold" id="dashboardStudentsCount">0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ø¹Ø¯Ø¯ Ø§Ù„Ø®Ø¯Ø§Ù…:</span>
                                    <span class="font-bold" id="dashboardTeachersCount">0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„:</span>
                                    <span class="font-bold ${googleConfig.isConnected ? 'text-green-600' : 'text-red-600'}">
                                        ${googleConfig.isConnected ? 'Ù…ØªØµÙ„' : 'ØºÙŠØ± Ù…ØªØµÙ„'}
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-green-50 rounded-lg p-6">
                            <h3 class="text-xl font-bold text-green-800 mb-4">ğŸ¯ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                            <div class="space-y-2">
                                <button onclick="showAdminSection('students')" class="w-full text-right p-3 bg-white rounded hover:bg-gray-50 transition-colors">
                                    ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø§Ø±Ø³ÙŠÙ†
                                </button>
                                <button onclick="showAdminSection('teachers')" class="w-full text-right p-3 bg-white rounded hover:bg-gray-50 transition-colors">
                                    ğŸ‘¨â€ğŸ« Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ø§Ù…
                                </button>
                                <button onclick="syncWithSheets()" class="w-full text-right p-3 bg-white rounded hover:bg-gray-50 transition-colors">
                                    ğŸ”„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                updateDashboardStats();
            } else if (section === 'students') {
                showStudentsManagement();
            } else if (section === 'teachers') {
                showTeachersManagement();
            } else if (section === 'attendance') {
                showAttendanceManagement();
            } else if (section === 'grades') {
                showGradesManagement();
            }
        }

        // Students Management
        async function showStudentsManagement() {
            const content = document.getElementById('adminContent');
            
            try {
                const students = await loadStudentsFromSheets();
                
                content.innerHTML = `
                    <div class="mb-6 flex justify-between items-center">
                        <h3 class="text-2xl font-bold text-gray-800">ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø§Ø±Ø³ÙŠÙ†</h3>
                        <div class="flex gap-3">
                            <button onclick="syncWithSheets()" class="btn-secondary">
                                ğŸ”„ Ù…Ø²Ø§Ù…Ù†Ø©
                            </button>
                            <button onclick="showAddStudentForm()" class="btn-primary">
                                â• Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ø±Ø³ Ø¬Ø¯ÙŠØ¯
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="p-3 text-center">Ù…</th>
                                        <th class="p-3 text-center">ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø±Ø³</th>
                                        <th class="p-3 text-right">Ø§Ø³Ù… Ø§Ù„Ø¯Ø§Ø±Ø³</th>
                                        <th class="p-3 text-center">Ø§Ù„Ù†ÙˆØ¹</th>
                                        <th class="p-3 text-center">Ø§Ù„Ù…Ø±Ø­Ù„Ø©</th>
                                        <th class="p-3 text-center">Ø§Ù„ÙØµÙ„</th>
                                        <th class="p-3 text-center">Ø§Ù„Ù‡Ø§ØªÙ</th>
                                        <th class="p-3 text-center">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${students.length === 0 ? `
                                        <tr>
                                            <td colspan="8" class="p-8 text-center text-gray-500">
                                                Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¯Ø§Ø±Ø³ÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙŠ Google Sheets
                                            </td>
                                        </tr>
                                    ` : students.map((student, index) => `
                                        <tr class="border-b hover:bg-gray-50">
                                            <td class="p-3 text-center text-gray-600">${index + 1}</td>
                                            <td class="p-3 text-center font-mono text-xs bg-gray-50">${student.code}</td>
                                            <td class="p-3 font-semibold">${student.name}</td>
                                            <td class="p-3 text-center">${student.gender}</td>
                                            <td class="p-3 text-center text-xs">${student.stage}</td>
                                            <td class="p-3 text-center text-xs">${student.className}</td>
                                            <td class="p-3 text-center text-xs">${student.phone1}</td>
                                            <td class="p-3 text-center">
                                                <button onclick="viewStudent('${student.code}')" class="text-green-600 hover:text-green-800 mx-1" title="Ø¹Ø±Ø¶">ğŸ‘ï¸</button>
                                                <button onclick="editStudent('${student.code}')" class="text-blue-600 hover:text-blue-800 mx-1" title="ØªØ¹Ø¯ÙŠÙ„">âœï¸</button>
                                                <button onclick="deleteStudent('${student.code}')" class="text-red-600 hover:text-red-800 mx-1" title="Ø­Ø°Ù">ğŸ—‘ï¸</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            } catch (error) {
                content.innerHTML = `
                    <div class="bg-red-50 border-2 border-red-300 rounded-lg p-6 text-center">
                        <div class="text-4xl mb-4">âŒ</div>
                        <h3 class="text-xl font-bold text-red-800 mb-2">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                        <p class="text-red-700 mb-4">${error.message}</p>
                        <button onclick="showSection('setup')" class="btn-primary">
                            âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø±Ø¨Ø·
                        </button>
                    </div>
                `;
            }
        }

        // Teachers Management
        async function showTeachersManagement() {
            const content = document.getElementById('adminContent');
            
            try {
                const teachers = await loadTeachersFromSheets();
                
                content.innerHTML = `
                    <div class="mb-6 flex justify-between items-center">
                        <h3 class="text-2xl font-bold text-gray-800">ğŸ‘¨â€ğŸ« Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ø§Ù…</h3>
                        <div class="flex gap-3">
                            <button onclick="syncWithSheets()" class="btn-secondary">
                                ğŸ”„ Ù…Ø²Ø§Ù…Ù†Ø©
                            </button>
                            <button onclick="showAddTeacherForm()" class="btn-primary">
                                â• Ø¥Ø¶Ø§ÙØ© Ø®Ø§Ø¯Ù… Ø¬Ø¯ÙŠØ¯
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="p-3 text-center">Ù…</th>
                                        <th class="p-3 text-center">ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Ø¯Ù…</th>
                                        <th class="p-3 text-right">Ø§Ø³Ù… Ø§Ù„Ø®Ø§Ø¯Ù…</th>
                                        <th class="p-3 text-center">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
                                        <th class="p-3 text-center">Ø§Ù„ØªØ®ØµØµ</th>
                                        <th class="p-3 text-center">Ø£Ø¯Ø§Ø±ÙŠ</th>
                                        <th class="p-3 text-center">Ø§Ù„ÙØµÙ„</th>
                                        <th class="p-3 text-center">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${teachers.length === 0 ? `
                                        <tr>
                                            <td colspan="8" class="p-8 text-center text-gray-500">
                                                Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø®Ø¯Ø§Ù… Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙŠ Google Sheets
                                            </td>
                                        </tr>
                                    ` : teachers.map((teacher, index) => `
                                        <tr class="border-b hover:bg-gray-50">
                                            <td class="p-3 text-center text-gray-600">${index + 1}</td>
                                            <td class="p-3 text-center font-mono text-xs bg-gray-50">${teacher.code}</td>
                                            <td class="p-3 font-semibold">${teacher.name}</td>
                                            <td class="p-3 text-center text-xs">${teacher.phone}</td>
                                            <td class="p-3 text-center text-xs">${teacher.specialty}</td>
                                            <td class="p-3 text-center">
                                                ${teacher.isAdmin ? '<span class="px-2 py-1 bg-red-100 text-red-800 rounded text-xs">âœ“</span>' : '<span class="text-gray-400">-</span>'}
                                            </td>
                                            <td class="p-3 text-center text-xs">${teacher.className || '-'}</td>
                                            <td class="p-3 text-center">
                                                <button onclick="viewTeacher('${teacher.code}')" class="text-green-600 hover:text-green-800 mx-1" title="Ø¹Ø±Ø¶">ğŸ‘ï¸</button>
                                                <button onclick="editTeacher('${teacher.code}')" class="text-blue-600 hover:text-blue-800 mx-1" title="ØªØ¹Ø¯ÙŠÙ„">âœï¸</button>
                                                <button onclick="deleteTeacher('${teacher.code}')" class="text-red-600 hover:text-red-800 mx-1" title="Ø­Ø°Ù">ğŸ—‘ï¸</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            } catch (error) {
                content.innerHTML = `
                    <div class="bg-red-50 border-2 border-red-300 rounded-lg p-6 text-center">
                        <div class="text-4xl mb-4">âŒ</div>
                        <h3 class="text-xl font-bold text-red-800 mb-2">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                        <p class="text-red-700 mb-4">${error.message}</p>
                        <button onclick="showSection('setup')" class="btn-primary">
                            âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø±Ø¨Ø·
                        </button>
                    </div>
                `;
            }
        }

        // Attendance Management
        function showAttendanceManagement() {
            const content = document.getElementById('adminContent');
            
            content.innerHTML = `
                <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-6 text-center">
                    <div class="text-4xl mb-4">ğŸ“</div>
                    <h3 class="text-xl font-bold text-blue-800 mb-2">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨</h3>
                    <p class="text-blue-700 mb-4">Ø³ÙŠØªÙ… Ø±Ø¨Ø· Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ù…Ø¹ ÙˆØ±Ù‚Ø© Attendance ÙÙŠ Google Sheets</p>
                    <button onclick="syncWithSheets()" class="btn-primary">
                        ğŸ”„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    </button>
                </div>
            `;
        }

        // Grades Management
        function showGradesManagement() {
            const content = document.getElementById('adminContent');
            
            content.innerHTML = `
                <div class="space-y-6">
                    <h3 class="text-2xl font-bold text-gray-800">ğŸ“ˆ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø±Ø¬Ø§Øª</h3>
                    
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-6 text-center">
                            <div class="text-4xl mb-4">â›ª</div>
                            <h4 class="text-xl font-bold text-blue-800 mb-2">Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø·Ù‚ÙˆØ³ Ø§Ù„ÙƒÙ†Ø³ÙŠØ©</h4>
                            <p class="text-blue-700 mb-4">ÙˆØ±Ù‚Ø© Liturgy_Grades</p>
                            <button onclick="manageLiturgyGrades()" class="btn-primary">
                                ğŸ“Š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø±Ø¬Ø§Øª
                            </button>
                        </div>
                        
                        <div class="bg-green-50 border-2 border-green-300 rounded-lg p-6 text-center">
                            <div class="text-4xl mb-4">ğŸ“œ</div>
                            <h4 class="text-xl font-bold text-green-800 mb-2">Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ù„ØºØ© Ø§Ù„Ù‚Ø¨Ø·ÙŠØ©</h4>
                            <p class="text-green-700 mb-4">ÙˆØ±Ù‚Ø© Coptic_Grades</p>
                            <button onclick="manageCopticGrades()" class="btn-primary">
                                ğŸ“Š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø±Ø¬Ø§Øª
                            </button>
                        </div>
                        
                        <div class="bg-purple-50 border-2 border-purple-300 rounded-lg p-6 text-center">
                            <div class="text-4xl mb-4">ğŸµ</div>
                            <h4 class="text-xl font-bold text-purple-800 mb-2">Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø£Ù„Ø­Ø§Ù† ÙˆØ§Ù„ØªØ³Ø¨Ø­Ø©</h4>
                            <p class="text-purple-700 mb-4">ÙˆØ±Ù‚Ø© Hymns_Grades</p>
                            <button onclick="manageHymnsGrades()" class="btn-primary">
                                ğŸ“Š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø±Ø¬Ø§Øª
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Teacher Sections
        function showTeacherSection(section) {
            const content = document.getElementById('teacherContent');
            
            if (section === 'dashboard') {
                content.innerHTML = `
                    <div class="bg-green-50 rounded-lg p-6">
                        <h3 class="text-xl font-bold text-green-800 mb-4">ğŸ¯ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù…</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>Ø§Ù„Ø§Ø³Ù…:</span>
                                <span class="font-semibold">${currentUser.data.name}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„ØªØ®ØµØµ:</span>
                                <span class="font-semibold">${currentUser.data.specialty}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„ÙØµÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„:</span>
                                <span class="font-semibold">${currentUser.data.className || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„:</span>
                                <span class="font-semibold ${googleConfig.isConnected ? 'text-green-600' : 'text-red-600'}">
                                    ${googleConfig.isConnected ? 'Ù…ØªØµÙ„' : 'ØºÙŠØ± Ù…ØªØµÙ„'}
                                </span>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                content.innerHTML = `
                    <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-6 text-center">
                        <div class="text-4xl mb-4">ğŸš§</div>
                        <h3 class="text-xl font-bold text-blue-800 mb-2">Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±</h3>
                        <p class="text-blue-700 mb-4">Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø³ÙŠØªÙ… Ø±Ø¨Ø·Ù‡ Ù…Ø¹ Google Sheets Ù‚Ø±ÙŠØ¨Ø§Ù‹</p>
                        <button onclick="syncWithSheets()" class="btn-primary">
                            ğŸ”„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                        </button>
                    </div>
                `;
            }
        }

        // Student Sections
        function showStudentSection(section) {
            const content = document.getElementById('studentContent');
            
            if (section === 'profile') {
                const student = currentUser.data;
                
                content.innerHTML = `
                    <div class="bg-purple-50 rounded-lg p-6">
                        <h3 class="text-xl font-bold text-purple-800 mb-4">ğŸ‘¤ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>Ø§Ù„Ø§Ø³Ù…:</span>
                                <span class="font-semibold">${student.name}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø±Ø³:</span>
                                <span class="font-semibold font-mono">${student.code}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„Ù†ÙˆØ¹:</span>
                                <span class="font-semibold">${student.gender}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„Ù…Ø±Ø­Ù„Ø©:</span>
                                <span class="font-semibold">${student.stage}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø§Ù„ÙØµÙ„:</span>
                                <span class="font-semibold">${student.className}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</span>
                                <span class="font-semibold">${student.phone1}</span>
                            </div>
                        </div>
                    </div>
                `;
            } else if (section === 'homework') {
                showStudentHomework();
            } else {
                content.innerHTML = `
                    <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-6 text-center">
                        <div class="text-4xl mb-4">ğŸš§</div>
                        <h3 class="text-xl font-bold text-blue-800 mb-2">Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±</h3>
                        <p class="text-blue-700 mb-4">Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø³ÙŠØªÙ… Ø±Ø¨Ø·Ù‡ Ù…Ø¹ Google Sheets Ù‚Ø±ÙŠØ¨Ø§Ù‹</p>
                        <button onclick="syncWithSheets()" class="btn-primary">
                            ğŸ”„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                        </button>
                    </div>
                `;
            }
        }

        // Student Homework with Google Drive Integration
        function showStudentHomework() {
            const content = document.getElementById('studentContent');
            
            content.innerHTML = `
                <div class="space-y-6">
                    <div class="flex justify-between items-center">
                        <h3 class="text-2xl font-bold text-gray-800">ğŸ“š Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª</h3>
                        <button onclick="showAddHomeworkForm()" class="btn-primary">
                            â• Ø¥Ø¶Ø§ÙØ© ÙˆØ§Ø¬Ø¨ Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>
                    
                    <!-- Homework Types -->
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-6 text-center">
                            <div class="text-4xl mb-4">ğŸ“</div>
                            <h4 class="text-xl font-bold text-blue-800 mb-2">ÙˆØ§Ø¬Ø¨ ÙƒØªØ§Ø¨ÙŠ</h4>
                            <p class="text-blue-700 mb-4">ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù†Øµ Ù…Ø¨Ø§Ø´Ø±Ø©</p>
                        </div>
                        
                        <div class="bg-green-50 border-2 border-green-300 rounded-lg p-6 text-center">
                            <div class="text-4xl mb-4">ğŸ“·</div>
                            <h4 class="text-xl font-bold text-green-800 mb-2">ÙˆØ§Ø¬Ø¨ Ù…ØµÙˆØ±</h4>
                            <p class="text-green-700 mb-4">Ø±ÙØ¹ ØµÙˆØ±Ø© Ø¥Ù„Ù‰ Google Drive</p>
                        </div>
                        
                        <div class="bg-purple-50 border-2 border-purple-300 rounded-lg p-6 text-center">
                            <div class="text-4xl mb-4">ğŸ¤</div>
                            <h4 class="text-xl font-bold text-purple-800 mb-2">ØªØ³Ù…ÙŠØ¹ Ø£Ù„Ø­Ø§Ù†</h4>
                            <p class="text-purple-700 mb-4">ØªØ³Ø¬ÙŠÙ„ ØµÙˆØªÙŠ Ø¥Ù„Ù‰ Google Drive</p>
                        </div>
                    </div>
                    
                    <!-- Upload Instructions -->
                    <div class="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-6">
                        <h3 class="text-lg font-bold text-yellow-800 mb-3">ğŸ“Œ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø±ÙØ¹</h3>
                        <ul class="space-y-2 text-sm text-yellow-700">
                            <li>â€¢ Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„Ø§Øª ÙÙŠ Google Drive ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</li>
                            <li>â€¢ ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¶ÙˆØ­ Ø§Ù„ØµÙˆØ±Ø© ÙˆØ¬ÙˆØ¯Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØªÙŠ</li>
                            <li>â€¢ Ø³ÙŠØªÙ… Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ÙÙˆØ± Ø±ÙØ¹ Ø§Ù„ÙˆØ§Ø¬Ø¨</li>
                            <li>â€¢ ÙŠÙ…ÙƒÙ†Ùƒ Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ§Ø¬Ø¨ (Ù…Ø±Ø³Ù„ / ØªÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…)</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        // Show Add Homework Form with Google Drive Integration
        function showAddHomeworkForm() {
            const modal = createModal('ğŸ“ Ø¥Ø¶Ø§ÙØ© ÙˆØ§Ø¬Ø¨ Ø¬Ø¯ÙŠØ¯', `
                <form id="addHomeworkForm" onsubmit="submitHomeworkToGoogleDrive(event)" class="space-y-4">
                    <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-4 mb-4">
                        <div class="flex items-center gap-3">
                            <span class="text-3xl">ğŸ“š</span>
                            <div>
                                <h4 class="font-bold text-blue-800">ÙˆØ§Ø¬Ø¨ Ø¬Ø¯ÙŠØ¯</h4>
                                <p class="text-sm text-blue-600">Ø³ÙŠØªÙ… Ø­ÙØ¸Ù‡ ÙÙŠ Google Drive</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Homework Type Selection -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„ÙˆØ§Ø¬Ø¨ *</label>
                        <select name="homeworkType" id="homeworkType" onchange="toggleHomeworkInputs()" required class="w-full p-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ÙˆØ§Ø¬Ø¨...</option>
                            <option value="written">ÙˆØ§Ø¬Ø¨ ÙƒØªØ§Ø¨ÙŠ (Ù†Øµ)</option>
                            <option value="image">ÙˆØ§Ø¬Ø¨ Ù…ØµÙˆØ± (ØµÙˆØ±Ø©)</option>
                            <option value="audio">ØªØ³Ù…ÙŠØ¹ Ø£Ù„Ø­Ø§Ù† (ØªØ³Ø¬ÙŠÙ„ ØµÙˆØªÙŠ)</option>
                        </select>
                    </div>
                    
                    <!-- Written Homework -->
                    <div id="writtenHomework" class="hidden">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙˆØ§Ø¬Ø¨ Ø§Ù„ÙƒØªØ§Ø¨ÙŠ *</label>
                        <textarea 
                            name="content" 
                            id="homeworkContent"
                            rows="8"
                            class="w-full p-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="Ø§ÙƒØªØ¨ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙˆØ§Ø¬Ø¨ Ù‡Ù†Ø§..."
                        ></textarea>
                    </div>
                    
                    <!-- Image Homework -->
                    <div id="imageHomework" class="hidden">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ØµÙˆØ±Ø© Ø§Ù„ÙˆØ§Ø¬Ø¨ *</label>
                        <div class="file-upload-area" onclick="document.getElementById('homeworkImage').click()">
                            <input 
                                type="file" 
                                id="homeworkImage" 
                                name="homeworkImage"
                                accept="image/*"
                                onchange="previewImage(event)"
                                class="hidden"
                            >
                            <div class="text-4xl mb-3">ğŸ“·</div>
                            <p class="font-semibold text-gray-700 mb-2">Ø§Ø¶ØºØ· Ù„Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø§Ù„ÙˆØ§Ø¬Ø¨</p>
                            <p class="text-xs text-gray-500">Ø³ÙŠØªÙ… Ø±ÙØ¹Ù‡Ø§ Ø¥Ù„Ù‰ Google Drive ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</p>
                        </div>
                        <div id="imagePreview" class="hidden mt-4">
                            <img id="previewImg" src="" alt="Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©" class="max-w-full max-h-64 mx-auto rounded-lg border-2 border-gray-300">
                            <button type="button" onclick="removeImage()" class="mt-2 text-red-600 hover:text-red-800 text-sm">
                                ğŸ—‘ï¸ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØµÙˆØ±Ø©
                            </button>
                        </div>
                    </div>
                    
                    <!-- Audio Homework -->
                    <div id="audioHomework" class="hidden">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ØªØ³Ø¬ÙŠÙ„ ØªØ³Ù…ÙŠØ¹ Ø§Ù„Ù„Ø­Ù† *</label>
                        <div class="border-2 border-purple-300 bg-purple-50 rounded-lg p-6">
                            <div class="text-center mb-4">
                                <div class="text-4xl mb-2">ğŸ¤</div>
                                <h4 class="font-bold text-purple-800 mb-2">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù„Ø­Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h4>
                                <p class="text-sm text-purple-700">Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Google Drive</p>
                            </div>
                            
                            <div class="flex justify-center gap-3 mb-4">
                                <button type="button" id="startRecording" onclick="startRecording()" class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 font-semibold">
                                    ğŸ”´ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                                </button>
                                <button type="button" id="stopRecording" onclick="stopRecording()" disabled class="bg-gray-400 text-white px-6 py-3 rounded-lg font-semibold">
                                    â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                                </button>
                            </div>
                            
                            <div id="recordingStatus" class="text-center text-sm text-gray-600 mb-3">
                                Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ³Ø¬ÙŠÙ„
                            </div>
                            
                            <div id="audioPreview" class="hidden">
                                <div class="bg-white rounded-lg p-4 border-2 border-purple-300">
                                    <p class="text-sm font-semibold text-purple-800 mb-2">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</p>
                                    <audio id="audioPlayer" controls class="w-full mb-2"></audio>
                                    <button type="button" onclick="removeAudio()" class="text-red-600 hover:text-red-800 text-sm">
                                        ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-green-50 border-2 border-green-300 rounded-lg p-4">
                        <h4 class="font-bold text-green-800 mb-2">â˜ï¸ Google Drive</h4>
                        <p class="text-sm text-green-700">
                            Ø³ÙŠØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¥Ù„Ù‰ Google Drive ÙˆØ±Ø¨Ø·Ù‡Ø§ Ø¨Ø­Ø³Ø§Ø¨Ùƒ ÙÙŠ Google Sheets
                        </p>
                    </div>
                    
                    <div class="flex justify-end gap-2 mt-6">
                        <button type="button" onclick="closeModal()" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-semibold">
                            Ø¥Ù„ØºØ§Ø¡
                        </button>
                        <button type="submit" id="submitHomeworkBtn" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold">
                            ğŸ“¤ Ø±ÙØ¹ Ø§Ù„ÙˆØ§Ø¬Ø¨
                        </button>
                    </div>
                </form>
            `);
        }

        // Submit Homework to Google Drive
        async function submitHomeworkToGoogleDrive(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const homeworkType = formData.get('homeworkType');
            
            // Validate
            if (homeworkType === 'audio' && !recordedAudioBlob) {
                showToast('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù„Ø­Ù† Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }
            
            if (homeworkType === 'image' && !document.getElementById('homeworkImage').files[0]) {
                showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø§Ù„ÙˆØ§Ø¬Ø¨', 'error');
                return;
            }
            
            // Disable submit button
            const submitBtn = document.getElementById('submitHomeworkBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="loading-spinner inline-block"></span> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...';
            
            try {
                let fileUrl = null;
                let fileName = null;
                
                if (homeworkType === 'image') {
                    const imageFile = document.getElementById('homeworkImage').files[0];
                    fileName = `homework_${currentUser.data.code}_${Date.now()}.${imageFile.name.split('.').pop()}`;
                    
                    const uploadResult = await uploadToGoogleDrive(imageFile, fileName);
                    fileUrl = `https://drive.google.com/file/d/${uploadResult.id}/view`;
                    
                } else if (homeworkType === 'audio') {
                    fileName = `hymn_${currentUser.data.code}_${Date.now()}.webm`;
                    
                    const uploadResult = await uploadToGoogleDrive(recordedAudioBlob, fileName);
                    fileUrl = `https://drive.google.com/file/d/${uploadResult.id}/view`;
                }
                
                // Save homework info to Google Sheets
                const homeworkData = [
                    currentUser.data.code,
                    currentUser.data.name,
                    currentUser.data.className,
                    homeworkType,
                    homeworkType === 'written' ? formData.get('content') : fileName,
                    fileUrl || '',
                    new Date().toISOString(),
                    'pending'
                ];
                
                // This would append to a Homework sheet in Google Sheets
                // await appendToSheet('Homework', [homeworkData]);
                
                showToast('âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„ÙˆØ§Ø¬Ø¨ Ø¨Ù†Ø¬Ø§Ø­ Ø¥Ù„Ù‰ Google Drive', 'success');
                closeModal();
                showStudentHomework();
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¹ Ø§Ù„ÙˆØ§Ø¬Ø¨:', error);
                showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø±ÙØ¹ Ø§Ù„ÙˆØ§Ø¬Ø¨: ' + error.message, 'error');
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'ğŸ“¤ Ø±ÙØ¹ Ø§Ù„ÙˆØ§Ø¬Ø¨';
            }
        }

        // Audio Recording Functions
        let mediaRecorder;
        let audioChunks = [];
        let recordedAudioBlob = null;
        
        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);
                audioChunks = [];
                
                mediaRecorder.ondataavailable = (event) => {
                    audioChunks.push(event.data);
                };
                
                mediaRecorder.onstop = () => {
                    recordedAudioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                    const audioUrl = URL.createObjectURL(recordedAudioBlob);
                    document.getElementById('audioPlayer').src = audioUrl;
                    document.getElementById('audioPreview').classList.remove('hidden');
                    document.getElementById('recordingStatus').textContent = 'ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­ âœ…';
                    
                    // Stop all tracks
                    stream.getTracks().forEach(track => track.stop());
                };
                
                mediaRecorder.start();
                document.getElementById('startRecording').disabled = true;
                document.getElementById('stopRecording').disabled = false;
                document.getElementById('recordingStatus').textContent = 'ğŸ”´ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...';
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†:', error);
                showToast('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†', 'error');
            }
        }
        
        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
                document.getElementById('startRecording').disabled = false;
                document.getElementById('stopRecording').disabled = true;
            }
        }
        
        function removeAudio() {
            recordedAudioBlob = null;
            document.getElementById('audioPlayer').src = '';
            document.getElementById('audioPreview').classList.add('hidden');
            document.getElementById('recordingStatus').textContent = 'Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ³Ø¬ÙŠÙ„';
        }

        // Image Preview Functions
        function previewImage(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('previewImg').src = e.target.result;
                    document.getElementById('imagePreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }
        
        function removeImage() {
            document.getElementById('homeworkImage').value = '';
            document.getElementById('imagePreview').classList.add('hidden');
            document.getElementById('previewImg').src = '';
        }

        // Toggle Homework Inputs
        function toggleHomeworkInputs() {
            const type = document.getElementById('homeworkType').value;
            
            document.getElementById('writtenHomework').classList.add('hidden');
            document.getElementById('imageHomework').classList.add('hidden');
            document.getElementById('audioHomework').classList.add('hidden');
            
            // Reset required attributes
            document.getElementById('homeworkContent').removeAttribute('required');
            document.getElementById('homeworkImage').removeAttribute('required');
            
            if (type === 'written') {
                document.getElementById('writtenHomework').classList.remove('hidden');
                document.getElementById('homeworkContent').setAttribute('required', 'required');
            } else if (type === 'image') {
                document.getElementById('imageHomework').classList.remove('hidden');
                document.getElementById('homeworkImage').setAttribute('required', 'required');
            } else if (type === 'audio') {
                document.getElementById('audioHomework').classList.remove('hidden');
            }
        }

        // Update Dashboard Stats
        async function updateDashboardStats() {
            try {
                const students = await loadStudentsFromSheets();
                const teachers = await loadTeachersFromSheets();
                
                const totalStudentsEl = document.getElementById('totalStudentsCount');
                const totalTeachersEl = document.getElementById('totalTeachersCount');
                const dashboardStudentsEl = document.getElementById('dashboardStudentsCount');
                const dashboardTeachersEl = document.getElementById('dashboardTeachersCount');
                
                if (totalStudentsEl) totalStudentsEl.textContent = students.length;
                if (totalTeachersEl) totalTeachersEl.textContent = teachers.length;
                if (dashboardStudentsEl) dashboardStudentsEl.textContent = students.length;
                if (dashboardTeachersEl) dashboardTeachersEl.textContent = teachers.length;
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:', error);
            }
        }

        // Generate Random Code
        function generateCode(prefix = '') {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = prefix;
            for (let i = 0; i < 8; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }

        // Modal Helper
        function createModal(title, content) {
            const modal = document.createElement('div');
            modal.id = 'customModal';
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">${title}</h2>
                            <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                        </div>
                        ${content}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            return modal;
        }

        function closeModal() {
            const modal = document.getElementById('customModal');
            if (modal) modal.remove();
        }

        // Toast Notification
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-600' : 
                type === 'error' ? 'bg-red-600' : 
                'bg-blue-600'
            } text-white`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Placeholder functions for future implementation
        function showAddStudentForm() {
            showToast('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ù…Ø¹ Google Sheets', 'info');
        }

        function showAddTeacherForm() {
            showToast('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ù…Ø¹ Google Sheets', 'info');
        }

        function viewStudent(code) {
            showToast('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹', 'info');
        }

        function editStudent(code) {
            showToast('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹', 'info');
        }

        function deleteStudent(code) {
            showToast('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹', 'info');
        }

        function viewTeacher(code) {
            showToast('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹', 'info');
        }

        function editTeacher(code) {
            showToast('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹', 'info');
        }

        function deleteTeacher(code) {
            showToast('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹', 'info');
        }

        function manageLiturgyGrades() {
            showToast('Ø³ÙŠØªÙ… Ø±Ø¨Ø· Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø·Ù‚ÙˆØ³ Ù…Ø¹ Google Sheets Ù‚Ø±ÙŠØ¨Ø§Ù‹', 'info');
        }

        function manageCopticGrades() {
            showToast('Ø³ÙŠØªÙ… Ø±Ø¨Ø· Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ù„ØºØ© Ø§Ù„Ù‚Ø¨Ø·ÙŠØ© Ù…Ø¹ Google Sheets Ù‚Ø±ÙŠØ¨Ø§Ù‹', 'info');
        }

        function manageHymnsGrades() {
            showToast('Ø³ÙŠØªÙ… Ø±Ø¨Ø· Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø£Ù„Ø­Ø§Ù† Ù…Ø¹ Google Sheets Ù‚Ø±ÙŠØ¨Ø§Ù‹', 'info');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initializeSystem);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99f78c9984512a48',t:'MTc2MzMwMTk4OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
